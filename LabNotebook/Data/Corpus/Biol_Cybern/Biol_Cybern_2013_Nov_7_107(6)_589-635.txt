Introduction
When light reaches a visual sensor such as the retina, the information necessary to infer properties about the surrounding world is not contained in the measurement of image intensity at a single point, but from the relationships between intensity values at different points. A main reason for this is that the incoming light constitutes an indirect source of information depending on the interaction between geometric and material properties of objects in the surrounding world and on external illumination sources. Another fundamental reason why cues to the surrounding world need to be collected over regions in the visual field as opposed to at single image points is that the measurement process by itself requires the accumulation of energy over non-infinitesimal support regions over space and time. Such a region in the visual field for which a visual sensor and or a visual operator responds to visual input or a visual cell responds to visual stimuli is naturally referred to as a receptive field (Hubel and Wiesel , ) (see Fig. ).A receptive field is a region in the visual field for which a visual sensor/neuron/operator responds to visual stimuli. This figure shows a set of partially overlapping receptive fields over the spatial domain with all the receptive fields having the same spatial extent. More generally, one can conceive distributions of receptive fields over space or space–time with the receptive fields of different size, different shape, and orientation in space as well as different directions in space–time, where adjacent receptive fields may also have significantly larger relative overlap than shown in this schematic illustration



If one considers the theoretical and algorithmic problems of designing a vision system that is going to make use of incoming reflected light to infer properties of the surrounding world, one may ask what types of image operations should be performed on the image data. Would any type of image operation be reasonable? Specifically, regarding the notion of receptive fields, one may ask what types of receptive field profiles would be reasonable? Is it possible to derive a theoretical model of how receptive fields “ought to” respond to visual data?

Initially, such a problem might be regarded as intractable unless the question can be further specified. It is, however, possible to study this problem systematically using approaches that have been developed in the area of computer vision known as scale-space theory (Iijima ; Witkin ; Koenderink ; Koenderink and Doorn ; Lindeberg , , ; Sporring et al. ; Florack ; ter Haar Romeny ). A paradigm that has been developed in this field is to impose structural constraints on the first stages of visual processing that reflect symmetry properties of the environment. Interestingly, it turns out to be possible to substantially reduce the class of permissible image operations from such arguments.

The subject of this article is to describe how structural requirements on the first stages of visual processing as formulated in scale-space theory can be used for deriving idealized models of receptive fields and implications of how these theoretical results can be used when modelling biological vision. A main theoretical argument is that idealized models for linear receptive fields can be derived by necessity given a small set of symmetry requirements that reflect properties of the world that one may naturally require an idealized vision system to be adapted to. In this respect, the treatment bears similarities to approaches in theoretical physics, where symmetry properties are often used as main arguments in the formulation of physical theories of the world. The treatment that will follow will be general in the sense that spatial, spatio-chromatic, and spatio-temporal receptive fields are encompassed by the same unified theory.

An underlying motivation for the theory is that due to the properties of the projection of three-dimensional objects to a two-dimensional light sensor (retina), the image data will be subject to basic image transformations in terms of (i) local scaling transformations caused by objects of different sizes and at different distances to the observer, (ii) local affine transformations caused by variations in the viewing direction relative to the object, (iii) local Galilean transformations caused by relative motions between the object and the observer, and (iv) local multiplicative intensity transformations caused by illumination variations (see Fig. ). If the vision system is to maintain a stable perception of the environment, it is natural to require the first stages of visual processing to be robust to such image variations. Formally, one may require the receptive fields to be covariant under basic image transformations, which means that the receptive fields should be transformed in a well-behaved and well-understood manner under corresponding image transformations (see Fig. ). Combined with an additional criterion that the receptive field must not create new structures at coarse scales that do not correspond to simplifications of corresponding finer scale structures, we will describe how these requirements together lead to idealized families of receptive fields (Lindeberg ) in good agreement with receptive field measurements reported in the literature (Hubel and Wiesel , ; DeAngelis et al. ; DeAngelis and Anzai ; Conway and Livingstone ).Visual stimuli may vary substantially on the retina due to geometric transformations and lighting variations in the environment. Nevertheless, the brain is able to perceive the world as stable. This figure illustrates examples of natural image transformations corresponding to (left column) variations in scale, (middle column) variations in viewing direction, and (right column) relative motion between objects in the world and the observer. A main subject of this paper is to present a theory for visual receptive fields that make it possible to match receptive field responses between image data that have been acquired under different image conditions, specifically involving these basic types of natural image transformations. To model the influence of natural image transformations on receptive field responses, we first approximate the possibly nonlinear image transformation by a local linear transformation at each image point (the derivative), which for these basic image transformations correspond to (i) local scaling transformations, (ii) local affine transformations, and (iii) local Galilean transformations. Then, we consider families of receptive fields that have the property that the transformation of any receptive field within the family using a locally linearized image transformation within the group of relevant image transformations is still within the same family of receptive fields. Such receptive field families are referred to as covariant receptive fields. The receptive field family is also said to be closed under the relevant group of image transformations

Consider a vision system that is restricted to using rotationally symmetric image operations over the spatial image domain only. If such a vision system observes the same three-dimensional object from two different views, then the backprojections of the receptive fields onto the surface of the object will in general correspond to different regions in physical space over which corresponding information will be weighed differently. If such image measurements would be used for deriving correspondences between the two views or performing object recognition, then there would be a systematic error caused by the mismatch between the backprojections of the receptive fields from the image domain onto the world. By requiring the family of receptive fields to be covariant under local affine image deformations, it is possible to reduce this amount of mismatch, such that the backprojected receptive fields can be made similar when projected onto the tangent plane of the surface by local linearizations of the perspective mapping. Corresponding effects occur when analyzing spatio-temporal image data (video) based on receptive fields that are restricted to being space–time separable only. If an object is observed over time by two cameras having different relative motions between the camera and the observer, then the corresponding receptive fields cannot be matched unless the family of receptive fields possesses sufficient covariance properties under local Galilean transformations



Specifically, explicit functional models will be given of spatial and spatio-temporal response properties of LGN neurons and simple cells in V1, which will be compared to related models in terms of Gabor functions (Marcelja ; Jones and Palmer , ), differences of Gaussians (Rodieck ), and Gaussian derivatives (Koenderink and Doorn ; Young ; Young et al. ; Young RA, Lesperance ; Lindeberg , , , ). For chromatic input, the model also accounts for color-opponent spatio-chromatic cells in V1. Notably, the diffusion equations that describe the evolution properties over scale of these linear receptive field models are suitable for implementation on a biological architecture, since the computations can be expressed in terms of communications between neighboring computational units, where either a single computational unit or a group of computational units may be interpreted as corresponding to a neuron or a group of neurons.

Compared to previous approaches of learning receptive field properties and visual models from the statistics of natural image data (Field ; van der Schaaf and van Hateren ; Olshausen and Field ; Rao and Ballard ; Simoncelli and Olshausen ; Geisler ; Hyvärinen et al. ; Lörincz et al. ), the proposed theoretical model makes it possible to determine spatial and spatio-temporal receptive fields from first principles and thus without need for any explicit training stage or gathering of representative image data. In relation to such learning-based models, the proposed theory provides a normative approach that can be seen as describing the solutions that an ideal learning-based system may converge to, if exposed to a sufficiently large and representative set of natural image data. For these reasons, the presented approach should be of interest when modelling biological vision.

We will also show how receptive field responses can be interpreted physically as a superposition of relative variations of surface structure and illumination variations, given a logarithmic brightness scale, and how receptive field measurements will be invariant under multiplicative illumination variations and exposure control mechanisms. Despite the image measurements fundamentally being of an indirect nature, in terms of reflected light from external objects subject to unknown or uncontrolled illumination, this result shows how receptive field measurements can nevertheless be related to inherent physical properties of objects in the environment. This result therefore provides a formal justification for using receptive field responses as a basis for visual processes, analogous to the way linear receptive fields in the fovea, LGN and V1 provide the basic input to higher visual areas in biological vision.

We propose that these theoretical results contribute to an increased understanding of the role of early receptive fields in vision. Specifically, if one aims at building a neuro-inspired artificial vision system that solves actual visual tasks, we argue that an approach based on the proposed idealized models of linear receptive fields should require a significantly lower amount of training data compared to approaches that involve specific learning of receptive fields or compared to approaches that are not based on covariant receptive field models. We also argue that the proposed families of covariant receptive fields will be better at handling natural image transformations as resulting from variabilities in relation to the surrounding world.

In their survey of our knowledge of the early visual system, Carandini et al. () emphasize the need for functional models to establish a link between neural biology and perception. Einhäuser and König () argue for the need for normative approaches in vision. This paper can be seen as developing the consequences of such ways of reasoning by deriving functional models of linear receptive fields using a normative approach. Due to the formulation of the resulting receptive fields in terms of spatial and spatio-temporal derivatives of convolution kernels, it furthermore becomes feasible to analyze how receptive field responses can be related to properties of the environment using mathematical tools from differential geometry and thereby analyzing possibilities as well as constraints for visual perception.

Outline of the presentation
The treatment will be organized as follows: Sect.  formulates a set of structural requirements on the first stages of visual processing with respect to symmetry properties of the surrounding world and in relation to internal representations that are to be computed by an idealized vision system. Then, Sect.  describes the consequences of these assumptions with regard to intensity images defined over a spatial domain, with extensions to color information in Sect. . Sect.  develops a corresponding theory for spatio-temporal image data, taking into account the special nature of time-dependent image information.

Section  presents a comparison between spatial and spatio-temporal receptive fields measured from biological vision to receptive field profiles generated by the presented spatial, spatio-chromatic, and spatio-temporal scale-space theories, showing a very good qualitative agreement. Section  describes how a corresponding foveal scale-space model can be formulated for a foveal sensor to account for a spatially dependent lowest resolution with suggestions for extensions in Sect. .

Section  relates the contributions in the paper to previous work in the area in a retrospective manner, and Sect.  concludes with a summary and discussion, including an outline of further applications of how the presented theory can be used for modelling biological vision.

Structural requirements of an idealized visual front end
The notion of a visual front end refers to a set of processes at the first stages of visual processing, which are assumed to be of a general nature and whose output can be used as input to different later-stage processes, without being too specifically adapted to a particular task that would limit the applicability to other tasks. Major arguments for the definition of a visual front end are that the first stages of visual processing should be as uncommitted as possible and allow initial processing steps to be shared between different later-stage visual modules, thus implying a uniform structure on the first stages of visual computations (Koenderink et al. ; Lindeberg , Sect. ).

In the following, we will describe a set of structural requirements that can be stated concerning (i) spatial geometry, (ii) spatio-temporal geometry, (iii) the image measurement process with its close relationship to the notion of scale, (iv) internal representations of image data that are to be computed by a general purpose vision system, and (v) the parameterization of image intensity with regard to the influence of illumination variations.

The treatment that will follow can be seen as a unification, abstraction and extension of developments in the area of scale-space theory (Iijima ; Witkin ; Koenderink ; Koenderink and Doorn ; Lindeberg , , ; Sporring et al. ; Florack ; ter Haar Romeny ) as obtained during the last decades, see Sect.  and (Lindeberg , ; Weickert et al. ; Duits et al. ) for complementary surveys. It will then be shown how a generalization of this theory to be presented next can be used for deriving idealized models of receptive fields by necessity, including new extensions for modelling illumination variations in the intensity domain. Specifically, we will describe how these results can be used for computational neuroscience modelling of receptive fields with regard to biological vision.

Static image data over spatial domain
Let us initially restrict ourselves to static (time-independent) data and focus on the spatial aspects: If we regard the incoming image intensity  as defined on a 2D image plane  with Cartesian image coordinates denoted by , then the problem of defining a set of early visual operations can be formulated in terms of finding a family of operators  that are to act on  to produce a family of new intermediate image representationswhich are also defined as functions on , i.e., . These intermediate representations may be dependent on some parameter , which in the simplest case may be one-dimensional or under more general circumstances multi-dimensional.

Linearity and convolution structure
If we want these the initial visual processing stages to make as few irreversible decisions as possible, it is natural to initially require  to be a linear operator such thatholds for all functions  and all real constants . This linearity assumption implies that any special properties that we will derive for the internal representation  will also transfer to any spatial, temporal, or spatio-temporal derivatives of the image data, a property that will be essential regarding early receptive fields, since it implies that different types of image structures will be treated in a similar manner irrespective of what types of linear filters they are captured by.

Furthermore, if we want all image positions  to be treated similarly, such that the visual interpretation of an object remains the same irrespective of its location in the image plane, then it is natural to require the operator  to be shift invariant such thatholds for all translation vectors , where  denotes the shift (translation) operator defined by . Alternatively stated, the operator  can be said to be homogeneous across space.

The requirements of linearity and shift invariance together imply that the operator  can be described as a convolution transformation (Hirschmann and Widder )of the formfor some family of convolution kernels .

To be able to use tools from functional analysis, we will initially assume that both the original signal  and the family of convolution kernels  are in the Banach space , i.e. that  and  with the normThen, also the intermediate representations  will be in the same Banach space and the operators  can be regarded as well defined.

Image measurements at different scales
The reduction in the first stage of visual processing to a set of convolution transformations raises the question of what types of convolution kernels  could be regarded as natural? Specifically, we may consider convolution kernels with different spatial extent. A convolution kernel having a large spatial support can generally be expected to have the ability to respond to phenomena at coarser scales, whereas a convolution kernel with a small spatial support is generally needed to capture fine-scale phenomena. Hence, it is natural to associate a notion of scale with every image measurement. Let us therefore assume that the parameter  represents such a scale attribute and let us assume that this scale parameter should always be nonnegative  with the limit case when  corresponding to an identity operationHence, the intermediate image representations  can be regarded as a family of derived representations parameterized by a scale parameter .

Structural requirements on a scale-space representation
Semigroup and cascade properties For such image measurements to be properly related between different scales, it is natural to require the operators  with their associated convolution kernels  to form a semigroupThen, the transformation between any two different and ordered scale levels  and  with  will obey the cascade propertyi.e., a similar type of transformation as from the original image data . An image representation having these properties is referred to as a multi-scale representation.

Self-similarity Regarding the choice of convolution kernels to be used for computing a multi-scale representation, it is natural to require them to be self-similar over scale (scale invariant) in the sense that each kernel  can be regarded as a rescaled version of some prototype kernel . In the case of a scalar scale parameter, such a condition can be expressed aswith  denoting a monotonously increasing transformation of the scale parameter . For the case of a multi-dimensional scale parameter, the requirement of self-similarity over scale can be generalized intowhere  now denotes a non-singular -dimensional matrix regarding a 2D image domain and  its inverse. With this definition, a multi-scale representation with a scalar scale parameter  will be based on uniform rescalings of the prototype kernel, whereas a multi-scale representation based on a multi-dimensional scale parameter might also allow for rotations as well as non-uniform affine deformations of the prototype kernel.

Together, the requirements of a semigroup structure and self-similarity over scales imply that the parameter  gets both a (i) qualitative interpretation of the notion of scale in terms of an abstract ordering relation due to the cascade property in Eq. () and (ii) a quantitative interpretation of scale, in terms of the scale-dependent spatial transformations in Eqs. () and (). When these conditions are simultaneously satisfied, we say that the intermediate representation  constitutes a candidate for being regarded as a (weak) scale-space representation.

Infinitesimal generator For theoretical analysis, it is preferable if the scale parameter  can be treated as a continuous parameter and if image representations at adjacent scales can be related by partial differential equations. Such relations can be expressed if the semigroup possesses an infinitesimal generator (Hille and Phillips ; Pazy )and imply that the image representations at adjacent scales can be related by an evolution equation of the formwhere we would preferably like the operator  to be a partial differential operator. The infinitesimal generator is the natural correspondence to a derivative operator for semigroups.

In Eq. (), we have for simplicity assumed the scale parameter  to be a scalar (one-dimensional) parameter. For a multi-parameter scale space with a scale parameter of the form , an analogous concept can be defined in terms of the directional derivative of the semigroup along any positive direction in the parameter spacewhere each  constitutes the infinitesimal generator for the parameter  along the unit direction  in the -dimensional parameter spaceand with the notion of a “positive direction” in parameter space similar as in footnote 7.

Smoothing property: non-enhancement of local extrema A further requirement on a scale-space representation is that convolution with the scale-space kernel  should correspond to a smoothing transformation in the sense that coarser-scale representations should be guaranteed to constitute simplifications of corresponding finer scale representations and that new image structures must not be created at coarser scales  that do not correspond to simplifications of corresponding structures in the original data .

For one-dimensional signals , such a condition can be formalized as the requirement that the number of local extrema or equivalently the number of zero-crossings in the data must not increase with scale and is referred to as non-creation of local extrema (Lindeberg ). For higher-dimensional signals, however, it can be shown that there are no non-trivial linear transformations guaranteed to never increase the number of local extrema in an image (Lifshitz and Pizer ; Lindeberg ).

For higher-dimensional image data, a particularly useful generalization of this notion is that local extrema must not be enhanced with increasing scale (non-enhancement of local extrema). In other words, if at some scale level  a point  is a maximum (minimum) over the spatial domain , i.e., for the mapping , then the derivative with respect to scale at this point must not be positive (negative). For a scale-space representation based on a scalar scale parameter, we should hence require (Lindeberg , ):For a multi-parameter scale space, a corresponding requirement on a scale-space representation is that if a point  is local maximum (minimum) of the mapping , then for every positive direction in the -dimensional parameter space, the directional derivative of the semigroup  according to Eq. () must satisfy (Lindeberg ):As will be described later, this condition constitutes a strong restriction on what convolution kernels  can be regarded as scale-space kernels.

Nonnegativity and normalization Regarding the convolution kernels , it is natural to require that any scale-space kernel should be nonnegativeand have unit mass (unit -norm)Nonnegativity follows from the requirement of non-creation of new zero-crossings with increasing scale for one-dimensional signals. Normalization to unit -norm can be derived as a consequence of the requirement of non-enhancement of local extrema.

Requirements regarding spatial geometry
Rotational symmetry For a multi-scale representation based on a scalar scale parameter , it is natural to require the scale-space kernels to be rotationally symmetricfor some one-dimensional function . Such a symmetry requirement can be motivated by the requirement that in the absence of further information, all spatial directions should be equally treated (isotropy).

For a scale-space representation based on a multi-dimensional scale parameter, one may also consider a weaker requirement of rotational invariance at the level of a family of kernels, for example regarding a set of elongated kernels with different orientations in image space. Then, although the individual kernels in the filter family are not rotationally symmetric as individual filters, a collection or a group of such kernels may nevertheless capture image data of different orientation in a rotationally invariant manner, for example if all image orientations are explicitly represented or if the receptive fields corresponding to different orientations in image space can be related by linear combinations.

Affine covariance When considering surface patterns that are being deformed by the perspective transformation from the surface of an object to the image plane, a restriction to rotationally symmetric kernels only will, however, interfere with the image deformations that occur if the viewing direction varies in relation to the surface normal. If we approximate the geometry of an image deformation by the derivative of the perspective mapping and assume that there are no illumination variations, then such an image deformation can be modelled by an affine transformationcorresponding towhere  is a  matrix and  a constant offset. Specifically, we can at any image point regard such an affine transformation as a local linear approximation of the perspective mapping.

A natural requirement on an idealized vision system that observes objects whose projections on the image plane are being deformed in different ways depending on the viewing conditions is that the vision system should be able to relate or match the different internal representations of external objects that are acquired under different viewing conditions. Such a requirement is natural to enable a stable interpretation of objects in the world under variations of the orientation of the object relative to the observer, to enable invariance under variations of the viewing direction.

Hence, if an internal representation  of an image pattern  has been computed with a (possibly multi-parameter) scale parameter , we would like the vision system to be able to match this internal representation to the internal representation  of an affine transformed image pattern  computed with a different (possibly multi-parameter) scale parameter corresponding toas reflected in the commutative diagram in Fig. , where  denotes some appropriate transformation of the scale parameter. This requirement is referred to as affine covariance. Within the class of linear operators  over a two-dimensional image domain, it is, however, not possible to realize such an affine covariance property within a scale-space concept based on a scalar scale parameter. For two-dimensional image data, such affine covariance can, however, be accomplished within a three-parameter linear scale space.Commutative diagram for scale-space representations computed under affine deformations of image space. Such an affine transformation may, for example, represent a local linear approximation of the projective mapping between two different perspective projections of a surface patch



Time-dependent image data over a spatio-temporal domain
Regarding spatio-temporal image data , which we assume to be defined on a 2+1D spatio-temporal domain  with  denoting image space and  denoting time, it is natural to inherit the above-mentioned symmetry requirements expressed for the spatial domain. Hence, corresponding structural requirements as stated in Sects. , , and  should be imposed on a spatio-temporal scale space, with space  replaced by space–time  and with the scale parameter now encompassing also a notion of temporal scale, such that the multi-dimensional scale parameter  will be of the form .

Additional requirements regarding spatio-temporal geometry
Galilean covariance For time-dependent image data, it is natural to also take into explicit account the basic fact that objects may move relative to the observer. Specifically, constant velocity motionwhere  denotes the image velocity, is referred to as a Galilean transformation of space–timecorresponding toIf we assume that the image intensities at corresponding image points remain constant over time  (the constant brightness assumption), such a Galilean model can be regarded as a local linear approximation of a more general motion field.

Analogously to the previously described affine covariance property over a spatial domain, a desirable property of an idealized vision system is that it should be able to compute an internal representation  of a spatio-temporal pattern  that can be related or matched to the internal representation of some other spatio-temporal pattern  that moves with a different velocity  relative to the observer. Therefore, we would like to have the ability to relate an internal representation of this pattern  to the internal representation  of the original pattern for some appropriately transformed scale parameter :corresponding toas illustrated in the commutative diagram in Fig. . Such a property is referred to as Galilean covariance.Commutative diagram for a spatio-temporal scale-space representation computed under a Galilean transformation of space–time. Such a constant velocity motion may, for example, represent a local linear approximation of the projected motion field for corresponding image points under relative motions between objects in the world and the visual observer



Again, within the class of linear transformations , it is not possible to realize such a Galilean covariance property within a spatio-temporal scale concept based solely on a scalar spatial scale parameter  and a scalar temporal scale parameter . As will be shown later, Galilean covariance can, however, be achieved within a four-parameter linear spatio-temporal scale space.


Temporal causality When dealing with time-dependent image data, another structural requirement arises because of the basic fact that the future cannot be accessed. Hence, for any real-time computer vision system or a biological organism that interacts with the world, the convolution kernel must be time-causal in the sense that its values must be zero regarding any access to the futureWhen analyzing pre-recorded video data in an off-line situation, we may, however, decide to relax this condition to simplify the computations.

Specific constraints regarding a real-time system
Time recursivity and temporal memory When dealing with spatio-temporal image data in a real-time setting, we cannot expect the vision system to have direct access to all information from the past, since we cannot assume a computer vision system or a biological organism to store a complete recording of all visual information it has seen.

If we assume that the vision system should compute internal image representations at different temporal scales, the only reasonable approach will therefore be that these computations have to be expressed in terms of computations on some internal temporal buffer , which we assume is to be much more condensed than a complete video recording of the past. Such an internal representation is referred to as a temporal memory, and the restriction of the set of possible computations to a combination of the current image data  with such a compact temporal memory  is referred to as time recursivity. Specifically, this temporal memory  must be updated over time  according to some time-recursive model.

Given the assumption that the vision system should compute an internal scale-space representation  at different temporal scales  (where we have now changed the notation and separated the spatial scale parameter  from the temporal scale parameter ), a particularly attractive solution is if this internal representation can also serve as the internal temporal memory  for corresponding temporal scales. Let us therefore require that the spatio-temporal scale-space representation  should be updated according to a time-recursive evolution equation over scale and time of the form (Lindeberg , section 5.1.3, page 57)for any pair of scale levels  and any two time moments , wherethe kernel  performs the update on the internal representation while simultaneously respecting a cascade property for  over spatial scales  and

the kernel incorporates new information from the new image data  that arrive between  and .

Non-enhancement of local extrema in a time-causal and time-recursive setting When formalizing the notion of a smoothing operation in a time-causal and time-recursive context, where the internal temporal scale levels  are also used as the internal temporal buffer of past information, it turns out to be both useful and necessary to reformulate the requirement of non-enhancement of local extrema in the following way, to take into the fact that at any temporal moment , we will have access to image data over space , spatial scales , and temporal scales , but no direct access to image data in the future or from the past:

If at some spatial scale  and time moment  a point  is a local maximum (minimum) for the mapping , then for every positive direction in the -dimensional space consisting of the -dimensional spatial scale parameter  complemented by time , the directional derivative  of the spatio-temporal scale-space representation in this direction  must satisfy (Lindeberg , equations (79)–(80), page 52):This formulation constitutes a generalization of the non-enhancement condition () from a regular multi-parameter scale space to a time-recursive multi-parameter scale space. Both of these formulations imply a strong smoothing effect over spatial scales . For a non-causal multi-parameter scale-space applied to space–time in a non-recursive setting where time  is treated in an essentially similar way as space , non-enhancement of local extrema according to () implies a strong evolution property over temporal scales. The conceptual difference with this time-recursive formulation is that the strong temporal smoothing property, as imposed by non-enhancement of local extrema, is instead expressed in terms of the evolution properties over time and not over temporal scales .

Notably, this formulation of a temporal evolution property has an interesting interpretation of enforcing a smooth (stabilizing) temporal behavior of the internal representation  of the surrounding world as the spatio-temporal data  varies over time .

Influence of illumination variations
The above-mentioned symmetry requirements essentially refer to the geometry of space and space–time and its relation to image measurements over non-infinitesimal regions over space or space–time as formalized into the notion of a scale-space representation. Regarding the actual image intensities, these have so far been assumed to be given beforehand.

We may, however, consider different ways of parameterizing the intensity domain. Essentially, any monotonic intensity transformation will preserve the ordering of the intensity values from dark to bright. The perceptual impression of an image may, however, be substantially different after a nonlinear intensity transformation. Hence, one may ask whether we should assume the image data  to be proportional to image irradiance  (in units of power per unit area), some self-similar power of image irradiance  or whether there is a better choice?

Logarithmic brightness scale Given the huge range of brightness variations under imaging natural conditions (a range corresponding to a factor of the order of  between the darkest and brightest cases for human vision), it is natural to represent the image brightness on a logarithmic scale:Such a logarithmic scale is also reflected in the construction of most visual sensors (cameras), where aperture steps and exposure times are logarithmically distributed to handle the large range of brightness variations that occur under varying illumination conditions. A local adaptation of the sensitivity of the photoreceptors to an average illumination level can also be seen as implementing an approximation of a logarithmic transformation, provided that both the baseline and the sensitivity regarding deviations from the baseline are adapted in a corresponding manner.

Behavior under illumination variations: spatial image data
In this section, we will express properties of a logarithmic brightness scale in relation to a physical illumination model and image measurements in terms of receptive fields.

Projection model Consider a planar perspective camera model with  denoting world coordinates with the -direction perpendicular to the image plane and with the image coordinates  for simplicity expressed in units of the focal length , leading to the perspective projection equations (assuming that )Let us furthermore assume that the incoming light is collected by a thin lens with diameter .

Model for image irradiance Then, given that the image irradiance  is proportional to the surface radiance  along the direction from a point  on the surface toward its projection  on the image planeor more specifically (Horn , page 208)with the ratio  referred to as the effective f-number, and with a spatially varying reduction in image intensities toward the periphery of the image (natural vignetting) determined by the geometric factor withFrom this expression, it is clear that the proportionality constant in Eq. () depends on (i) the internal geometry of the visual sensor as captured by the constant  and (ii) the angle  between the viewing direction and the surface normal of the image plane.

Model for surface reflectance Let us next assume that the surface reflectance in the direction from the point  on the surface toward its projection  on the image planed can be modelled as proportional to an albedo factor determined by the surface material and the amount of incoming illumination with the implicit assumption that the same amount of light is emitted along all directions from the surface.

This model has a similar behavior as Lambertian surface model, with the extension that the surface may be regarded as “gray” by not reflecting all incident light. Please note, however, that this reflectance model constitutes a substantial simplification of the bidirectional reflectance function and does not comprise, e.g., specularities or materials with diffraction grating effects.

For an illumination field that is not determined by a point source only, the entity  can be seen as the integration of the incoming light  from all directions on the northern hemisphere  defined by the spherical coordinates  and  relative to the surface normal at  such thatwhere the factor  accounts for foreshortening and the factor  is the integration measure for spherical coordinates.

Combined brightness model By combining the illumination model in Eqs. () and () with the logarithmic brightness scale in Eq. () and by redefining the functions  and  such that their values for three-dimensional world coordinates  can be accessed from corresponding projected image coordinates  according to  and , we obtainwhich provides an explicit model for how the image brightness  depends onproperties of surfaces of objects in the world as condensed into the spatially dependent albedo factor  with the implicit understanding that this entity may in general refer to different surfaces in the world depending on the viewing direction  and thus the image position ,

properties of the illumination field as reflected in the spatially dependent illumination , which also may refer to the amount of incoming light on different surfaces in the world depending on the value of ,

geometric properties of the camera as condensed into a dependency on the effective -number  captured by , and

a geometric natural vignetting effect of the explicit form .

In the following, we shall develop consequences of this image formation model concerning invariance properties to the effective -number and multiplicative illumination transformations, given the specific choice of a logarithmic brightness scale.

Invariance to the effective f-number A noteworthy property of the model in Eq. () is that if we disregard effects of focal blur (not modelled here), then the influence due to the internal focal distance  and the diameter  of the camera will be cancelled, if we differentiate this expression with respect to space where  constitutes a multi-index notation. Hence, with a logarithmic brightness scale (and disregarding effects of focal blur), any spatial derivative operator will be invariant to variations in the effective f-number (as well as other multiplicative exposure parameters).

Invariance to multiplicative illumination transformations Moreover, if we consider image measurements from the same scene using a different illumination field  proportional to the original illumination fieldthen it follows that the influence of will also be cancelled after spatial differentiationTherefore, with a logarithmic brightness scale, any spatial derivative operator will be invariant to multiplicative illumination transformations. The influence of the constant  will also disappear after filtering with a kernel having integral zero, i.e., equal positive and negative contributions.

Relative measurements of physical entities Furthermore, regarding, e.g., any first-order derivative  with  equal to 1 or 2the interpretation of this first-order spatial derivative operator is that it responds to relative variations of the physical entities surface albedo  and the illumination  (where we assume these quantities to always be strictly positive and never becoming equal to zero):For a smooth surface with a spatially dependent surface pattern , the first term  reflects inherent relative spatial variations of this surface pattern as deformed by the perspective projection model in analogy with the affine deformation model ().

The second term  reflects relative spatial variations in the illumination field as arising from the interaction between the external illumination field  and the local surface geometry  at every surface point  according to ().

The third term  constitutes a geometric bias due to vignetting effects inherent to the camera. (Please note that the image coordinates in this treatment are expressed in units of the focal length with  in the central field of view.) This term will disappear for a spherical camera geometry.

If the surface albedo  and the illumination field  are also measured on a logarithmic scale, then the algebraic relationship between derivatives of image intensity  and derivatives of the physical entities  and  will be simple also for any order of differentiationInvariance properties of spatial receptive fields involving spatial derivatives There is an interesting relationship between the cancelling of multiplicative illumination transformations in Eq. () and image measurements in terms of receptive fields. If we consider the derived internal scale-space representation  of a signal  and compute any spatial derivative of this representation according tothen it follows that the effect of any multiplicative illumination transformation will be invisible to image measurements in terms of receptive fieldsthat involve spatial derivatives. Similarly, besides effects of focal blur, the intensity dependency due to variations of the effective -number  will also cancel. Hence, with a logarithmic brightness scale, image measurements in terms of receptive fields that involve spatial derivatives (or more generally any receptive field with its integral equal to zero) will be invariant under multiplicative illumination transformations and exposure conditions, with the latter corresponding to variations of the exposure time, the aperture and the ISO number of the sensor in a digital camera, or the diameter of the pupil and the photosensitivity of the photoreceptors in biological vision. The remaining response is a superposition of relative variations in surface patterns and illumination variations, with a position-dependent bias due to the vignetting effect.

It should be noted, however, that some care is needed concerning the differentiability properties of the image data. For images acquired from a natural world, there will in general be discontinuities in image brightness , due to discontinuities in depth, surface orientation, illumination, or the albedo of the surface patterns, which implies that we would generally expect to obtain strong spikes in the output if plain derivative operators would be applied to natural image data. The use of receptive field-based derivative operations, however, regularizes this problem. For the families of smoothing kernels  that can be derived from the requirement of non-enhancement of local extrema, it can be shown that the scale-space representation  will indeed become infinitely differentiable after any non-infinitesimal amount of smoothing  if we assume bounded brightness data . Hence, the output from the receptive field-based derivative operators  will always be well defined and the validity of the results in Eqs. () and () can be formally established with  replaced by :Indeed, the notion of receptive field-based derivative approximations can be regarded as necessary to make these computations of image derivatives valid. The assumption of linearity as a basic scale-space axiom in Eq. () can also be motivated from the form of this expression, by making it possible to interpret the receptive field responses as a linear superposition of relative variations in surface patterns and relative variations in the illumination field. Such an interpretation would not be possible if the smoothing operator  would be nonlinear.

Scale-space properties of receptive field measurements involving spatial derivatives Due to the linearity property, receptive field measurements involving spatial derivatives  will possess essentially similar scale-space properties over scales as possessed by the zero-order scale-space representation  of the original illumination pattern  as described in Sect. , with the main difference that the limit case in Eq. () when the scale parameter  tends to zero has to be replaced byprovided that the image data  have sufficient differentiability properties.

Behavior under illumination variations: spatio-temporal image data
Invariance properties of spatial receptive fields involving spatio-temporal derivatives For spatio-temporal image data, the corresponding image formation model becomesif we allow the effective -number to depend on time . If we measure such spatio-temporal image data using a spatio-temporal receptive field with a spatio-temporal scale parameter  that involves integration over both space  and time , and if we differentiate such a representation with respect to both space and timethen it follows that the influence of the possibly time-dependent effective -number will be cancelled after any spatial derivative operation with  (and so will the influence be of any other possibly time-dependent multiplicative exposure control mechanism).

Regarding temporal derivatives, it follows that the influence of the vignetting effect  will be cancelled by any temporal derivative operator with . The temporal derivative operator will also suppress the effect of any other solely spatial illumination variation.

Galilean covariant temporal derivative concept When considering temporal derivatives of spatio-temporal data computed for an object that moves with image velocity  relative to the observer, it is natural to consider velocity-adapted temporal derivatives along the direction of motion according toso as to obtain a temporal derivative concept that commutes with Galilean transformations. Such velocity-adapted temporal derivatives make it possible to compute Galilean covariant image representations based on receptive fields involving temporal derivatives, in analogy with the previous treatment of Galilean covariance in connection with Eq. ().

Summary regarding intensity and illumination variations
To summarize, this analysis shows that with image intensities parameterized on a logarithmic brightness scale and provided that the smoothing operation  has sufficient regularizing properties to make the computation of image derivatives well defined, receptive field responses in terms of spatial and spatio-temporal derivatives have a direct physical interpretation as the superposition ofrelative variations in the albedo of the observed surface patterns corresponding to the term  in (), and

relative variations in the illumination field corresponding to the term  in ()

with a geometric bias caused by vignetting effects that disappears for temporal derivatives with . Moreover, such receptive field measurements are invariant under multiplicative illumination transformations as well as other multiplicative exposure control mechanisms.

Spatial domain with pure intensity information
We shall now describe how the structural requirements on an idealized vision system as formulated in Sect.  restrict the class of possible image operations at the first stages of visual processing. For image data  defined over a two-dimensional spatial domain, let us assume that the first stage of visual processing as represented by the operator  should be (i) linear, (ii) shift invariant, and (iii) obey a semigroup structure over spatial scales, where we also have to assume (iv) certain regularity properties of the semigroup over scale in terms of Sobolev norms to guarantee sufficient differentiability properties with respect to space  and scale . Let us furthermore require (v) non-enhancement of local extrema to hold for any smooth image function .

Then, it can be shown (Lindeberg , Theorem 5, page 42) that these conditions together imply that the scale-space family  must satisfy a diffusion equation of the formwith the notation  for the gradient operator, and with initial condition  for some positive semi-definite  covariance matrix  and for some 2D vector , where the covariance matrix  describes the shape of the underlying smoothing kernel and the vector  describes the spatial offset or the drift velocity of a non-symmetric smoothing kernel. In terms of convolution transformations, this scale space can equivalently be constructed by convolution with affine and translated Gaussian kernelswhich for a given  and a given  satisfy the diffusion equation ().

Gaussian receptive fields
If we require the corresponding convolution kernels to be rotationally symmetric, then it follows that they will be Gaussianswith corresponding Gaussian derivative operators(with  where  and  denote the order of differentiation in the - and -directions, respectively) as shown in Fig.  with the corresponding one-dimensional Gaussian kernel and its Gaussian derivatives of the form:Such Gaussian functions have been previously used for modelling biological vision by Young (), who has shown that there are receptive fields in the striate cortex that can be well modelled by Gaussian derivatives up to order four. More generally, these Gaussian derivative operators or approximations thereof can be used as a general basis for expressing image operations such as feature detection, feature classification, surface shape, image matching, and image-based recognition (Iijima ; Witkin ; Koenderink ; Koenderink and Doorn ; Lindeberg , , , , ; Florack ; Schiele and Crowley , ; Lowe , ; Chomat et al. ; ter Haar Romeny ; Linde and Lindeberg , ; Bay et al. ). Specifically, this receptive field model makes it possible to compute scale-invariant image features and image descriptors (Crowley ; Crowley and Stern ; Lindeberg , , , ; Lowe , ; Schiele and Crowley ; Chomat et al. ; Bay et al. ). Other necessity results concerning Gaussian and Gaussian derivative kernels have been presented by Iijima (), Koenderink (), Koenderink and Doorn (), Babaud et al. (), Yuille and Poggio (), Lindeberg (, , ), and Florack and Haar Romeny ().Spatial receptive fields formed by the 2D Gaussian kernel with its partial derivatives up to order two. The corresponding family of receptive fields is closed under translations, rotations, and scaling transformations, meaning that if the underlying image is subject to a set of such image transformations, then it will always be possible to find some possibly other receptive field such that the receptive field responses of the original image and the transformed image can be matched



Affine-adapted Gaussian receptive fields
If we relax the requirement of rotational symmetry into a requirement of mirror symmetry through the origin, then it follows that the convolution kernels must instead be affine Gaussian kernelswhere  denotes any symmetric positive semi-definite  matrix. This affine scale-space concept is closed under affine transformations, meaning that if we for two affine-related imagesdefine corresponding scale-space representations according tothen these scale-space representations will be related according to (Lindeberg ; Lindeberg and Gårding )whereIn other words, given that an image  is affine transformed into an image , it will always be possible to find a transformation between the scale parameters  and  in the two domains that make it possible to match the corresponding derived internal representations  and .

Figure  shows a few examples of such kernels in different directions with the covariance matrix parameterized according towith  and  denoting the eigenvalues and  the orientation. Directional derivatives of these kernels can in turn be obtained from linear combinations of partial derivative operators according toThis “steerability” property is a basic consequence of the definition of directional derivatives and has been popularized for image processing applications by Freeman and Adelson ().Spatial receptive fields formed by affine Gaussian kernels and directional derivatives of these, here using three different covariance matrices , , and  corresponding to the directions , , and  of the major eigendirection of the covariance matrix and with first- and second-order directional derivatives computed in the corresponding orthogonal directions , , and . The corresponding family of receptive fields is closed under general affine transformations of the spatial domain, including translations, rotations, scaling transformations, and perspective foreshortening (although this figure only illustrates variabilities in the orientation of the filter, thereby disregarding variations in both size and degree of elongation)



With respect to biological vision, the affine Gaussian kernels as well as directional derivatives of these can be used for modelling receptive fields that are oriented in the spatial domain, as will be described in connection with Eq. () in Sect. . For computational vision, they can be used for computing affine invariant image features and image descriptors for, e.g., cues to surface shape, image-based matching, and recognition (Lindeberg ; Lindeberg and Gårding ; Baumberg ; Mikolajczyk and Schmid ; Tuytelaars and Gool ; Lazebnik et al. ; Rothganger et al. ).

Figure  shows the distributions of affine receptive fields of different orientations and degrees of orientation as they arise from local linearizations of a perspective projection model if we assume that the set of surface directions in the world is on average uniformly distributed in the world and if the distributions of the local surface patterns on these object surfaces are in turn without dominant directional bias and uncoupled to the orientations of the local surface patches. In our idealized model of receptive fields, all these receptive fields can be thought of as being present at every position in image space and corresponding to a uniform distribution on a hemisphere.Distributions of affine Gaussian receptive fields corresponding to a uniform distribution on a hemisphere regarding (top) zero-order smoothing kernels and (bottom) first-order derivatives. In the most idealized version of the theory, one can think of all affine receptive fields as being present at any position in the image domain. When restricted to a limited number of receptive fields in an actual implementation, there is also an issue of distributing a fixed number of receptive fields over the spatial coordinates  and the filter parameters 




Necessity of derived receptive fields in terms of derivatives
Due to the linearity of the differential equation (), which has been derived by necessity from the structural requirements, it follows that also the result of applying a linear operator  to the solution  will satisfy the differential equation, however, with a different initial conditionThe result of applying a linear operator  to the scale-space representation  will therefore satisfy the above-mentioned structural requirements of linearity, shift invariance, the weaker form of rotational invariance at the group level and non-enhancement of local extrema, with the semigroup structure () replaced by the cascade propertyThen, one may ask whether any linear operator  would be reasonable? From the requirement of scale invariance, however, if follows that the operator  must not be allowed to have non-infinitesimal support, since a non-infinitesimal support  would violate the requirement of self-similarity over scale () and it would not be possible to perform image measurements at a scale level lower than . Thus, any receptive field operator derived from the scale-space representation in a manner compatible with the structural arguments must correspond to local derivatives. In the illustrations above, partial derivatives and directional derivatives up to order two have been shown.

For directional derivatives that have been derived from elongated kernels whose underlying zero-order convolution kernels are not rotationally symmetric, it should be noted that we have aligned the directions of the directional derivative operators to the orientations of the underlying kernels. A structural motivation for making such an alignment can be obtained from a requirement of a weaker form of rotational symmetry at the group level. If we would like the family of receptive fields to be rotationally symmetric as a group, then it is natural to require the directional derivative operators to be transformed in a similar way as the underlying kernels.

Spatial domain with color information
To define a corresponding scale-space concept for color images, the simplest approach would be by computing a Gaussian scale-space representation for each color channel individually. Since the values of the color channels will usually by highly correlated, it is, however, preferable to decorrelate the dependencies by computing a color-opponent representation. Such a representation is also in good agreement with human vision, where a separation into red/green and yellow/blue color-opponent channels takes place at an early stage in the visual pathways.

Gaussian color-opponent receptive fields
Given three RGB channels obtained from a color sensor, consider a color-opponent transformation of the form (Hall et al. )where yellow is approximated by the average of the  and  channels  and  is defined as a channel of pure intensity information. Then, a Gaussian color-opponent scale-space representation can be defined by applying Gaussian convolution to the color-opponent channels :Figure  shows equivalent spatio-chromatic receptive fields corresponding to the application of Gaussian derivative operators according to () to such color-opponent channels. Figure  shows examples of applying corresponding directional derivatives according to ().Spatio-chromatic receptive fields corresponding to the application of Gaussian derivative operators up to order two to red/green, and yellow/blue color-opponent channels, respectively

Spatio-chromatic receptive fields corresponding to the application of Gaussian directional derivatives up to order two along the direction  to red/green and yellow/blue color-opponent channels, respectively 



In Hall et al. (), Linde and Lindeberg (, ), and Sande et al. (), it is shown how such spatio-chromatic receptive fields in combination with regular spatial receptive fields can constitute an effective basis for object recognition.

Another type of Gaussian color model has been proposed by Koenderink and later used by Geusebroek and his co-workers (Burghouts and Geusebroek ) with receptive fields defined over the spectrum of wavelengths in the color spectrum, corresponding to zero-, first-, and second-order derivatives with respect to wavelength.

Spatio-temporal image data
Non-causal spatio-temporal receptive fields
Let us first apply a similar way of reasoning as in Sect.  with space  replaced by space–time  and disregarding temporal causality, thereby allowing unlimited access to information over both space and time. Given image data  defined over a 2+1D spatio-temporal domain, let us therefore again assume that the first stage of visual processing as represented by the operator  should be (i) linear, (ii) shift invariant, and (iii) obey a semigroup structure over both spatial and temporal scales, where we also assume (iv) certain regularity properties of the semigroup over scale in terms of Sobolev norms to guarantee sufficient differentiability properties with respect to space , time  and spatio-temporal scales . Let us furthermore require (iv) non-enhancement of local extrema to hold for any smooth image function  and for any positive scale direction .

Then, it follows from (Lindeberg (), Theorem 5, page 42) that the scale-space representation over a 2+1D spatio-temporal domain must satisfyfor some  covariance matrix  and some 3D vector  with .

In terms of convolution kernels, the zero-order receptive fields will then be spatio-temporal Gaussian kernelswith ,where (i) , , and  determine the spatial extent, (ii)  determines the temporal extent, (iii)  denotes the image velocity and (iv)  represents a temporal delay and corresponding to a coupling between the spatial and temporal dimensions of the formwhere  denotes a one-dimensional Gaussian kernel over time with temporal extent  and temporal delay . From the corresponding Gaussian spatio-temporal scale spacespatio-temporal derivatives can then be defined according towith corresponding velocity-adapted temporal derivativesas illustrated in Figs.  and  for the case of a 1+1D space–time. Motivated by the requirement of Galilean covariance, it is natural to align the directions  in space–time for which these velocity-adapted spatio-temporal derivatives are computed to the velocity values used in the underlying zero-order spatio-temporal kernels, since the resulting velocity-adapted spatio-temporal derivatives will then be Galilean covariant. Such receptive fields or approximations thereof can be used for modelling spatio-temporal receptive fields in biological vision (Lindeberg , , ; Young et al. ; Young RA, Lesperance ) and for computing spatio-temporal image features and image descriptors for spatio-temporal recognition in computer vision (Zelnik-Manor and Irani ; Laptev and Lindeberg , , ; Laptev et al. ; Willems et al. ).Parameterization of the spatio-temporal covariance matrix for the Gaussian spatio-temporal scale space in terms of the spatial eigenvalues  and  with the associated orientation  for the purely spatial covariance matrix, the image velocity , and the amount of temporal smoothing 



Space–time separable kernels
 up to order two obtained from the Gaussian spatio-temporal scale-space in the case of a 1+1-D space–time (, , ) (horizontal axis: space , vertical axis: time )


Velocity-adapted spatio-temporal kernels
 up to order two obtained from the Gaussian spatio-temporal scale space in the case of a 1+1D space–time (, , , ) (horizontal axis: space , vertical axis: time )



Transformation property under Galilean transformations Under a Galilean transformation of space–time (), in matrix form writtencorresponding tothe corresponding Gaussian spatio-temporal representations are related in an algebraically similar way ()–() as the affine Gaussian scale space with the affine transformation matrix  replaced by a Galilean transformation matrix . In other words, if two spatio-temporal image patterns  and  are related by a Galilean transformation encompassing a translation  in space–timeand if corresponding spatio-temporal scale-space representations are defined according tofor general spatio-temporal covariance matrices  and  of the form (), then these spatio-temporal scale-space representations will be related according towhereand

Time-causal spatio-temporal receptive fields
If we on the other hand with regard to real-time biological vision want to respect both temporal causality and temporal recursivity, we obtain different families of receptive fields. Specifically, two different families of time-causal receptive fields can be derived depending on whether we require (i) a continuous semigroup structure over a continuum of temporal scales or (ii) fixate the temporal scale levels to be discrete a priori.

Time-causal semigroup Given the requirements of (i) linearity and (ii) spatial and temporal shift invariance, we require the scale-space kernels to be (iii) time-causal and require the visual front end to be (iv) time recursive in the sense that the internal image representations  at different spatial scales  and temporal scales  do also constitute a sufficient internal temporal memory  of the past, without any further need for temporal buffering. To adapt the convolution semigroup structure to a time-recursive setting, we require the spatio-temporal scale-space conceptto be generated by a (v) two-parameter semigroup over spatial scales  and time Then, it can be shown (Lindeberg , Theorem 17, page 78) that provided we impose (vi) certain regularity properties on the semigroup in terms of Sobolev norms to ensure differentiability (Lindeberg , Appendix E), then (vii) the time-recursive formulation of non-enhancement of local extrema in Eq. () with respect to a continuum of both spatial and temporal scale levels implies that the semigroup must satisfy the following system of diffusion equationsIn terms of receptive fields, this spatio-temporal scale space can be computed by convolution kernels of the formwhere is a velocity-adapted 2D affine Gaussian kernel with spatial covariance matrix  and

 is a time-causal smoothing kernel over time with temporal scale parameter , which is related to the regular one-dimensional Gaussian kernel according to . (Please note the shift of the order of the arguments between  and .)



From these kernels, spatio-temporal partial derivatives and velocity-adapted derivatives can be computed in a corresponding manner () and () as for the Gaussian spatio-temporal scale-space concept. Figures  and  show examples of such time-causal spatio-temporal kernels with their partial spatio-temporal derivatives in the space–time separable case with and for the velocity-adapted case with The time-causal smoothing kernel  has been previously used for modelling heat conduction in solids by (Carslaw and Jaeger (), section 14.2) and also been derived by Fagerström () as one member in a family of self-similar kernels obtained from the assumption of scale invariance.
Space–time separable kernels
 up to order two obtained from the time-causal spatio-temporal scale space in the case of a 1+1D space–time (, ) (horizontal axis: space , vertical axis: time )


Velocity-adapted spatio-temporal kernels
 up to order two obtained from the time-causal spatio-temporal scale space in the case of a 1+1D space–time (, , ) (horizontal axis: space , vertical axis: time )



Truncated exponential kernels/first-order integrators If we on the other hand fixate the temporal scale levels to be discrete a priori, then an alternative model for time-causal and time-recursive receptive fields can be obtained by performing the temporal smoothing using convolution with truncated exponential functionswith the composition of  such kernelshaving a Laplace transform of the formmean value (temporal delay)and variance (temporal extent)When treated as one-dimensional functions over time only, such temporal smoothing kernels do also obey basic scale-space properties in the sense of guaranteeing non-creation of new local extrema or zero-crossings with increasing scale (Lindeberg ; Lindeberg and Fagerström ). Moreover, they are inherently time recursive and obey a temporal update rule between adjacent temporal scale levels  and  of the following form:Such first-order integrators over time can also be used as an idealized computational model for temporal processing in biological neurons [see Fig.  for an illustration and also (Koch (), Chaps. 11–12) regarding physical modelling of the information transfer in dendrites of neurons].

In the absence of further information, it is natural to distribute the temporal scale levels according to a geometric series, corresponding to a uniform distribution in units of effective temporal scale:for  which by the additive property of variances between adjacent scalesimplies that the time constants of the individual temporal smoothing stages should be chosen according toIf we combine these purely temporal smoothing kernels with the general form of spatio-temporal kernelsas obtained from a principled axiomatic treatment over the joint space–time domain for the two other spatio-temporal scale-space concepts according to Eqs. () and (), we obtain an additional class of time-causal and time-recursive spatio-temporal receptive fields with the complementary restriction that the temporal scale parameter has to be discretized already in the theory and that temporal covariance cannot hold exactly for temporal scale levels that have been determined beforehand (see Figs.  and  for illustrations in the case of a  space–time). In contrast to the time-causal smoothing kernel , these kernels do therefore not allow for a continuous semigroup structure over temporal scales.
Space–time separable kernels
 up to order two corresponding to the combination of a cascade of  time-causal and time-recursive first-order integrators over the temporal domain with a Gaussian scale space over the spatial domain in the case of a 1+1D space–time (, ) and using a self-similar distribution of the scale levels according to Eqs. () and () (horizontal axis: space , vertical axis: time )


Velocity-adapted spatio-temporal kernels
 up to order two obtained by combining a cascade of  time-causal and time-recursive first-order integrators over the temporal domain with a Gaussian scale space over the spatial domain in the case of a 1+1D space–time (, , ) and using a self-similar distribution of the scale levels according to Eqs. () and () (horizontal axis: space , vertical axis: time )

Electric wiring diagram consisting of a set of resistors and capacitors that emulate a series of first-order integrators coupled in cascade, if we regard the time-varying voltage  as representing the time-varying input signal and the resulting output voltage  as representing the time-varying output signal at a coarser temporal scale. According to the theory of temporal scale-space kernels for one-dimensional signals (Lindeberg ; Lindeberg and Fagerström ), the corresponding equivalent truncated exponential kernels are the only primitive temporal smoothing kernels that guarantee both temporal causality and non-creation of local extrema (alternatively zero-crossings) with increasing temporal scale



Distributions of spatio-temporal receptive fields
Figures  and  show distributions of velocity-adapted receptive fields over image velocities, in Fig.  for a  space–time showing both the spatial and the temporal dimensions and in Fig.  for a  space–time showing only the spatial dimensions.
Spatio-temporal receptive fields corresponding to a self-similar distribution of velocity values  for a  space–time for a fixed spatial scale  and a fixed temporal scale . In the most idealized version of the theory, one can think of spatio-temporal receptive fields corresponding to all velocity values  being present at any image position . When implementing this receptive field model using a limited number of receptive fields, an additional issue arises of how to distribute the receptive fields over the spatial positions  and the filter parameters , , and  (horizontal dimension: space , vertical dimension: time )

Spatio-temporal receptive fields corresponding to a uniform distribution of motion directions and a self-similar distribution over spatial scales  for a  space–time with the temporal dimension suppressed. In the most idealized version of the theory, one can think of spatio-temporal receptive fields corresponding to all velocity vectors , spatial scales , and temporal scales  as being present at any image position . If the spatial components of these receptive fields are additionally allowed to have different spatial shapes, the variability over image velocities should also be extended with a variability over spatial covariance matrices . When implementing this receptive field model using a limited number of receptive fields, an additional issue arises of how to distribute the receptive fields over the spatial positions  and the filter parameters , , , and  (horizontal dimension: spatial coordinate , vertical dimension: spatial coordinate )



Geometric covariance properties
The time-causal spatio-temporal scale-space concept given by () is closed under (i) rescalings of the spatial and temporal dimensions, (ii) Galilean transformations of space–time, and (iii) affine transformations in the spatial domain. Hence, it satisfies the natural transformation properties that allow it to handle:image data acquired with different spatial and/or temporal sampling rates,

image structures of different spatial and/or temporal extent,

objects at different distances from the camera,

the linear component of relative motions between objects in the world and the observer, and

the linear component of perspective deformations.

Similar covariance properties hold also for the Gaussian spatio-temporal scale space. The covariance properties of the time-causal scale-space based on first-order integrators coupled in cascade are somewhat weaker over the temporal domain because of the restriction to discrete temporal scale levels.

Computational modelling of biological receptive fields
In two comprehensive reviews, DeAngelis et al. (), DeAngelis and Anzai () present overviews of spatial and temporal response properties of (classical) receptive fields in the central visual pathways. Specifically, the authors point out the limitations of defining receptive fields in the spatial domain only and emphasize the need to characterize receptive fields in the joint space–time domain, to describe how a neuron processes the visual image. Conway and Livingstone () show the result of a corresponding investigation concerning color receptive fields.

In the following, we will describe how the above-mentioned spatial and spatio-temporal scale-space concepts can be used for modelling the spatial, spatio-chromatic, and spatio-temporal response properties of biological receptive fields. Indeed, it will be shown that the Gaussian and time-causal scale-space concepts lead to predictions of receptive field profiles that are qualitatively very similar to all the receptive field types presented in DeAngelis et al. (), DeAngelis and Anzai (), and schematic simplifications of most of the receptive fields shown in Conway and Livingstone ().

LGN neurons
In the lateral geniculate nucleus (LGN), most neurons (DeAngelis et al. ; DeAngelis and Anzai )have approximately circular center-surround organization in the spatial domain (see Fig. a) and

most of the receptive fields are separable in space–time (Fig. ).

There are two main classes of temporal responses for such cells:a “non-lagged cell” is defined as a cell for which the first temporal lobe is the largest one (Fig. a), whereas

a “lagged cell” is defined as a cell for which the second lobe dominates (Fig. b).

Such temporal response properties are typical for first- and second-order temporal derivatives of a time-causal temporal scale-space representation. For the first-order temporal derivative of a time-causal temporal scale-space kernel, the first peak is strongest, whereas the second peak is the most dominant one for second-order temporal derivatives. The spatial response, on the other hand, shows a high similarity to a Laplacian of a Gaussian.Examples of receptive field profiles in the spatial domain as reported by DeAngelis et al. (), DeAngelis and Anzai (). a Receptive fields in the LGN have approximately circular center-surround responses in the spatial domain. In terms of Gaussian derivatives, this spatial response profile can be modelled by the Laplacian of the Gaussian  (see Fig. a). b Simple cells in the cerebral cortex do usually have strong directional preference in the spatial domain. In terms of Gaussian derivatives, this spatial response can be modelled as a directional derivative of an elongated affine Gaussian kernel (see Fig. b). c Complex cells are nonlinear and do not obey the superposition principle

Idealized models of receptive fields over the spatial domain: (left) The Laplacian of an isotropic two-dimensional Gaussian smoothing kernel over a spatial domain  (here with ) can be used as a model for the circular center-surround responses in the LGN illustrated in Fig. a. More generally, this Laplacian of Gaussian with a rather wide range of scales can be used as a model for retinal or LGN receptive fields of wide size ranges, depending on the scale level and the distance from the fovea (see also Sect. ). (right) First-order directional derivatives of anisotropic affine Gaussian kernels (here aligned to the coordinate directions  and with  and ) can be used as a model for simple cells with a strong directional preference as illustrated in Fig. b. More generally, elongated receptive fields can also have different degrees of elongation as described in Sect.  and illustrated in Fig. 


Examples of space–time separable receptive field profiles in the LGN as reported by DeAngelis et al. (), DeAngelis and Anzai (). There are two main categories of such cells; a for a non-lagged cell, the first temporal lobe dominates, while b for a lagged cell the second temporal lobe is strongest. In terms of the spatio-temporal receptive field model presented in this paper, non-lagged cells can be modelled by first-order temporal derivatives, while the shape of lagged cells resembles second-order temporal derivatives (see Fig. ) (horizontal dimension: space , vertical dimension: time )



Within the above-mentioned spatio-temporal scale-space theory, we can approximate the qualitative shape of these circular center-surround receptive fields in the LGN with the following idealized model:

where determines the polarity (on-center/off-surround versus off-center/on-surround),

 denotes the spatial Laplacian operator,

 denotes a rotationally symmetric spatial Gaussian,

 denotes a temporal derivative operator with respect to a possibly self-similar transformation of time  or  such that  for some constant  ( Lindeberg , Sect. , pages 59–61),

 is a temporal smoothing kernel over time corresponding to the time-causal smoothing kernel  in (), a non-causal time-shifted Gaussian kernel  according to () or a time-causal kernel corresponding to a set of first-order integrators over time coupled in cascade having a Laplace transform  according to (),

 is the order of temporal differentiation,

 is the spatial scale parameter and

 is the temporal scale parameter.

Figure a shows an illustration of the spatial response properties of such a receptive field. This model can also be used for modelling on-center/off-surround and off-center/on-surround receptive fields in the retina.

Regarding the spatial domain, the model in terms of spatial Laplacians of Gaussians  is closely related to differences in Gaussians, which have previously been shown to constitute a good approximation of the spatial variation of receptive fields in the retina and the LGN (Rodieck ). This property follows from the fact that the rotationally symmetric Gaussian satisfies the isotropic diffusion equationwhich implies that differences in Gaussians can be interpreted as approximations of derivatives over scale and hence to Laplacian responses. Conceptually, this implies very good agreement with the spatial component of the LGN model () in terms of Laplacians of Gaussians. More recently, Bonin et al. () have found that LGN responses in cats are well described by difference in Gaussians and temporal smoothing complemented by a nonlinear contrast gain control mechanism (not modelled here).

Concerning the application of the Laplacian of Gaussian model for on-center/off-surround and off-center/on-surround receptive fields in the retina, it should be emphasized that the retina also contains other types of receptive fields that are not modelled here, such as brisk transient (Y) ganglion cells that respond to rapid transients and directional selective ganglion cells that respond to visual motion (Wässle ).

Figure  shows the spatio-temporal response properties of space–time separable receptive field over a 1+1D spatio-temporal domain according to the model in Eq. () for a first-order temporal derivative in combination with a second-order spatial derivative in the left column and a second-order temporal derivative in combination with a second-order spatial derivative in the right column. These kernels were chosen to mimic the qualitative behaviour of the biological receptive fields shown in Fig. .Idealized models of space–time separable receptive fields as obtained from the spatio-temporal scale-space concepts with : (upper left) Gaussian spatio-temporal kernel  with . (upper right) Gaussian spatio-temporal kernel  with . (lower left) Time-causal spatio-temporal kernel  with . (lower right) Time-causal spatio-temporal kernel  with . For the time-causal kernels, the temporal derivatives have been computed using the transformed temporal derivative operator , here with . Compare the qualitative shapes of these kernels with the kernels in with Fig.  (horizontal dimension: space , vertical dimension: time )



Note: In all illustrations in Sect. , where spatial and spatio-temporal derivative expressions are aligned to biological data, the unit for the spatial scale parameter  corresponds to  of visual angle and the units for the temporal scale parameter  in the Gaussian spatio-temporal scale-space representation are , whereas the units for the temporal scale parameter  in the time-causal spatio-temporal scale-space representation are . For image velocities  of velocity-adapted filters, the units are . The reason why the units are different for the three types of spatio-temporal scale spaces is that the dimensionality of the temporal scale parameter is different in each of these spatio-temporal scale-space concepts.

Double-opponent spatio-chromatic cells
In a study of spatio-chromatic response properties of V1 neurons in the alert macaque monkey, Conway and Livingstone () describe receptive fields with approximately circular red/green and yellow/blue color-opponent response properties over the spatio-chromatic domain, see Fig. . Such cells are referred to as double-opponent cells, since they simultaneously compute both spatial and chromatic opponency. According to Conway and Livingstone (), this cell type can be regarded as the first layer of spatially opponent color computations.Spatio-chromatic receptive field response of a double-opponent neuron as reported by (Conway and Livingstone (), Fig. 2, page 10831) with the color channels L, M and S essentially corresponding to red, green, and blue, respectively (from these L, M, and S color channels, corresponding red/green and yellow/blue color-opponent channels can be formed from the differences between L to M and between  to S)



If we, motivated by the previous application of Laplacian of Gaussian functions to model rotationally symmetric on-center/off-surround and off-center/on-surround receptive fields in the LGN (), apply the Laplacian of the Gaussian operator to red/green and yellow/blue color-opponent channels, respectively, we obtain equivalent spatio-chromatic receptive fields corresponding to red-center/green-surround, green-center/red-surround, yellow-center/blue-surround, or blue-center/yellow-surround, respectively, as shown in Fig.  and corresponding to the following spatial receptive field model applied to the RGB channelsHence, these spatio-chromatic receptive fields can be used as an idealized model for the spatio-chromatic response properties for double-opponent cells.Idealized models of spatio-chromatic receptive fields over the spatial domain corresponding to the application of the Laplacian operator to positive and negative red/green and yellow/blue color-opponent channels, respectively



Simple cells
In V1, the receptive fields are generally different from the receptive fields in the LGN in the sense that they are (DeAngelis et al. ; DeAngelis and Anzai ):oriented in the spatial domain and

sensitive to specific stimulus velocities.

Cells (i) for which there are precisely localized “on” and “off” subregions with (ii) spatial summation within each subregion, (iii) spatial antagonism between on- and off-subregions, and (iv) whose visual responses to stationary or moving spots can be predicted from the spatial subregions are referred to as simple cells (Hubel and Wiesel , ).

Spatial dependencies
We can express an idealized scale-space model for the spatial component of this orientation dependency according towhere is a directional derivative operator,

 is the order of spatial differentiation, and

 is an affine Gaussian kernel with spatial covariance matrix  as can be parameterized according to ()

where the direction  of the directional derivative operator should preferably be aligned to the orientation  of one of the eigenvectors of .

In the specific case when the covariance matrix is proportional to a unit matrix , with  denoting the spatial scale parameter, these directional derivatives correspond to regular Gaussian derivatives as proposed as a model for spatial receptive fields by Koenderink and Doorn (, ). The use of non-isotropic covariance matrices does on the other hand allow for a higher degree of orientation selectivity and does additionally allow for closedness under affine transformations (affine covariance).

This idealized model can also be extended to recurrent intracortical feedback mechanisms as formulated by Somers et al. () and Sompolinsky and Shapley () by starting from the equivalent formulation in terms of the non-isotropic diffusion equationwith the covariance matrix  locally adapted to the statistics of image data in a neighborhood of each image point; see Weickert () and Almansa and Lindeberg () for the applications of this idea for enhancing local directional image structures in computer vision.

Relations to Gabor functions Based on the work by Marcelja (), Gabor functionshave been frequently used for modelling spatial receptive fields (Jones and Palmer , ; Ringach ) motivated by their property of minimizing the uncertainty relation. This motivation can, however, be questioned on both theoretical and empirical grounds. Stork and Wilson () argue that (i) only complex-valued Gabor functions that cannot describe single receptive field minimize the uncertainty relation, (ii) the real functions that minimize this relation are Gaussian derivatives rather than Gabor functions, and (iii) comparisons among Gabor and alternative fits to both psychophysical and physiological data have shown that in many cases, other functions (including Gaussian derivatives) provide better fits than Gabor functions do.

Conceptually, the ripples of the Gabor functions, which are given by complex sine waves, are related to the ripples of Gaussian derivatives, which are given by Hermite functions. A Gabor function, however, requires the specification of a scale parameter and a spatial frequency, whereas a Gaussian derivative requires a scale parameter and the order of differentiation (per spatial dimension). With the Gaussian derivative model, receptive fields of different orders can be mutually related by derivative operations and be computed from each other by nearest-neighbor operations. The zero-order receptive fields as well as the derivative-based receptive fields can be modelled by diffusion equations and can therefore be implemented by computations between neighboring computational units.

In relation to invariance properties, the family of affine Gaussian kernels is closed under affine image deformations, whereas the family of Gabor functions obtained by multiplying rotationally symmetric Gaussians with sine and cosine waves is not closed under affine image deformations. This means that it is not possible to compute truly affine invariant image representations from such Gabor functions. Instead, given a pair of images that are related by a non-uniform image deformation, the lack of affine covariance implies that there will be a systematic bias in the image representations derived from such Gabor functions, corresponding to the difference between the backprojected Gabor functions in the two image domains. If using receptive profiles defined from directional derivatives of affine Gaussian kernels, it will on the other hand be possible to compute provably affine invariant image representations.

With regard to invariance to multiplicative illumination variations, the even cosine component of a Gabor function does in general not have its integral equal to zero, which means that the illumination invariant properties under multiplicative illumination variations or exposure control mechanisms described in Sect.  do not hold for Gabor functions.

In this respect, the Gaussian derivative model is simpler, it can be related to image measurements by differential geometry, be derived axiomatically from symmetry principles, be computed from a minimal set of connections and allows for provable invariance properties under locally linearized image deformations (affine transformations) as well as local multiplicative illumination variations and exposure control mechanisms. Young () has more generally shown how spatial receptive fields in cats and monkeys can be well modelled by Gaussian derivatives up to order four.

In the area of computer vision, a multi-scale differential geometric framework in terms of Gaussian derivatives and closely related operators has become an accepted and de facto standard for defining image features for feature detection, feature classification, stereo matching, motion estimation, object recognition, spatio-temporal recognition, shape analysis, and image enhancement. Specifically, the formulation of image primitives in terms of scale-space derivatives makes it possible to use tools from differential geometry for deriving relationships between image features and physical properties of objects in the environment, allowing for computationally operational and theoretically well-founded modelling of possibilities or constraints for visual perception.

Orientation maps Optical imaging techniques have shown that orientation selective cells that respond best to one orientation form are grouped together in highly ordered patches and that these iso-orientation patches are organized around “orientation centers” that produce characteristic pinwheel-like patterns (Bonhoeffer and Grinvald ). Measurements have also shown that the degree of orientation selectivity varies regularly over the cortex and can be different near versus further away from the center of a pinwheel (Blasdel ). Specifically, the orientation selectivity has been reported to be lowest at the positions of the centers of the pinwheels (see Fig. ).(left) Orientation maps from the striate cortex using a color coding of the orientation preference with red corresponding to horizontal and green to vertical. (right) Selective maps with bright values corresponding to high orientation selectivity and dark values corresponding to low orientation selectivity (from Blasdel )



Given the model () of orientation selective receptive fields as depending on a spatial covariance matrix , this property is in good qualitative agreement with a distribution of receptive fields over a population over covariance matrices with different preferred orientations as determined from the eigenvectors of the covariance matrix and different ratios between the scale parameters along the preferred orientations as determined by the square root of the ratio between the eigenvalues of the covariance matrix. Specifically, the property of the orientation selectivity of being lowest at the positions of the centers of the pinwheels would be compatible with the covariance matrix there being close to alternatively closer to a unit matrix, implying that the orientations of the eigenvectors being sensitive to minor perturbations of the covariance matrix, thus causing the ratio between the eigenvalues being close to alternatively closer to one at the center of the pinwheel.

Spatio-temporal dependencies
In the joint space–time domain, the spatio-temporal response properties of receptive fields in the striate cortex range from separable (Fig. ) to strongly inseparable (Fig. ), where a majority exhibit marked space–time inseparability. The temporal profile is reported to be typically biphasic, although some cells are reported to have monophasic or triphasic responses (DeAngelis et al. ; DeAngelis and Anzai ) (Fig. , ).Examples of space–time separable receptive field profiles in the striate cortex as reported by DeAngelis et al. (), DeAngelis and Anzai (): a a non-lagged cell reminiscent of a first-order temporal derivative in time and a first-order derivative in space (compare with Fig. a) b a non-lagged cell reminiscent of a first-order temporal derivative in time and a second-order derivative in space (compare with Fig. b) (horizontal dimension: space , vertical dimension: time )

Idealized models of space–time separable receptive fields as obtained from the spatio-temporal scale-space concepts with : (upper left) Gaussian spatio-temporal kernel  with . (upper right) Gaussian spatio-temporal kernel  with . (lower left) Time-causal spatio-temporal kernel  with . (lower right) Time-causal spatio-temporal kernel  with . For the time-causal kernels, the temporal derivatives have been computed using the transformed temporal derivative operator , here with . Compare the qualitative shapes of these kernels with the kernels in Fig.  (horizontal dimension: space , vertical dimension: time )

Examples of non-separable receptive field profiles in the striate cortex as reported by DeAngelis et al. (), DeAngelis and Anzai (): a a receptive field reminiscent of a second-order derivative in tilted space–time (compare with the left column in Fig. ) b a receptive field reminiscent of a third-order derivative in tilted space–time (compare with the right column in Fig. ) (horizontal dimension: space , vertical dimension: time )

Idealized models of non-separable spatio-temporal receptive obtained by applying velocity-adapted second- and third-order derivative operations in space–time to spatio-temporal smoothing kernels generated by the spatio-temporal scale-space concept. (middle left) Gaussian spatio-temporal kernel  with . (middle right) Gaussian spatio-temporal kernel  with . (lower left) Time-causal spatio-temporal kernel  with . (lower right) Time-causal spatio-temporal kernel  with  (horizontal dimension: space , vertical dimension: time ). Compare the qualitative shapes of these kernels with the kernels in Fig.  (horizontal dimension: space , vertical dimension: time ). To handle objects or events with different relative motions between the object/event and the observer, it is natural to consider families of spatio-temporal receptive fields that are tuned to different image velocities and motion direction in image space, thus leading to a set of velocity-adapted fields tuned to different motion directions and image velocities at every image point (see Figs.  and  for schematic illustrations)



In terms of temporal derivatives, a biphasic behavior arises from first-order derivatives, a monophasic behavior from zero-order derivatives, and a triphasic behavior from second-order derivatives. Concerning the oriented spatial response characteristics, there is a high similarity with directional derivatives of Gaussian kernels (Young ).

We can state scale-space models of simple cells in V1 with similar properties using either:non-causal Gaussian spatio-temporal derivative kernels

time-causal spatio-temporal derivative kernels

with the non-causal Gaussian spatio-temporal kernels according to (), the time-causal spatio-temporal kernels according to () alternatively of the form () with the temporal smoothing based on a cascade of first-order integrators according to (), and spatio-temporal derivatives or velocity-adapted derivatives of these spatio-temporal kernels in turn defined according to () and ().

For a general orientation of receptive fields with respect to the spatial coordinate systems, these idealized receptive field models can be jointly described in the formwhere and  denote spatial directional derivative operators according to () in two orthogonal directions  and ,

 and  denote the orders of differentiation in the two orthogonal directions in the spatial domain with the overall spatial order of differentiation ,

 denotes a velocity-adapted temporal derivative operator,

 denotes the image velocity,

 denotes the order of temporal differentiation,

 denotes a spatial affine Gaussian kernel according to () that moves with image velocity  in space–time,

 denotes a spatial covariance matrix that can be parameterized by two eigenvalues  and  as well as a spatial orientation  of the form (),

 is a temporal smoothing kernel over time corresponding to the time-causal smoothing kernel  in (), a non-causal time-shifted Gaussian kernel  according to () or a time-causal kernel corresponding to a set of first-order integrators over time coupled in cascade having a Laplace transform  according to (),

 denotes the spatial scale and

 denotes the temporal scale.

Figures , , and  show a few examples of separable and inseparable kernels obtained in this way for a 1+1-dimensional space–time. In fact, using this model, it is possible to generate spatio-temporal receptive fields that are qualitatively similar to all the linear receptive field types reported from cell recordings in LGN and V1 by DeAngelis et al. (), DeAngelis and Anzai ().


Young et al. () and Young RA, Lesperance () have also shown how spatio-temporal receptive fields can be modelled by Gaussian derivatives over a spatio-temporal domain, corresponding to the Gaussian spatio-temporal concept described here, although with a different type of parameterization; see also Lindeberg (, ) for closely related earlier work. These scale-space models can therefore be regarded as idealized functional and phenomenological models of receptive fields, whose actual realization can then be implemented in different ways depending on available hardware or wetware.

Relations to approaches for learning receptive fields from natural image statistics Work has also been performed on learning receptive field properties and visual models from the statistics of natural image data (Field ; van der Schaaf and van Hateren ; Olshausen and Field ; Rao and Ballard ; Simoncelli and Olshausen ; Geisler ; Hyvärinen et al. ; Lörincz et al. ) and been shown to lead to the formation of similar receptive fields as found in biological vision. The proposed theory of receptive fields can be seen as describing basic physical constraints under which a learning-based method for the development of receptive fields will operate and the solutions to which an optimal adaptive system may converge to, if exposed to a sufficiently large and representative set of natural image data. Field () as well as Doi and Lewicki () have described how ”natural images are not random, instead they exhibit statistical regularities” and have used such statistical regularities for constraining the properties of receptive fields. The theory presented in this paper can be seen as a theory at a higher level of abstraction, in terms of basic principles that reflect properties of the environment that in turn determine properties of the image data, without need for explicitly constructing specific statistical models for the image statistics. Specifically, the proposed theory can be used for explaining why the above-mentioned statistical models lead to qualitatively similar types of receptive fields as the idealized receptive fields obtained from our theory.

An interesting observation that can be made from the similarities between the receptive field families derived by necessity from the assumptions and receptive profiles found by cell recordings in biological vision is that receptive fields in the retina, LGN, and V1 of higher mammals are very close to ideal in view of the stated structural requirements/symmetry properties. In this sense, biological vision can be seen as having adapted very well to the transformation properties of the surrounding world and the transformations that occur when a three-dimensional world is projected to a two-dimensional image domain.

Spatio-chrom-temporal receptive fields
By extending the spatial derivative operators to spatio-chromatic derivates over color-opponent channels, the color-opponent Laplacian operators in Eq. () can in combination with a temporal response function over time be used for modelling the spatio-chrom-temporal response of double-opponent neurons reported in (Conway and Livingstone (), Fig. 15) and shown in Fig. corresponding to an extension of () from purely spatio-chromatic image data to spatio-chrom-temporal image data. In the receptive fields measured by cell recordings, the rotational symmetry over the spatial domain is, however, not as fully developed for the spatio-chrom-temporal receptive fields as for the purely intensity-based spatial receptive fields.Spatio-temporal response properties of a blue/yellow double-opponent cell as reported by Conway and Livingstone (Conway and Livingstone (), Fig. 15, page 10842) with an L+M ON-center and S suppression character, with the color channels L, M, and S essentially corresponding to red, green, and blue, respectively. An idealized model for the spatio-chrom-temporal response properties of this cell can be obtained by combining the spatio-chromatic color-opponent Laplacian receptive fields in Fig.  over the spatio-chromatic domain with a space–time separable temporal smoothing filter  over the temporal domain



Motion selectivity
Concerning motion selectivity, DeAngelis et al. (), DeAngelis and Anzai () report that most cortical neurons are quite sensitive to stimulus velocity and the speed tuning is more narrow than for LGN cells. Simple cells with inseparable receptive fields have directional preference while cells with space–time separable receptive fields do not. Moreover, the preferred direction of motion corresponds to the orientation of the filter in space–time.

This structure is nicely compatible with velocity adaptation, as described in Sects.  and . Within the above-mentioned terminology,space–time separable receptive fields correspond to spatio-temporal scale-space kernels without velocity adaptation, whereas

inseparable receptive fields correspond to kernels that are explicitly adapted to nonzero velocities.

The directional preference of the cells in the spatial domain can, in turn, be controlled by the covariance matrix of the affine Gaussian scale-space concept as outlined in Sect. . We obtain receptive fields without directional preference in the spatial domain if we set the covariance matrix  proportional to the unit matrix, and space–time separable receptive fields if we in addition choose the velocity adaptation vector  equal to zero. Assuming that the influence of  and  can be neglected (e.g., by setting  proportional to the unit matrix and  to zero), the filter shape will then be determined solely by the spatial scale  and the temporal scale . Conversely, we can construct inseparable kernels with strong directional preference by appropriate combinations of the covariance matrix  and the velocity adaptation vector .

The above-mentioned fact that a majority of the cells are inseparable in space–time is indeed nicely compatible with a description in terms of a multi-parameter scale space as outlined in Sect. . If the vision system is to give a reasonable coverage of a set of filter parameters  and , then the set of filters corresponding to space–time separable receptive fields (corresponding to the filter parameters ) will be much smaller than the set of filters allowing for nonzero values of the mixed parameters  and  over space and time.

Complex cells
Besides the above-mentioned linear receptive fields, there is a large number of early nonlinear receptive fields that do not obey the superposition principle and whose response properties are rather insensitive to the phase of the visual stimuli. The response profile of such a cell in the spatial domain is typically of the form illustrated in Fig. c. Such cells for which the response properties are independent of the polarity of the stimuli are referred to as complex cells (Hubel and Wiesel , ).

In their study of spatio-temporal receptive field properties, DeAngelis et al. (), DeAngelis and Anzai () also report a large number of complex cells with nonlinear response profiles in the joint space–time domain; see Fig.  for an example. Within the framework of the presented spatio-temporal scale-space concept, it is interesting to note that nonlinear receptive fields with qualitatively similar properties can be constructed by squaring first- and second-order derivative responses and summing up these components (Koenderink and Doorn ). Provided that the filters are appropriately normalized, we can then construct a quasi-quadrature measure over a one-dimensional either spatial or temporal domain as (Lindeberg )where  denotes scale-normalized derivatives with respect to scale-normalized coordinates  (Lindeberg ) and where the constant  can be determined either to minimize the amount of ripples in the operator response () or from scale selection properties (). Within this model, the first- and second-order Gaussian derivative approximations constitute an approximation of a Hilbert pair within the Gaussian derivative framework.Response profile of a complex cell in the joint space–time domain as reported by DeAngelis et al. (), DeAngelis and Anzai (). Within the framework of the spatio-temporal scale-space framework presented in this paper, such a response property can be obtained by a quasi-quadrature combination of first- and second-order receptive fields; see Fig.  (horizontal dimension: space , vertical dimension: time )



To extend this notion to a 1+1D space–time with receptive fields based on the Gaussian spatio-temporal scale-space concept, let us introduce normalized derivatives over scale-normalized time  according to  or more generally . Let us then define the following spatio-temporal generalizations of the quasi-quadrature measureFor the time-causal scale-space, corresponding scale-normalized operators can be expressed aswhere the temporal derivatives  with respect to self-similarly transformed time are related to derivatives with respect to regular time according to  and the exponent  should be in the interval  (Lindeberg , Sect. ).

Figure  shows the result of computing the response of these quasi-quadrature measures to a delta function over a 1+1D space–time (without additional integration smoothing). Note that this type of computational structure is nicely compatible with results by Valois et al. (), who show that first- and second-order receptive fields typically occur in pairs that can be modelled as approximate Hilbert pairs. This model can therefore be interpreted as a Gaussian derivative-based analogue of the energy model for complex cells proposed by (Adelson and Bergen ; Heeger ).Idealized models of complex cells illustrated in terms of the response of different spatio-temporal quasi-quadrature measures to a delta function. (left) Computed for a spatio-temporal Gaussian  according to (top)  (middle)  (bottom)  with . (right) Computed for the time-causal kernel  according to (top)  (middle)  (bottom)  with  (horizontal dimension: space , vertical dimension: time )



As a complement to the above pointwise computation quasi-quadrature entities, we can apply a second-stage smoothing stepwith convolution kernel  over space or space–time with integration scale  and with  denoting the regular local scale parameter for computing derivatives. For the quasi-quadrature entities derived from the Gaussian spatio-temporal scale-space, we should of course choose a non-causal Gaussian spatio-temporal kernel, whereas we should for the corresponding entities derived from the time-causal spatio-temporal scale-space choose a time-causal spatio-temporal kernel for the second-stage integration smoothing. Computationally, such a second-stage smoothing step can be performed with similar diffusion mechanisms as used for performing the first stage of spatial and/or temporal scale-space smoothing. With such an additional post-smoothing stage, the response properties of these quasi-quadrature cells will be rather insensitive to the phase of the visual input and do in this respect agree with the approximate phase invariance of complex cells noted by Hubel and Wiesel (, ).

In a detailed study of the response properties of complex cells, Touryan et al. () observed an additive interaction between the eigenvectors of a quadratic nonlinear model supporting the energy model (Adelson and Bergen ; Heeger ). In a more recent study, Rust et al. () found that complex cell responses are better described by more linear filters than the one or two used in previous models. The above-mentioned quasi-quadrature models are in qualitative agreement with such computational structures. Specifically, the second-stage smoothing () of the pointwise quasi-quadrature measure is in good agreement with the model of complex cell responses in (Rust et al. (), Fig. 8, page 953) based on weighted averaging of a set of quadrature pairs.

Cell recordings have indicated that receptive fields may also be affected from stimuli outside the support region of the classical receptive field (Cavanaugh et al. , ) and that non-optimal stimuli, e.g., of different orientations than the tuning of the cell, may lead to a suppressive influence on the response properties of complex cells (Ringach et al. ; Rust et al. ; Felsen et al. ). Such suppressive influence can be obtained by (i) complementing the quasi-quadrature model with divisive normalization ( Heeger ; Schwartz and Simoncelli ) with respect to an ensemble of different nonlinear feature detectors  with their respective weights  according toWith the quasi-quadrature entities  defined from spatio-temporal receptive fields with directional tuning in the spatial domain given by a spatial covariance matrix , an image velocity  and a temporal scale an ensemble of such nonlinear receptive fields would then correspond to a population coding over different spatial orientations, motion directions, and temporal scales.

If we assume that the feature detector  at the center  of the receptive field is tuned to a special orientation  as determined by a covariance matrix  in space, to an image velocity  in space–time, and to a temporal scale , then the stimulation of another feature detector  at a neighboring spatial position  tuned to an orientation  as determined by a covariance matrix  in space, image velocity , and temporal scale  may suppress the output of  depending on the relationships between , , , , , and . An interesting question concerns whether the weights  can be determined from these entities based on geometric relationshipsor whether some other nonlinear model would be preferable. To investigate this issue, more experimental data would be needed.

Suppressive influence can also be obtained by allowing for (ii) nonlinear feedback that alters the conductivities in the diffusion equation () alternatively the corresponding spatio-temporal extension based on local image measurements or by considering (iii) recurrent feedback from higher levels that influence the gain control of the feature detectors. With these extensions, the resulting model corresponds to an integration of a hierarchical and recurrent models as advocated by Martinez and Alonso ().

In contrast to the previous treatment of linear receptive field models, which were determined by necessity from first principles, it should be emphasized that the structure of the quasi-quadrature model is not at all determined by necessity. Instead, it is presented as one possible nonlinear extension that reproduces some of the qualitative properties of complex cells.

Foveated vision
Concerning the assumption of translational invariance over the spatial domain, it is well known that the retina of humans and other higher mammals is not translationally invariant. Instead, finer scale receptive fields are concentrated toward a fovea in such a way that the spatial extent of the receptive fields increases essentially linearly with eccentricity (Koenderink and Doorn ) (see Fig. ).Results of measurements of the receptive field size as a function of eccentricity for ganglion cells in the retina from Martin and Grünert () based on the results by Watanabe and Rodieck (). The parasol cells project to the magnocellular pathway (corresponding to motion perception), whereas the midget cells project to the parvocellular pathway (corresponding to shape perception)



There are close similarities between such a behavior and the distribution of receptive fields that is obtained if we assume that the visual system has a limited processing capacity that is to be distributed over receptive fields at different scales. If we assume that the idealized vision system has a focus-of-attention mechanism that allows it to simulate translation invariance by changing the viewing direction, then based on the argument of scale invariance, it is natural to distribute the limited processing capacity in such a way that a similar amount of processing capacity is available for all scales within some scale range . In other words, the vision system should have the same number of receptive fields at all scales within some finite scale range (see Fig. ).Foveal scale-space model as obtained from the complementary assumptions of (i) a finite processing capacity that is to be uniformly distributed over scales and (ii) a preferred image point whose location can be shifted by a focus-of-attention mechanism to simulate full translational invariance



Given these assumption, it follows that the minimum receptive field size will increase linearly with the distance from the fovea, a distribution that is compatible with neurophysiological and psychophysical findings (Lindeberg and Florack ). Given such a spatially varying resolution limit, internal representations at coarser scales can then be constructed from these image measurements based on the semigroup property or the diffusion equation. Specifically, with a log-polar retinotopic mapping, the diffusion equation that governs the evolution properties over scale can equivalently be expressed on a log-polar domain (Lindeberg and Florack ). In all other respects, the receptive field profiles will be similar as for a translationally invariant spatial domain.

This foveal scale-space model has been used for computing scale-invariant image descriptors for object recognition by Kokkinos and Yuille (). A closely related model for foveal vision in terms of an inverted pyramid has been proposed by Crowley and his co-workers () with close relations to the spotlight model for visual attention by Tsotsos ().

A notable property of the receptive field measurements taken in the retina as shown in Fig.  is that the receptive field sizes are clustered along linear functions, whereas the foveal scale-space model in Fig.  is based on the assumptions that all receptive field sizes above a linearly increasing minimum receptive field size should be present. Given the semigroup property (), it follows, however, that receptive fields at scales coarser than those displayed in Fig.  can be constructed by combining receptive fields at finer scales. The distribution in Fig.  would therefore correspond to a sampling of the outer layer of the inverted cone of receptive field sizes in the foveal scale-space model shown in Fig. . Receptive fields in the interior of this cone can therefore be constructed from linear combinations of receptive field responses in the outer layer.

An interesting question concerns whether the existence of coarser-scale receptive fields corresponding to the interior of this cone could be established by cell recording of linear receptive fields in the LGN or in V1. An alternative possibility could be to investigate whether receptive fields corresponding to the outer layer of this cone could be directly combined into nonlinear receptive fields corresponding to the interior of this cone, without representing the intermediate linear receptive fields explicitly in terms of simple cells. Such investigations could then answer whether and how shift invariance is explicitly represented at the earliest levels of linear receptive fields or at higher nonlinear levels in the visual hierarchy.

Extensions
With regard to camera geometry, we have throughout based the analysis on a planar perspective projection model with a flat image plane. This choice has been made to simplify the mathematical treatment, since the translational group properties and the diffusion equations are much easier to express for a flat image geometry. To model biological vision more accurately, it would, however, be more appropriate to express a corresponding model based on a spherical camera geometry with a spherical image surface, which will lead to a scale-space concept based on diffusion equations on a sphere. Such a model would also have attractive theoretical properties in the sense that geometric distortions toward the periphery, such as vignetting, will disappear, and certain properties of global motion fields will become simpler. From such a background, the present model can be regarded as a local linearization applied in the tangent plane of the spherical camera model at the center of the visual sensor.

With regard to the logarithmic transformation of the intensity domain, it is also worth emphasizing that if we have an initial visual sensor that compresses the brightness range according to a self-similar intensity transformation with , then the result of applying a logarithmic transformation to this outputwill be of a similar form as of applying a corresponding transformation to the original data, with the only difference that the range of variations for the corresponding receptive fields will be compressed by a uniform factor  (gamma compression). In this respect, the presented model might find interesting applications when constructing computational models of human vision for evaluating the perceptual quality of image displays.

Relations to previous work
Biological vision
The notion of receptive field was originally defined by Sherrington () to describe the somatosensory area of a body surface where a stimulus could cause a reflex. Hartline () extended this notion to light stimuli and defined a visual receptive field as the area of the retina that must receive illumination in order to cause a discharge in a particular ganglion cell or nerve fiber. Kuffler () studied the substructure of retinal receptive fields and found that they are concentric with specific “on” or “off” zones. He also coined the term “on–off” receptive fields. The Nobel laurates Hubel and Wiesel (, , ) investigated and characterized the response properties of cells in the primary visual cortex (V1), discovered their orientation tuning, and proposed a taxonomy in terms of simple or complex cells based on how the cells respond to the polarity of visual stimuli. In the first wave of studies, specific stimuli such as points, bars, or sine wave gratings were used as stimuli for probing the visual cells.

Later, a new methodology for receptive field mappings was developed based on white noise stimuli, which allow for a complete characterization of the response properties of visual neurons if they can be assumed to be linear. Based on this technique, DeAngelis et al. () were able to derive more detailed maps of receptive fields, including their response properties in the joint space–time domain; see DeAngelis and Anzai () for a comprehensive overview of these developments. Conway and Livingstone () performed a corresponding investigation of spatio-chromatic and spatio-chrom-temporal response properties of receptive fields in the macaque monkey. Ringach et al. () showed how receptive field profiles of neurons can be derived using natural image sequences as stimuli. Felsen et al. () have presented comparisons between response properties of neurons to natural image features versus noise stimuli and found that in the responses of complex cells, but not of simple cells, the sensitivity is markedly higher for natural image data than for random stimuli.


Adelson and Bergen () developed a spatio-temporal energy model for motion perception based on oriented filters in the space–time domain. The quasi-quadrature approach in () and () in combination with a multi-parameter scale space can be seen as an analogue and extension of such a representation within the Gaussian derivative framework. More recently, Young et al. () showed how spatio-temporal receptive fields can be modelled by Gaussian derivatives over a spatio-temporal domain, corresponding to the Gaussian spatio-temporal concept described here, although with a different type of parameterization.

The scale-space models described in this article and our earlier work (Lindeberg , , ) unify these treatments into a joint framework and do also comprise new extensions in the following ways: (i) a new continuous time-causal scale-space model that respects forbidden access to future information, (ii) a time recursive update mechanism based on a limited temporal buffer, (iii) a better parameterization of the spatio-temporal filters with respect to image velocities and image deformations, and (iv) necessity results showing how these scale-space models can be uniquely determined from a small set of structural assumptions regarding an idealized vision system.

It should be emphasized, however, that the theoretical necessity results presented in this paper concern linear receptive fields. Characterizing nonlinear receptive fields is a much more complex issue, see Ringach () for an overview of different approaches for mapping receptive fields. Nonlinear gain control mechanisms in the retina have been modelled and related to biological cell recordings by Schwartz et al. (). Nonlinear receptive fields in V1 have been investigated and modelled in more detail by Mechler and Ringach (), Touryan et al. (), Priebe et al. (), and Rust et al. (). During recent years, there has been some questioning of whether the taxonomy by Hubel and Wiesel into simple and complex cells corresponds to distinct classes or whether V1 cells have response properties along a continuum (Mechler and Ringach ). Bardy et al. () have shown that the response properties of some classes of complex cells can be converted to putative simple cells depending on influences originating from the classical receptive field. The experimental results can, however, be strongly dependent on the experimental conditions (Kagan et al. ; Mata and Ringach ; Chen et al. ) and bimodal distributions have been found by Kagan et al. (), Ibbitson et al. (), and Chen et al. (). Moreover, Martinez and Alonso () argue that a large body of neurophysiological evidence indicates that simple cells are a separate population from the total of cortical cells in cat visual cortex. In relation to the classification of complex cells, Kagan et al. () have suggested that distinctions in the classification of complex cells should be made on whether the cells are dominated by magnocellular or parvocellular input. Martinez and Alonso () have suggested that complex cells should be divided into first-order complex cells that receive direct input from the LGN and second-order complex cells that receive input from simple cells. More recently, Williams and Shapley () have found spatial phase-sensitive detectors in V1 that respond to contrast boundaries of one sign but not the opposite. Our knowledge about nonlinear cells in area V1 is therefore far from complete (Olshausen and Field ; Carandini et al. ).

The notion of a logarithmic brightness scale goes back to the Greek astronomer Hipparchus, who constructed a subjective scale for the brightness of stars in six steps labelled “1 ...6,” where the brightest stars were said to be of the first magnitude () while the faintest stars near the limits of human perception were of the sixth magnitude. Later, when quantitative physical measurements were made possible of the intensities of different stars, it was noted that Hipparchus subjective scale did indeed correspond to a logarithmic scale. In astronomy today, the apparent brightness of stars is still measured on a logarithmic scale, although extended over a much wider span of intensity values. A logarithmic transformation of image intensities is also used in the retinex theory (Land , ).

In psychophysics, the Weber-Fechner law attempts to describe the relationship between the physical magnitude and the perceived intensity of stimuli. This law states that the ratio of an increment threshold  for a just noticeable difference in relation to the background intensity  is constant over large ranges of magnitude variations (Palmer , pages 671–672)where the constant  is referred to as the Weber ratio. The theoretical analysis of invariance properties of a logarithmic brightness scale under multiplicative transformations of the illumination field as well as multiplicative exposure control mechanisms is in excellent agreement with these psychophysical findings.

For a strictly positive entity , there are also information theoretic arguments to regard  as a default parameterization (Jaynes ). This property is essentially related to the fact that the ratio  then becomes a dimensionless integration measure. A general recommendation of care should, however, be taken when using such reasoning based on dimensionality arguments, since important phenomena could be missed, e.g., in the presence of hidden variables. The physical modelling of the effect on illumination variation on receptive field measurements in Sect.  provides a formal justification for using a logarithmic brightness scale in this context as well as an additional contribution of showing how the receptive field measurements can be related to inherent physical properties of object surfaces in the environment.

Computer vision
In the area of computer vision, multi-scale representations were first constructed by repeated smoothing and subsampling, leading to the notion of pyramids (Burt ; Crowley ; Burt and Adelson ; Crowley and Stern ; Crowley and Parker ; Crowley and Sanderson ).

Concerning the development of scale-space theory, Witkin () proposed to treat scale as a continuous parameter and noted that Gaussian convolution leads to a decreasing number of zero-crossings or local extrema for a one-dimensional signal. The first necessity results in the Western literature concerning the uniqueness of the Gaussian kernel for generating a linear scale-space representation were derived by Koenderink () based on the assumption of causality, which means that iso-surfaces in scale space should point with their convex side toward coarser scales. Related uniqueness results were presented by Babaud et al. () and by Yuille and Poggio ().


Lindeberg () showed how a reformulation of Koenderink’s causality requirement in terms of non-enhancement of local extrema in combination with the requirement of a semigroup structure could be used for deriving a scale-space theory for discrete signals. Corresponding necessity results concerning scale-space representations of continuous image data based were then presented in Lindeberg (). A cascade property was also used in the construction of binomial pyramids by Crowley (), Crowley and Stern ().


Florack and Haar Romeny () proposed to the use of scale invariance as a basic scale-space axiom and Pauwels et al. () showed that in combination with a semigroup structure, there exists a more general one-parameter family of (weak) scale-space kernels that obey these axioms, including the Poisson scale space studied by Felsberg and Sommer (), Duits et al. () have investigated the properties of these scale spaces in detail and showed that the so-called -scale spaces can be modelled by pseudo-partial differential equations. Except for the Gaussian scale space contained in this class, these self-similar scale spaces do, however, not obey non-enhancement of local extrema.

Closely related axiomatic derivations of image processing operators based on scale invariance have also been given in the earlier Japanese literature (Iijima ; Weickert et al. ). Koenderink and Doorn () showed that Gaussian derivative operators are natural operators to derive from a scale-space representation, given the assumption of scale invariance.

The connections between the strong regularizing properties of Gaussian convolution with Schwartz distribution theory have been pointed out by Florack et al. ().

Generalizations of rotationally symmetric smoothing operations to the affine Gaussian scale-space concept were introduced in (Lindeberg ) and applied in (Lindeberg and Gårding ) for the computation of affine invariant image descriptors. Specifically, a mechanism of affine shape adaptation was proposed for reaching affine covariant interest points in affine scale space, and it was shown that the computation of such affine-adapted image measurements improved the accuracy of later-stage processes in situations when there are significant perspective image deformations outside the similarity group. Baumberg () and Schaffalitzky and Zisserman () furthered this approach to wide baseline image matching. Mikolajczyk and Schmid () proposed a more efficient algorithm and quantified its performance experimentally. Tuytelaars and Gool () performed corresponding matching of widely separated views with application to object modelling. Related investigations of elongated directional filters over the spatial domain have been presented by Freeman and Adelson (); Simoncelli et al. () and Perona ().

Scale-space representations of color information have been developed by Geusebroek et al. () based on a Gaussian color model proposed by Koenderink, from which a set of differential color invariants were defined and by Hall et al. () who computed first-order partial derivatives of color-opponent channels and demonstrated the applicability of such features for object recognition. Linde and Lindeberg (, ) extended this idea by showing that highly discriminative image descriptors for object recognition can be obtained from spatio-chromatic derivatives and differential invariants up to order two. More recently, Sande et al. () have presented an evaluation of different color-based image descriptors for recognition.

Concerning temporal scale spaces, Koenderink () proposed the first scale-space concept that respects temporal causality, based on a logarithmic transformation of the time axis with the present moment as the origin. Such temporal smoothing filters have been considered in follow-up works by Florack () and ter Haar Romeny et al. (). These approaches, however, appear to require infinite memory of the past and have so far not been developed for computational applications.

To handle time causality in a manner more suitable for real-time implementation, Lindeberg and Fagerström () expressed a strictly time-recursive space–time separable spatio-temporal scale-space model based on the cascades of temporal scale-space kernels in terms of either truncated exponential functions or first-order recursive filters, based on a characterization of one-dimensional scale-space filters that guarantee non-creation of local extrema with increasing scale (Lindeberg ). These scale spaces were also time recursive in the sense that no extensive memory of the past was needed. Instead, a compact temporal buffer allowed for efficient computation of the temporal smoothing operation and temporal derivatives directly from a set of internal representations at different temporal scales. A closely related time-recursive computation of temporal derivatives has been used by Fleet and Langley ().


Lindeberg () proposed a non-separable spatio-temporal scale-space concept comprising the notion of velocity-adapted derivatives for a continuous model based on a Gaussian spatio-temporal scale-space and for a semi-discrete time-causal model; see also Lindeberg () for a more detailed description of the corresponding spatio-temporal scale-space theory. Velocity adaptation was applied to optic flow estimation by Nagel and Gehrke () and was shown to improve the accuracy in optic flow estimates in a similar manner as affine shape adaptation improves the accuracy of image descriptors under perspective image deformations outside the similarity group. A closely related approach for optic flow computation with corresponding deformation of the image filters was developed by Florack et al. (). An extension of non-separable spatio-temporal fields into time-causal velocity-adapted recursive filters was given in (Lindeberg ).


Laptev and Lindeberg () investigated the use of families of velocity-adapted filters for computing Galilean invariant image descriptors. Given an ensemble of spatio-temporal scale-space filters with different orientations in the space–time domain in a manner similar to Adelson and Bergen (), simultaneous adaptation to spatial scales, temporal scales, and image velocities was performed by a multi-parameter scale selection mechanism over these parameters. Specifically, it was shown that the use of velocity-adapted filters improved the separability between classes of spatio-temporal actions in situations when there are unknown relative motions between the objects and the observer. Generalizations of this approach to the context of Galilean invariant interest points were then presented in Lindeberg () with an integrated Galilean invariant spatio-temporal recognition scheme in (Laptev et al. ).


Fagerström () investigated self-similar temporal scale-space concepts derived from the assumptions of a semigroup structure combined with scale invariance, with an extension to the spatio-temporal domain in Fagerström () that also comprises the notion of velocity-adapted filters. Lindeberg () gives a unified treatment of the scale-space axiomatics of linear, affine, and spatio-temporal scale space for continuous images based on the assumption of non-enhancement of local extrema over spatial and spatio-temporal domains, including more explicit statements of the uniqueness results regarding the Gaussian spatio-temporal scale space earlier outlined in Lindeberg () and the application of non-enhancement of local extrema to a continuous time-causal and time-recursive spatio-temporal scale space.

Summary and conclusions
Neurophysiological recordings have shown that mammalian vision has developed receptive fields that are tuned to different sizes and orientations in the image domain as well as to different image velocities in space–time. A main message of this article has been to show that it is possible to derive such families of receptive field profiles by necessity, given a set of structural requirements on the first stages of visual processing as formalized into the notion of an idealized vision system. These structural requirements reflect structural properties of the world in terms of scale covariance, affine covariance, and Galilean covariance, which are natural to adapt to for a vision system that is to interact with the surrounding world in a successful manner. In a competition between different organisms, adaptation to these properties may constitute an evolutionary advantage.

The presented theoretical model provides a normative theory for deriving functional models of linear receptive fields based on Gaussian derivatives and closely related operators. In addition, a set of plausible mechanisms have been presented of how nonlinear receptive fields can be constructed from this theory, based on a generalized energy model. Specifically, the proposed theory can explain the different shapes of receptive field profiles that are found in biological vision from a requirement that the visual system should be able to compute covariant receptive field responses under the natural types of image transformations that occur in the environment, to enable the computation of invariant representations for perception at higher levels.

The proposed receptive field model has been related to Gabor functions, and we have presented several theoretical arguments for preferring a Gaussian derivative model or equivalently a formulation in terms of diffusion equations, with the shapes of the receptive fields parameterized by a spatial covariance matrix , an image velocity  and a temporal scale parameter , where the spatial covariance matrix  can also encompass the spatial scale parameter  depending on the choice of parameterization.

In the most idealized version of the theory, one can see the covariance matrix  in the diffusion equation and the image velocity  as locally constant within the support region of each receptive field, corresponding to a pure feed-forward model. More generally, one can consider covariance matrices and image velocities that are locally adapted to the local image structures, leading to richer families of pseudo-linear or nonlinear scale spaces, corresponding to top-down or feedback mechanisms in biological vision.

When the image data undergo natural image transformations due to variations in viewing distance, viewing direction, relative motion between the object and the observer or illumination variations, we can linearize the possibly nonlinear image transformations locally by derivatives (Jacobians), from which transformation properties in terms of the filter parameters (scale parameters, covariance matrices, and image velocities) of the receptive fields can be derived, provided that the family of receptive fields is closed under the relevant group or subgroup of image transformations in the tangent space, leading to an algebra of transformation properties of receptive fields. In this article, we have presented a coherent and unified framework for handling such locally linearized image transformations in terms of local scaling transformations, local affine transformations, local Galilean transformations, and local multiplicative intensity transformations, such that the influence of these image transformations on the receptive field responses can be well understood. More generally, the formulation of image primitives in terms of receptive field responses that are expressed in terms of scale-space derivatives makes it possible to use tools from differential geometry for deriving relationships between image features and physical properties of objects or events in the environment, thus allowing for computationally operational and theoretically well-founded modelling of possibilities or constraints for visual perception.

We have also related the proposed approach to approaches for learning receptive field profiles from natural image statistics and argued that the presented model in such a context provides a normative theory for the solutions that an idealized learning system may reach if exposed to a sufficient large and representative set of natural image data. The presented theory can therefore be used for explaining why such learning approaches lead to qualitatively similar types of receptive fields.

Several of the theoretically derived receptive field profiles presented in this article have been successfully used in a large number of computer vision applications regarding feature detection, feature classification, stereo matching, motion estimation, shape analysis, and image-based recognition. Hence, these receptive field profiles can generally serve as a basis for expressing a large number of visual operations and have empirically been shown to lead to robust algorithms. In this respect, a vision system based on these receptive field families allows for sharing of early visual modules between different higher level vision functionalities, which for a biological vision system can be motivated by efficiency of resource utilization.

The linear receptive fields obtained from this theory have been compared to receptive fields found by cell recordings in the LGN and simple cells in V1.

The proposed nonlinear quasi-quadrature model has also been related to qualitatively similar properties observed for complex cells in V1.

A striking conclusion from the comparisons in Sect.  is that the receptive field profiles derived by the axiomatic theory in Sects. – are in very good qualitative agreement with receptive field profiles recorded in biological vision. Thus, we have a very good match between consequences of the theory and experimental data.

Furthermore, this indicates that the earliest receptive fields in higher mammal vision have reached a state that is very close to ideal in view of the stated structural requirements or symmetry properties. In this sense, biological vision can be seen as having adapted very well to the transformation properties of the surrounding world and the transformations that occur when a three-dimensional world is projected onto a two-dimensional image domain.

Applications to biological vision
The presented theory provides a theoretically well-founded computational model for early receptive fields. We propose that this theory could be used as a powerful and general tool for modelling biological vision, at least in the following ways:The Gaussian and the time-causal receptive field families with their spatial and spatio-temporal derivative operators applied to luminance and color-opponent channels can be used for generating wider and more general families of receptive field profiles beyond those explicitly shown in the figures in this article. The idealized model for simple cells () comprises receptive fields of different orders of spatial and temporal differentiations, where a subset of combinations of spatial and spatio-temporal derivative operators has been demonstrated to lead to receptive field profiles in good qualitative agreement with receptive field profiles measured by cell recordings in biological vision. An interesting question concerns whether the existence of linear receptive fields corresponding to other combinations of spatial and spatio-temporal derivatives can be demonstrated, in particular when the receptive fields are measured as functions over two spatial dimensions and one temporal dimension and concerning the existence of receptive fields corresponding to higher orders of derivatives. Concerning spatio-chromatic and spatio-chrom-temporal receptive fields, the models for double-opponent receptive fields () and () are both based on rotationally symmetric Laplacians of Gaussians (alternatively differences of Gaussians) concerning the spatial dependencies. Another interesting question concerns whether biological vision implements non-symmetric spatio-chromatic receptive fields corresponding to, e.g., directional or partial derivatives of color-opponent channels as shown in Fig. , and whether or whether not tighter couplings could be established between the chromatic and temporal dimensions. Answering these questions would provide cues to what types of image structure the visual system explicitly responds to and therefore possibilities as well as limitations for perception. Hence, this theory may be used for generating predictions about new hitherto unnoticed or unreported receptive fields and for explaining their properties in terms of differential geometric measurements. This theory can also be used for raising questions about which animals have early receptive fields with properties compatible with general purpose visual operations according to the notion of an idealized visual front end.

Concerning orientation maps and population coding over image orientations and image velocities, the notion of multi-parameter receptive field families over different spatial covariance matrices , image velocities , and temporal scales  raises questions of how the receptive fields in V1 are distributed over different orientations and directional tunings. Since receptive fields have been found with different degrees of spatial eccentricities, corresponding to different scale parameters in different directions, this raises questions of whether the distribution over different degrees of spatial elongation is such that it could be explained by a geometric model over spatial covariance matrices  corresponding to structural properties of the environment. More generally and as we have previously discussed in Sect. , given that we have a population of nonlinear receptive fields that are tuned to different spatial orientations and motion directions that respond according to an energy model, an interesting question concerns how to combine the responses of a set of such nonlinear receptive fields that respond at different spatial locations and tuned to different orientations and motion directions. Could a sufficient amount of cell recordings be gathered to answer the question of how this information should be combined from a population of such nonlinear detectors, e.g., for setting the relative weights for divisive normalization or by changing the conductivities in the diffusion equations that determine the properties of the underlying receptive fields. In connection with the foveal scale-space model in Sect.  and the dominance of receptive fields with a linearly increasing receptive field size as function of eccentricity found by cell recordings of retinal ganglion cells, it would also as discussed in at the end of Sect.  be interesting to know whether and where the existence of coarser-scale receptive fields corresponding to the interior of the inverted cone in Fig.  could be established. In these and other ways, the presented mathematical framework for receptive fields could be used for expressing and raising questions about computational mechanisms.

The theoretical covariance properties of the associated scale-space concepts allow for explicit handling of invariance properties with respect to scale variations, image deformations, and relative motions. In computational models, such as neural networks, explicit incorporation of such transformation properties may be used for bypassing the need for an explicit training stage to learn corresponding invariance properties. From a biological standpoint, it appears natural that biological organisms should develop the possibility of having these transformations hard-wired or soft-wired (the latter notion meaning that a set of initial connections being trimmed after birth), since these transformations are universal. In terms of receptive fields, these transformations will then correspond to certain parameter ranges of the scale parameters, determined by the statistics of natural images. This theory may therefore be more generally used for reducing or bypassing the need for explicit learning the spatial, spatio-chromatic, and spatio-temporal response properties of early receptive fields in computational models of visual perception. In this respect, the presented theory could allow for lower needs for training data and a lower amount of computational resources in the training stage of computational vision models, by faster formation of receptive fields given a hard-wired or soft-wired architecture. The theory may also imply higher robustness of early receptive fields in computational models and require less variability in the training data.

With regard to a possible biological implementation of this theory, the evolution properties of the presented scale-space models are governed by diffusion equations, which can be implemented by operations over neighborhoods. Hence, the computations can naturally be implemented in terms of connections between different cells. Diffusion equations are also used in mean field theory for approximating the computations that are performed by populations of neurons (Omurtag et al. ; Mattia and Guidice ; Faugeras et al. ). The generalized semigroup property () with the corresponding cascade property () possibly expressed for a multi-parameter scale space and the diffusion equations in terms of infinitesimal generators () and () describe how receptive fields corresponding to different possibly multi-dimensional scale parameters can be related and hence how receptive fields at coarser scales can be computed from receptive fields at finer scales. In a neural network implementation, these relations can hence be used for setting the weights for communications between different cells. This theory also provides a framework for modelling and explaining the temporal dynamics of neural computations between cells at different levels of processing. In this respect, the theory naturally leads to a hierarchical architecture with explicit expressions for how receptive fields in the fovea can constitute the basis for receptive fields in the LGN and these in turn can be used for defining receptive fields in V1 and later stages in the visual cortex.

It should be emphasized, however, that this model has not been primarily constructed to accurately reproduce experimental findings regarding biological vision. Instead, the focus has been on formulating an idealized theoretical model for the types of computations that are natural to perform at the earliest stages of visual processing given theoretical properties of the structure of the surrounding world, which are then expressed as fundamental assumptions about the functionality of the vision system. If the model should be regarded as biomimetic, that would then be in a weaker sense of performing similar types of functions.

In this way, specific properties of specific organisms are suppressed (and not considered here because of reasons of scope). The approach is therefore more related to approaches in theoretical physics, where symmetry properties of the world are used as fundamentals in the formulation of physical theories. In the area of scale-space theory, these structural assumptions are referred as scale-space axioms.

Concerning notation, we will throughout use a notation similar to physics or mathematics, with scalars and vectors represented by lower case letters,  and , (without explicit notational overhead for vectors) and matrices represented by upper case letters,  or . Operators that act on functions will be represented by calligraphic symbols,  and , and we use either lower case or upper case letters for functions,  and . The overall convention is that the meaning of a symbol is defined the first time it is used.

In Eq. (), the symbol “” at the position of the first argument of  is a place holder to emphasize that in this relation,  is regarded as a function and not evaluated with respect to its first argument . The following semi-colon emphasizes the different natures of the image coordinates  and the filter parameters .

More precisely, we will assume that linearity should hold for some transformation  of the original luminosity values  in units of local energy measurements. In Sect.  it will be shown that a logarithmic intensity mapping  is particularly attractive in this respect by allowing for invariance of receptive field responses under local multiplicative intensity transformations.

For us humans and other higher mammals, the retina is obviously not translationally invariant. Instead, finer scale receptive fields are concentrated to the fovea in such a way that the minimum receptive field size increases essentially linearly with eccentricity (see Sect. ). With respect to such a sensor space, the assumption about translational invariance should be taken as an idealized model for the region in space where there are receptive fields above a certain size.

The symbol “” used as placeholder for the first argument of  and the argument of  in Eq. () indicate that the convolution operation “” is performed over the corresponding variable.

With  representing a multi-dimensional scale parameter , Eq. () should be interpreted as  with .

With  and  denoting two -dimensional scale parameters, the inequality  should be interpreted as a requirement that the scale levels  and  have to be ordered in the sense that the increment  should correspond to a positive direction in parameter space that can be interpreted as increasing levels of scale. For example, for the affine spatial scale-space concept  to be considered later in Sect. , which for two-dimensional images  can be parameterized by positive semi-definite  covariance matrices , the requirement of an ordered and positive scale direction  between the scale-space representations computed for two different covariance matrices  and  means that the difference between these covariance matrices  must be positive semi-definite. With the corresponding multi-dimensional scale parameters  and  expressed as vectors  and  where  denote the elements of  for  and , the condition for  to correspond to a positive direction in parameter space can therefore be expressed as  and .

This constant brightness assumption is guaranteed to hold for a Lambertian reflectance model extended with a spatially varying albedo, if the surface pattern is subject to illumination that is constant over time for corresponding surface points, see Sect.  for a more detailed model of receptive field responses under illumination variations. If the illumination intensity or the orientation of the surface normal in relation to the light source varies over time, however, the constant brightness assumption may be violated, or if the reflectance model comprises non-Lambertian, e.g., specular components. In such situations, a motion field computed from the optical flow obtained from the constant brightness assumption may therefore be different than the projected motion field of physical particles in the world. This situation can on the other hand be improved by instead applying a constancy assumption to spatial derivatives of the image intensity instead of the original zero-order image intensity. As explained in Sect. , such an assumption will in the specific case of a logarithmic brightness scale cancel the influence of local multiplicative illumination variations. By furthermore applying the constancy assumption to the output from several derivative operators simultaneously and additionally combining this assumption with an assumption of local coherence of the motion, e.g., in terms of a low parameter motion model over local regions in image space, one may additionally address the ambiguity of the aperture problem, provided that the local region of image space at which the low parameter image model is applied contains a sufficiently rich distribution of image structures of different orientations. Otherwise, the aperture problem states that under the assumption of constant brightness of corresponding physical points over time, only the motion component that is parallel to the local image gradient can be computed. The notion a Reichardt detector (Reichardt ; Reichardt and Schögl ) also addresses this issue by delay-coupled receptive fields in the retina. For the purpose of describing motion selective and motion-adapted properties of receptive fields, we shall, however, here for simplicity of presentation model temporal motions in terms of local Galilean transformations applied to image intensities, bearing in mind that this model can in a straightforward manner be transferred to the assumption of constancy of spatial derivative responses over time. Indeed, the spatio-temporal biological receptive fields that we shall describe in more detail in Sect.  do all support such a view by all comprising nonzero first, second, or third orders of spatial differentiation.

Note that the form of the vignetting effect may be different for lens systems composed of several lenses, and that lens systems are usually constructed to reduce the vignetting effect over some central part of the field of view. Notably, this natural vignetting effect will not be present with a spherical camera geometry, which is of high relevance with regard to biological vision.

To ensure sufficient differentiability properties such that an infinitesimal generator exists and the resulting multi-scale representation obtained by convolution with the semigroup of convolution kernels can be differentiated with respect to both space and scale such that the requirement of non-enhancement of local extrema can be applied, we do formally for an -dimensional spatial domain require the semigroup  to be -continuous such that  should hold for some  and for all smooth functions  with  denoting the -based Sobolev norm  and  denoting the Fourier transform of  over ; see (Lindeberg (), Sect. 3.2 and “Appendix A”) regarding details.

With “rotational invariance at the group level” meaning that although a set of receptive fields may not be rotationally symmetric as individuals, a collection or a group of such receptive fields may nevertheless make it possible to generate rotationally invariant responses, for example if all orientations are explicitly represented or if the receptive fields of different orientations can be related by linear combinations.

To ensure sufficient differentiability properties such that an infinitesimal generator exists and the resulting multi-scale representation obtained by convolution with the semigroup of convolution kernels can be differentiated with respect to both space–time and spatio-temporal scales such that the requirement of non-enhancement of local extrema can be applied, we do formally for an -dimensional space–time require the semigroup  to be -continuous in the sense that  should hold for some  and for all smooth functions  with  denoting the -based Sobolev norm  and  denoting the Fourier transform of  over ; see (Lindeberg (), Sect. 3.2 and “Appendix A”) regarding details.

It can be shown that this definition is compatible with spatio-temporal scale invariance for scale selection based on local extrema over temporal scales of scale-normalized derivatives (manuscript in preparation). Specifically, the value  can be motivated both from theoretical considerations and agreement with biological receptive fields.

By the use of locally adapted feedback, the resulting evolution equation does not obey the original linearity and shift invariance (homogeneity) requirements used for deriving the idealized affine Gaussian receptive field model, if the covariance matrices  are determined from properties of the image data that are determined in a nonlinear way. For a fixed set of covariance matrices  at any image point, the evolution equation will still be linear and will specifically obey non-enhancement of local extrema. In this respect, the resulting model could be regarded as a simplest form of nonlinear extension of the linear receptive field model.

The support from the Swedish Research Council, Vetenskapsrådet (contract 2010-4766) and from the Royal Swedish Academy of Sciences as well as the Knut and Alice Wallenberg Foundation is gratefully acknowledged.

I would like to thank Benjamin Auffarth, Oskar Linde, and Prof. Per Roland for valuable discussions and comments. 

The support from the Swedish Research Council, Vetenskapsrådet (contracts 2004-4680, 2010-4766) and from the Royal Swedish Academy of Sciences as well as the Knut and Alice Wallenberg Foundation is gratefully acknowledged.

