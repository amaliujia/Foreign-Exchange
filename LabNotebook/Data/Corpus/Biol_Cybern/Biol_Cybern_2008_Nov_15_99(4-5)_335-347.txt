1 Introduction
Large-scale simulations of cortical activity and theoretical investigations of neuronal dynamics require neuron models that are mathematically tractable, biologically relevant and computationally fast. Moreover, a modeling framework should be sufficiently versatile to span the whole diversity of neuron types by tuning a restricted number of parameters, avoiding the need of a new model for each class of neuron. Modeling the complete gating dynamics of ion channel densities in neuronal membranes satisfies only two of these five requirements: biological relevance and versatility. On the other hand, modeling a neuron either as a coincidence detector, as a resettable integrator or as a stochastic point process may fail to catch important aspects of single-neuron behavior. Small modifications to these simple models can bring them closer to reality. Lately multiple advances were made in that direction.

In the presence of high synaptic bombardment, modeling accurately the spike initiation is crucial and the Leaky Integrate-and-Fire (LIF) must be augmented by an exponential term to faithfully process fast inputs signals (). An additional recovery variable is important to capture adaptation and resonance properties (; ). A simple quadratic model of spike initiation with a linearly dependent recovery variable and a reset in the state variables is sufficient to account for most types of firing patterns observed in the central nervous system (), but spike firing in that model occurs with an unrealistic delay. Unlike a quadratic dependence on voltage (), an exponential nonlinearity () keeps the subthreshold dynamics linear and matches direct measurements in cortical neurons (). The exponential model combined with an adaptation variable, called the adaptive exponential integrate-and-fire (AdEx), is simple because it is described by only two equations and a reset condition. It is by construction more realistic than the LIF, and it was shown to predict with high accuracy the spike timing of a conductance-based Hodgkin and Huxley model () and the spike timing of real pyramidal neurons under noisy current injection ({x8|Clopath et al. 2007}; ).

In this paper, we explore the versatility and the biological relevance of the AdEx model. We show that the AdEx reproduces multiple firing patterns and study the correspondence between the parameters and the firing types. Finally, we fit the model to experimental traces and obtain sets of parameters describing cortical fast spiking interneurons and regular spiking pyramidal neurons.

2 Adaptive exponential integrate-and-fire
The adaptive Exponential Integrate-and-Fire model (AdEx) describes the evolution of the membrane potential V(t) when a current I(t) is injected. It consists of a system of two differential equations: , .

When the current drives the potential beyound VT the exponential term actuates a positive feedback which leads to the upswing of the action potential. The exponential is related to the quasi-instantaneous reaction of the activation variable of the sodium channel in a Hodgkin-Huxley-type neuron model. The upswing is stopped at a reset threshold which we fix at 0 mV. The downswing of the action potential, is replaced by the reset condition: .

We emphasize that voltage reset is to a fixed value Vr, whereas w-reset is by a fixed amount b. Therefore the adaptation variable w can accumulate during a spike train whereas voltage does not.

There are nine parameters required to define the evolution of the membrane potential (V) and the adaptation current (w). The nine parameters can be separated into scaling parameters and bifurcation parameters. The scaling parameters are the parameters responsible for scaling the time axis, for the stretch and for the offset of state variables. The five scaling parameters are: total capacitance (C), total leak conductance (gL), effective rest potential (EL), threshold slope factor (ΔT), effective threshold potential (VT). Absorbing the parameters C and gL into the time scale τm = C/gL , and using ΔT and VT to set the scale and offset of the membrane potential, then after appropriate rescaling of I and w, Eqs.  and  can be reduced to a system of equations with dimensionless variables and only four parameters (). The resulting four parameters are bifurcation parameters and are directly proportional to the conductance a, the time constant τw the spike triggered adaptation b, and the reset potential Vr. Modifying these parameters brings qualitative changes in the behavior of the system, such that different firing patterns become possible. Note that a controls the sensitivity of the adaptation current to voltage even in the absence of spikes. This voltage coupling can arise from linearized ion channels (; ; ; ) or from the interaction with a passive dendritic compartment which is not modeled explicitly. Voltage coupling via the parameter a with a &gt; 0 acts like a negative feedback and leads to adaptation. This parameter can arise from the linearization of “resonant currents” () and can give rise to damped subthreshold oscillations. In the AdEx we assume that the voltage coupling (characterized by a) and the spike-triggered adaptation (characterized by b) have a similar time constant and can thus be lumped together in a single equation (Eq. ). The biophysical mechanisms for spike-triggered adaptation are ion channels such as IM, IK(slow), or IK(Ca) (). Note that the spike triggered adaptation has contributions from both the a-term and the b-term. Having two parameters (a and b) allows to decouple the spike-triggered adaptation from the voltage coupling.

The role of the bifurcation parameters is best understood through phase plane analysis (for an introduction see ). Briefly, phase plane analysis involves plotting the state variables relative to each other. Nullclines represent the area in phase space in which a given variable remains constant. The V-nullcline (or w-nullcline) is defined as the set of points with dV / dt = 0 (or dw / dt = 0 respectively). The shape and position of the nullclines depends on the parameters of the model. For instance the minimum of the V-nullcline is given by the parameter VT. The slope of the left branch of the V-nullcline is proportional to the leak conductance gL. Changing the current in Eq.  involves a vertical shift in the V-nullcline without changing its shape (Figs. , , ). The intersection of the two nullclines defines fixed points which can be stable or unstable. In particular, these fixed points can change position, merge and disappear or simply loose or gain stability upon changes in one or several parameters. At a bifurcation, a change in the stability of the pattern of fixed points occurs, and this qualitatively modifies the behavior of the system. In the system of Eqs.  and , the choice of a and τw determines whether an increase in current induces a loss of stability via an Andronov-Hopf or via a saddle-node bifurcation (Fig. ). When the current is increased such that the stable fixed point of Eqs.  and  looses stability, repetitive spiking ensues and the current at which this occurs is called the rheobase.
Phase plane representation of a step current injected in an AdEx model where a a saddle-node bifurcation is responsible for the loss of stability, and b the Andronov-Hopf bifurcation is responsible for the loss of stability. In the phase planes the trajectories of the first and second spikes are represented by blue squares and the state of rest is indicated by the blue cross. As the current increases, the V-nullcline shifts upwards. This makes the two fixed pointsmove toward each other. a In the saddlenode bifurcation, the fixed points disappear after the stable fixed point merges with the unstable fixed point. The point where the two fixed points merge lies close to (but slightly to the right of) the voltage VT , i.e. the minimum of the V-nullcline. b As the stable fixed point moves towards the right, the slope of the V -nullcline increases at the fixed point. If the slope of the w-nullcline is sufficiently high, this can lead to a loss of stability of the stable fixed point before the fixed points disappear. The w-nullcline is shown in green, the V-nullcline in the absence of current is the curved dash line, the V-nullcline in the presence of stimulating current is the curved solid line (black). Unstable fixed points are encircled. The scale bars corresponds to 20 mV vertically and 20 ms horizontally

The Type of f-I curve depends on the point of reset. a When a = 0 only type I f-I curves are possible. The phase plane at a current just above rheobase (I = ISN + 0.5 pA) shows that the trajectories are forced to pass through the ghost of the saddle-node bifurcation independently of the starting point (three steady-state trajectories are shown for three different values of Vr voltage reset). The frequency-current plot on the right shows the f-I curve corresponding the the three different reset conditions (consistent line types; full, dash or dot/dash). b When a &gt; 0 it is possible to have type I and type II depending on the reset. The region in pink shows the basin of attraction of the stable fixed point just before (I = ISN − 0.1 pA) the system loses stability via a saddle-node bifurcation. The resets at −50 and −60 mV result in trajectories that pass very near the two nullclines, and are therefore very slow. The reset at −80 mV is outside the ghost of the attraction basin so that its trajectory passes further away from the saddle-node bifurcation. The insets show the enlarged areas enclosed by the gray rectangles. The arrow on the I-axis of the f-I plot indicates the current that was used to draw nullclines and trajectories in the phase plane. The conventions for line colors is the same as in Fig. 

Phase diagram and associated traces illustrating two types of tonic spiking: tonic spiking with sharp reset (a) and tonic spiking with broad reset (b). The only modifications needed to change the neuron model (a sharp resets) into the neuron model (b broad resets) is an increase of the spike triggered adaptation b and increase of the voltage reset, Vr. In both cases, some degree of adaptation is seen, yet both traces do not belong to the continuously adapting class because there is no substantial adaptation beyond the first two inter-spike intervals. The convention for symbols, line colors and scale bars was the same as in Fig. 



A mathematical analysis () has shown that under the condition a/gL &gt; τm/τw the transition occurs via the Andronov-Hopf bifurcation at the value: , and otherwise (a/gL &lt; τm/τw) via the saddle-node bifurcation at the value . Together, ISN or IAH define the current at which the AdEx starts spiking, i.e. the rheobase. In continuous two-dimensional neuron models such as the Morris-Lecar model, the type of bifurcation is directly related to the type of frequency-current (f-I) relation (). Model neurons with a saddle-node on invariant circle bifurcation have a continuous f-I curve (very low firing frequency for currents just above rheobase) and are classified as type I neurons, whereas neurons with an Andronov-Hopf-bifurcation or a saddle-node bifurcation off invariant circle have a discontinuous f-I curve with a jump to finite firing frequency just above rheobase and are classified as type II (). A one-dimensional quadratic () or exponential () integrate-and-fire with voltage reset to the resting potential model has a saddle-node bifurcation, and is always type I. Interestingly, such a simple relation between bifurcation class and type of f-I curve does not hold for the AdEx model, because of an intricate interplay between the continuous two-dimensional dynamics and the discontinuous reset. Different values of the reset parameters Vr and b can yield a continuous f-I curve as in a type I neuron model, or a discontinuous f-I curve as in a type II neuron model (Fig. , ). Very low firing frequencies in a neuron with saddle-node bifurcation just above rheobase are possible if the limit cycle passes through the region where at rheobase current, the saddle and the node merged. In this region (the ‘ghost’ of the saddle-node bifurcation) the speed of the trajectory is very low leading to long inter-spike intervals. However, for some combinations of the reset values Vr and b, the trajectory in the AdEx model does not pass nearby the lost fixed point, but passes further away, leading to a finite period of the limit cycle (Fig. , ). This is the case where the system just below rheobase is bistable, i.e., at the same constant subthreshold input, both periodic firing and constant membrane potential are possible. We note that for a small adaptation parameter a → 0, such a bistability is not possible unless the reset Vr is above VT. To summarize, the value of the reset parameters have a crucial role in determining the neuronal firing patterns—and this will be explored in the next section.

3 Multiple firing patterns
In order to study the range of firing patterns accessible with the AdEx, we simulate the injection of a step current. This is the most common experimental paradigm used by electrophysiologists to study and classify neurons (). Mathematically, this situation corresponds to the solution of Eqs.  and  with constant current and initial values V(0) = EL and w(0) = 0. Similar to what is seen in real neurons, the response of the model to the step current is very diverse, and depends on the choice of parameters. In Fig.  we show an example of typical firing patterns that can be generated by varying the parameters of the AdEx. The parameters associated with each example are given in Table . In this section we will describe how the different firing patterns arise with our simple model.
Phase plane representation of eight firing patterns. Firing patterns observed during a step current stimulation are: a tonic spiking, b adaptation, c initial burst, d regular bursting, e delayed accelerating, f delayed regular bursting, g transient spiking and h irregular spiking. The voltage traces are shown with a scale bar that corresponds to 100 and 20 mV. The graphs on the left show the traces in the phase planes as a trajectory (blue line) in the two state variables (V(t), w(t)). The w-nullcline (green) is a straight line, the V-nullcline before current stimulation is the curved dashed black line, and in the presence of stimulation, the curved solid line (black). The stable fixed point in (g) is indicated with a black, filled circle, and all the other symbols refer to the same convention as in Figs.  and . Comparing b with c illustrates that reset points jumping above the V-nullcline lead to initial bursting. Comparing c with d clarifies that regular bursting is obtained when the first broad reset generate a trajectory that passes below at least one of the previous reset points

Parameters and cost for fits shown in Fig.  and for firing pattern examples shown in Fig. 

Type	C (pF)	gL (nS)	EL (mV)	VT (mV)	ΔT (mV)	a (nS)	τw (ms)	b (pA)	Vr (mV)	C(β)	I (pA)	
Fig. , cNA	59	2.9	−62	−42	3.0	1.8	16	61	−54	8.4	184	
Fig. , cAD	83	1.7	−59	−56	5.5	2.0	41	55	−54	10.4	116	
Fig. , RS	104	4.3	−65	−52	0.8	−0.8	88	65	−53	10.4	98	
Fig. a	200	10	−70	−50	2	2	30	0	−58	−	500	
Fig. 	200	12	−70	−50	2	2	300	60	−58	−	500	
Fig. 	130	18	−58	−50	2	4	150	120	−50	−	400	
Fig. 	200	10	−58	−50	2	2	120	100	−46	−	210	
Fig. 	200	12	−70	−50	2	−10	300	0	−58	−	300	
Fig. 	200	12	−70	−50	2	−6	300	0	−58	−	110	
Fig. 	100	10	−65	−50	2	−10	90	30	−47	−	350	
Figs. , 	100	12	−60	−50	2	−11	130	30	−48	−	160	
Comparison of the AdEx with three types of cortical neurons on step current injections. From left to right: experimental traces (red), AdEx model (blue), and overlay of the traces during onset and offset of the current step. From top to bottom: cNA(a), cAD (b), and RS (c). The left scale bar shows 20 mV and 300 ms, the scale bar for the overlays shows 20 mV and 20 ms. The current injections corresponds to 150 pA for cNA, 105 pA for cAD, and 130 pA for RS. Only one of the five repetitions is shown for clarity. Across multiple repetitions of the same stimulus, the time of the first spike or the first interspike intervals may jitter around what is seen on this figure. The f-I curves (d, e, f) of the fitted models show a steeper slope for the interneurons (d and e cNA and cAD, respectively) and a slow, type-I slope for the RS cells (f)

Irregular firing is chaos in the AdEx. a Spikes times of an irregular spiking model are shown for three different amplitudes of the stimulating current step. At medium current amplitude (I = 150 pA) it spikes without periodicity, this current amplitude was used to make b and c. b The numerical integration of an irregular spiking model depends heavily on the initial conditions, such that ζ grows exponentially with the number of spikes simulated. The stars denote a modification of the initial condition in w only, the diamonds is a modification in V and the circles a modification in both w and V . c A linear fit shows a slope of 2.56 (full line). The interval map between each interspike interval and the preceding one appears as a thin, continous curve (n = 1240 spikes). The parameters for the irregular spiking model are given in Table 



Sharp versus broad spike after potential (SAP) The AdEx can produce adapting and tonic traces of two qualitatively different types. In Fig.  we see an example of sharp SAPs where the potential increases monotonically after a rapid downswing of the action potential. This type of reset is commonly seen in fast spiking interneurons (), and corresponds to a low value of the voltage reset Vr , combined with a weak spike-triggered adaptation b. In the phase plane we see that the reset is made at a point below the V-nullcline.

Broad SAPs, on the other hand, are observed in regular spiking pyramidal neurons () and in the continuously adapting interneurons. A broad SAP is recognized by its low curvature at all times after the spike (Fig. ).

The two types of SAPs correspond to two different spiking trajectories in the phase plane of the AdEx model. These are determined by the location of the reset point in the phase plane. If the reset point is above the V-nullcline (where dV / dt &lt; 0 everywhere), the voltage will decrease before increasing in preparation of a spike, this trajectory is termed a broad SAP or broad reset. If the reset point is below the V-nullcline, the spiking trajectory starts to increase immediately after the reset (dV / dt &gt; 0 everywhere below the V-nullcline), and the SAP appears as a sharp reset. We can write this distinction as an analytical relation that depends on the reset point (Vr, wr). There is a broad reset if , and otherwise the reset is sharp.

Tonic versus adapting The simplest type of spiking pattern is the regular discharge of action potentials (tonic firing, see Fig. ). This firing pattern is the only firing pattern that a standard leaky or non-leaky integrate-and-fire model can generate subject to constant current injection. In the framework of the AdEx, it corresponds to the absence of spike-triggered adaptation and adaptation sensitivity to subthreshold voltage (a, b = 0). Most neurons, however, show some level of spike-frequency adaptation. In this firing pattern, the inter-spike interval (ISI) grows during a sustained stimulus (Fig. ). The classification between adapting and non-adapting can be drawn from the adaptation index:  where k ⩾ 2 is used to disregard any initial transient. Consistent with other studies (), we take k = 4; i.e. we disregard the first two inter-spike intervals. Typically fast spiking interneurons have an adaptation index, A, of 0.005 whereas regular spiking pyramidal neurons have A = 0.015 (with N = 15 to 40 spikes, ). The adaptation index will depend on the number of spikes considered, in this article, we will compute the adaptation index with N fixed to 20 spikes, and take Ac = 0.01 as a critical value for classifying a spike train as adapting (A ⩽ Ac) or non-adapting (A &gt; Ac).

Initial bursting versus adapting Initial bursting denotes a group of spikes that were emitted at a frequency considerably greater than the steady-state frequency. This definition is very ambiguous and in many experimental traces initial bursting is indistinguishable from pronounced adaptation. In the framework of the AdEx, a clear definition becomes apparent. Initial bursting arises when the spiking starts with one or several sharp reset followed by broad resets only (Fig. ). With this definition, there is a qualitative difference between the SAP forming the initial burst and the SAP forming the tonic spiking that follows, as observed in experiments ().

Regular bursting Regular bursting appears in a scenario similar to initial bursting except that the trajectory starting after the first broad reset projects below at least one of the previous reset points in the phase plane, such that the next reset point is below the V-nullcline; i.e. the next reset is sharp (Fig. ). This situation leads to an alternation between sharp and broad resets. Regular bursting is made possible with a Vr higher than the effective threshold VT (note that VT corresponds to the minimum of the V-nullcline), so as to ‘shield’ some reset points on the right hand side of the V-nullcline.

Delayed spiking and acceleration A negative a acts as a positive feedback which can be responsible for delayed initiation. Delayed spiking appears when injecting a current close to the rheobase. Because of a &lt; 0, the (hyperpolarizing) adaptation current w is slowly decreasing at a depolarized V, allowing the neuron to eventually spike once the adaptation has decreased sufficiently (Fig. ). In the phase plane, the trajectory of the first spike stays below, but follows the contour of the V-nullcline. As it approaches the V-nullcline, the trajectory slows down since the magnitude of |dV / dt| decreases. With a &lt; 0, the system of equations of the AdEx can lead to spike frequency acceleration (Fig. , similar to experiments by ) if the spike-triggered adaptation b is weak, as shown in Fig. . For greater values of spike-triggered adaptation, it is also possible to get a delayed adapting trace (not shown) and a delayed bursting trace (Fig. ). Note that in both Fig.  and , the trajectory starts with negative slope (dw /dt &lt; 0 while dV / dt &gt; 0) reflecting the decreasing adaptation current.

Rebound or transient spikes Post-inhibitory rebound is seen in several types of neurons. When a hyperpolarizing step current is released abruptly, some neurons will spike one or several time(s) before reaching their state of rest. This phenomenon is very similar to transient spiking observed during a step of depolarizing current. In both cases a stable fixed point remains, even after the sudden increase in current. A spike is nevertheless produced because the adaptation current is too slow to compensate for the sharp change in current. If the applied current was increased gradually to the same step size, the neuron would not spike because it would have had time to adapt. In the phase plane, rebound corresponds to a situation where the initial condition is located outside the basin of attraction of the stable fixed point, but the reset point is located inside this basin of attraction (Fig. ).

Irregular spiking Irregular spiking can occur in an AdEx model despite the fact that the equations are deterministic. Irregular spiking is manifest when the interspike interval keeps on changing without periodicity during the observation interval. There is an alternation of sharp and broad resets, but—unlike the case of initial bursting or regular bursting firing patterns—in the case of irregular spiking the sequence is not periodic, reminiscent of stuttering cells observed in some nest basket cells (). The irregular firing pattern appears for a restricted set of parameters, and the volume occupied by the irregular spiking pattern in the parameter space seems to be patchy. We verified that the behavior was not due to a numerical artifact: Simulating the model neuron with the same parameter set with different numerical integration methods (reducing the forward-Euler time step, using Runge-Kutta or Adams-Bashforth-Moulton) always produced an irregular spiking pattern. Even though the exact spike train was not identical, spiking was aperiodic so that the classification of the spike pattern (adaptive, bursting, irregular) did not change after a change in the numerical method. Though other regions of the parameter space may produce irregular spiking, the pattern was found to be most noticeable at negative a, large spike-triggered adaptation (b) and high voltage reset (Fig. ).

For a given set of parameters, irregular spiking emerges for a restricted range of injection current (Fig. ). We checked that for this set of parameters the AdEx model showed chaotic behavior () by testing the dependence of the numerical integration on the initial conditions. We perturbed the initial conditions by a very small value δ = 10−12 and evaluated the error, ζi, in the adaptation variable at each spike:  where w(^ti) and wδ(^ti) is the adaptation current at the time of the spike i for the unperturbed and perturbed initial condition, respectively. Fig.  shows that this error grows exponentially with the number of spikes. The slope in the semi-log plot is 2.56. Therefore, there is a great sensitivity of the solution on the initial conditions, this confirms that irregular spiking is due to chaos. A recurrence relation (map) can be found by plotting the magnitude of the interspike interval with respect to the preceding interspike interval. After a very large number of spikes (n = 1240), the interval map appears as a continuous function (Fig. ). The points in Fig.  all lie on a line of very small thickness, illustrating that the system is deterministic and neither artifacts nor noise is responsible for the observed irregularity in the interspike interval pattern.

4 Parameter space
Given the definitions for each firing pattern, we can now investigate how these firing patterns depend on the specific set of parameters. Since this problem depends only on the bifurcation parameters, we fixed the scaling parameters to realistic values: C = 100 pF, gL = 10 nS, EL = −70 mV, VT = −50 mV and ΔT = 2 mV. This corresponds to a membrane time constant τ = C/gL of 10 ms. Resting potential (EL), effective threshold (VT) and slope factor (ΔT) are in the range seen in experiments (; ). Changing the scaling parameters does not change the set of firing patterns accessible for a given set of bifurcation parameters, but may modify the amount of current necessary to go from one firing type to another. In addition, some firing patterns exist only close to the rheobase current (delayed spiking, transient spiking). In this section we will consider only the firing patterns that appear at a step current twice the amplitude of the rheobase current. The rheobase was determined according to analytical expressions given in Eqs.  and . The firing pattern is likely to change for different step current amplitudes, but we limit our study to just one amplitude of current step.

For each set of the bifurcation parameters, Eqs. – were solved with the Adams-Bashforth-Moulton numerical integration method (ode113 in Matlab), we stopped the simulation after 50 spikes or 16 s in model time whatever occurred earlier. We characterized the firing pattern according to the following simple rules:
tonic: strictly sharp resets or strictly broad resets and −0.01 &lt; A &lt; 0.01;

adapting: strictly sharp resets or strictly broad resets and A &gt; 0.01;

accelerating: strictly sharp resets or strictly broad resets and A &lt; −0.01;

initial bursting: ordered sequence going from sharp to broad resets (e.g. sharp-sharp-broad-broad-broad);

regular bursting: alternation between broad and sharp SAP such that the number of sharp resets between each broad reset is constant;

irregular spiking: alternation between broad and sharp SAP such that the number of sharp resets between each broad reset is not constant after the third broad reset;



All programs were written in Matlab (The Mathworks, Natick, MA) and ran on a personal computer.

In Fig. , the distribution of firing patterns is shown as a function of the reset parameters Vr and b with fixed values of a and τw. The fixed τw was 5 or 100 ms such that the w-variable can be interpreted as a refractory current or an adaptation current, respectively. The a parameter was fixed to −5, 0.001 or 30 nS, corresponding to a system loosing stability via a saddle-node (Fig. –) or Andronov-Hopf (Fig. , ) bifurcation. The range of reset parameters considered was limited to realistic values for spiking neurons (Vr ∈ [−70, −40] mV, and b ∈ [0, 400] pA).
Parameter space exploration of the four bifurcation parameters. Tonic spiking in red, adapting in yellow, initial bursting in green, regular bursting in cyan, irregular spiking in black and accelerating in blue. The four-dimensional parameter space was reduced to six relevant planes: a adaptive time constant (τw = 100 ms) and negative a (a = −5 nS), b refractory time constant (τw = 5 ms) and negative a (a = −5 nS), c adaptive time constant (τw = 100 ms) and low a (a = 0.001 nS), d refractory time constant (τw = 5 ms) and low a (a = 0.001 nS), e adaptive time constant (τw = 100 ms) and high a (a = 30 nS), f refractory time constant (τw = 5 ms) and high a (a = 30 nS). The firing pattern was classified for injection of current twice the rheobase, according to the criteria exposed in Sect. 



The adaptive models (τw= 100 ms, Fig. , , ) have bursting firing patterns extending to larger areas in the parameter space than the refractory models (τw = 5 ms, Fig. , , ), which have their diversity almost uniquely constrained to resets above VT. In all cases, the border between bursting (initial or regular) and tonic-adapting firing patterns can be approximated by a curve with linear plus exponential terms, similar to a shifted version of the V-nullcline. This can be related to the qualitative arguments in Sect.  (see subsection on initial bursting above and Fig.  as well as the Sect.  below). In Fig.  and , the tonic spiking (red areas) at low b and at high b corresponds to tonic with sharp resets and tonic with broad resets, respectively.

An adaptive current with high subthreshold adaptation yields predominantly bursting (initial and regular) and adapting firing patterns. However, a strong subthreshold adaptation is not sufficient on its own to model adapting and bursting patterns (Fig. ), but needs to be combined with high values of Vr. The refractory time constant in that case is often smaller than the interspike interval, this prevents cumulative increase of w since the adaptation current decays almost completely between spikes. Parameters combinations leading to irregular spiking (black pixels in Fig. ) make a sparse and patchy structure that is entirely contained in the larger region of regular bursting. This firing pattern appears predominantly close to the border between initial and regular bursting.

Delayed spiking and transient spiking are absent from Fig.  because these firing patterns do not exist when the current is well above the rheobase. Delayed spiking will appear at injection current slightly above the rheobase and are more salient at low or negative a. Transient spiking is produced with current not sufficient to make the stable fixed point loose stability, and this firing pattern depends heavily on a as it occurs only for sizable a. The accelerating firing pattern is also associated with current close to rheobase. Nevertheless Fig.  shows that the accelerating firing pattern persists at higher step current amplitudes given that b is very small and Vr is within a small range below VT.

5 Boundaries in parameter space
In Fig. , the boundary between initial bursting and tonic spiking appears as a line that can be described as linear plus exponential terms. Hence the shape of the boundary reflects the shape of the V-nullcline. In this section we analyze why this is so.

To study the relation between the the boundary and the shape of the V-nullclinewe consider a slightly simpler neuron model with a piecewise linear V-nullcline: . where the nonlinearity in the first equation is a piecewise linear function 

We assume that the evolution of the w-variable is much slower than the evolution of the voltage V. The voltage equation is characterized by a time scale τ = C/gL, thewvariable by a time scale τw. We observe that, in the limit of separation of timescales (τ/τw ≪ 1), the trajectories in the (V, w) phase space are nearly horizontal since dV/dt ≫ dw/dt — unless one of the trajectories gets close to the V-nullcline. Note that, by definition dV/dt vanishes on the V-nullcline, and because of continuity, dV/dt is small in the neighborhood of the nullcline. It can be shown that, in the limit of a separation of time scales, the trajectory follows the left branch V-nullcline staying at a vertical distance X(V) . below it (). In the case of piecewise linear nullclines, the trajectory can hence be obtained analytically.

More importantly for the present study, we can use the above result to get an approximation for the evolution of the adaptation variable w during spiking. After a spike, a trajectory restarts at the reset point (Vr, wr) with a w-value wr calculated from the reset condition in Eq. . Along the trajectory, both V and w change. A trajectory ends if V hits the upper bound V = 0 at which point the dynamics is reset and the next trajectory starts. We focus on a function M that maps the starting point (Vr, wr) of the trajectory to the value we of the adaptation variable at the end of the trajectory. We note that this function depends on Vr and write we = M(wr, Vr).

Let us now calculate we. With F(V) defined in Eq.  it is useful to split the problem in two cases depending on whether the voltage reset Vr leads to a value above or below VT. If Vr &lt; VT, separation of timescales means that V will increase too fast for w to change significantly unless the trajectory encounters the V-nullcline. This is illustrated in Fig.  where we see two trajectories: one with low wr and another with high wr. The former travels straight to high voltages with little change in w, the latter approaches rapidly the neighborhood of the V-nullcline which it follows at a distance X(V) before going to high V. Therefore, with Vr ≤ VT:  If Vr &gt; VT, then the trajectory evolves (nearly) horizontally to the right (increasing potential) unless the initial point is situated above the V-nullcline in which case the movement starts towards the left. This is illustrated in Fig.  where we see that trajectories starting above the V-nullcline again follow F(V) + I with a distance X(V). This gives, for Vr &gt; VT: Phase diagram and parameter space for a piecewise linear V-nullcline in the limit of separation of timescales. a The firing pattern predicted from the analytical expression given in the text for the limit of separation of timescales is shown with the same color scheme as in Fig. . b. Trajectories for reset points where Vr ⩽ VT go to high potential with little change in w unless they must contour the V-nullcline. c When Vr &gt; VT the trajectories go along the V-nullcline only when the reset point is situated above the dV/dt = 0. In both cases, the function M plateaus at a value wc = F(VT) − X(V). The trajectories follow the V nullcline at a distance X(V), as illustrated in the inset of b (C = 100 pF, gL = 10 nS, EL = −70 mV, VT = −50 mV, a = 0 nS, Δ = 3, τw = 2000 ms)



Given M, it is now straightforward to classify tonic, initial bursting or regular bursting according to the definitions mentioned above. We simply have to note that (1) we at the moment of the first spike is still close to its resting value we ≈ 0 and (2) in the case of periodic spiking the reset wr is given by wr = we + b. Hence, If Vr ⩽ VTtonic spiking with broad resets if b &gt; F(Vr) + I,

tonic spiking with sharp resets if b &lt; F(Vr) − F(VT) + X(VT),

initial bursting if F(Vr) + I &gt; b &gt; F(Vr) − F(VT) + X(VT).



If Vr &gt; VTtonic spiking with broad resets if b &gt; F(Vr}) + I,

regular bursting if b &lt; F(Vr) − F(VT) + X(VT),

initial bursting if F(Vr) + I &gt; b &gt; F(Vr) − F(VT) + X(VT).



These relations can be used to draw a picture of the parameter space for the case of a piecewise linear V-nullcline F(V) (Fig. ) which holds in the limit of separation of timescales. Note that in the AdEx model of Fig. , we have τ/τw = 0.1 so that the assumption of a separation of timescales is justifiable. Indeed, in the AdEx model the boundaries between the firing patterns in Fig.  reflects the shape of the nullclines as should be expected based on the results of this section.

6 Comparison with cortical neurons
We can test that the AdEx model accurately reproduces the firing patterns of real neurons by comparing with experimental injections of step currents into neurons of the cortex (data, courtesy of Henry Markram and Maria Toledo-Rodriguez, see  and  for the complete details on the experiments). Briefly, the experiments consist of 2–5 repetitions of 2 s step current injections with three different amplitudes. The amplitude of the steps ranged from 100 to 200 pA. The electrophysiological class was defined according to  for the inhibitory neurons and according to  for the excitatory neurons. We will be considering only three different classes. In particular, we will compare the AdEx with two types of inhibitory neurons (continuous accommodating, cAD, and continuous non-adapting, cNA) and one type of excitatory neuron (regular spiking, RS).

In order to compare the experiments with the AdEx model, we fit the parameters of the model neuron per neuron. The fitting method was chosen for the ease of implementation and for the capability to handle an optimization problem with many local minima (see further below). Optimized model traces are compared with the experimental traces in Fig. . We can see that the AdEx model offers a good qualitative match akin to optimized Hodgkin and Huxley models (). The optimized parameters for each chosen cell are given in Table . From this table, we see that the inhibitory cells correspond to smaller membrane capacitance, consistent with the smaller size of these cells. The parameter a is low for all three cells and does not strongly influence the features used as optimization criteria. The timescale of the adaptation is the largest for the RS cells, which is expected because of the slow adaptation currents known to be present in these cells. Figure – show the steady-state f-I curve for the fitted models corresponding to the three different cells. We see that the two interneuron models show type II f-I curves of a high slope, while the RS neuron have an f-I curve of I slow slope. Although the full f-I curve was not available with the experiments we used, we can see a qualitative link with the stereotypical f-I curves that are to be expected for these types of cells ().

Optimization methods have proposed an experimental protocol to determine the parameters of the model. The experiments used here were done before the work of Brette and Gerstner was published, and no fitting method based on step current stimulation only has been reported for the AdEx model. Here we will describe the optimization methods used to find the best set of parameters (β). Inspired from  and , we used a MATLAB implementation of a genetic algorithm (The Mathworks, Natick, MA) to solve the optimization problem. The cost associated with a parameter set,C(β), was defined with six features of the observed responses. The six features are:
f1: Number of spikes, n,

f2: First spike latency,

f3: First inter-spike interval,

f4: Last inter-spike interval,

f5: First inter-spike minimum potential,

f6: Waveform before the first spike.



The spike times were defined as zero-crossings of the voltage and the inter-spike minimum potential was taken to be the lowest voltage observed between the first and the second spike. For each feature we define a χ2 which averages the χ2 value across all three step current amplitudes. Illustrating this with the first feature we have:  where nj is the number of spikes for stimulus amplitude j observed in experimental traces (obs) or in a model with parameters β. The angular brackets denote the average and Var is the variance of the observed features across the repetitions. A similar equation can be written for each feature, except for feature 6:  where the integral runs from the onset of the step to two standard deviation before the first spikemean latency. Finally, the cost associated with a parameter set is: .

This is minimized with a genetic algorithm with a population of 100 individuals for 200 generations and a crossover fraction of 0.6.

7 Discussion
The AdEx model can produce multiple firing patterns depending on parameters. The model neuron can exhibit initial bursting, regularly bursting, tonic spiking, adapting, accelerating, irregular spiking, or show delayed initiation. We have drawn clear definitions of these firing patterns in terms of two types of spiking trajectories. The two types of spiking trajectories depends on whether the adaptation current immediately after spiking is strong enough to make the membrane potential decrease slowly before starting to increase in preparation for the next spike. The explicit distinction between continuous adaptation, initial bursting, and the description of irregular spiking extends previous work on firing patterns in model neurons (, ; ). Whereas  focuses on types of excitability, stationary limit cycles and their relation to the underlying bifurcations, we studied the transient response to step currents since this is the prevalent experimental paradigm for classifying firing patterns.

Chaotic responses have been observed in neuron models as well as real neurons under periodic forcing (; ). The type of chaos that we report does not depend on a periodic forcing. Rather it is closely related to the chaos observed in Hodgkin-Huxley equations (). The presence of chaos in the AdEx model is restricted to small regions of the parameter space (Fig. ). It is nevertheless possible that neurons access a similar chaotic regime. Evidences for the existence of chaos at all levels of the nervous system accumulate, despite technical limitations (). Figure  provides a method with which experiments could be made to verify the existence of the irregular firing pattern described. The irregular firing pattern appears in a narrow range of step current amplitudes (Fig. ) surrounded by a bursting at smaller and stronger current amplitude. Irregularity can be distinguished from noise by looking at the interval map, which is a thin continuous line (Fig. ) for the irregular spiking AdEx model.

The AdEx model can be fit with good agreement to three types of cortical neurons, as can be seen from the comparison between model and experimental traces on the time scale of seconds (two first columns in Fig. ). A closer look on the overlay unveils some discrepancies: the spike initiation of the cAD and FS interneurons is not fully captured by the model. The first interspike interval is too long in the case for the RS cell, while the last interspike interval is too short in the cNA cell. This makes the trade-off between different features evident, and our simple model cannot fit with high precision both the initial burst of RS cells and the broad SAP observed in these cells. Important improvement is to be expected by adding another adaptation current but here we restricted the investigation to the capability of only one adaptation variable.

Our study has shown that the value of the voltage reset is an important parameter of the model. The voltage reset allows to include some, but not all refractory properties in a neuron model (). Refractoriness arises from the combined contributions of increased firing threshold, reduced membrane time constant and hyperpolarized voltage. If the point-neuron model is replaced by a multi-compartment model, the effective voltage reset depends also on the amount of current flowing from the dendritic compartments into the soma. This can lead to an After Spike Depolarization (ADP). The most convenient choice for a voltage reset would be the maximum of the ADP.  have shown previously that variable electrical coupling with an active dendritic compartment tunes the ADP and can be made responsible for multiple firing patterns. The AdEx provides a simpler framework to switch between firing patterns by changing reset parameters—and these changes could indeed reflect, amongst other influences, changes in electrical coupling.

We can conclude that the diversity of firing patterns is explained in the AdEX model by simple dynamical processes that can be completely analyzed in the phase plane. The AdEx model represents an attractive candidate neuron model for use in large-scale network simulations. Earlier studies have shown that it is sufficiently accurate for the prediction of spike timing when a RS pyramidal neuron receives noisy current injection at the soma (). Network simulations of large systems such as a column of the barrel cortex (), or thalamocortical systems (; ) require the description of different neuron types. In this paper we addressed this issue by providing parameter sets that describe three types of cortical neurons, within the framework of a single and attractively simple neuron model. Further work will be needed to extend this to a larger number of neuron types and stimulation paradigms.



Many thanks to Henry Markram, Felix Schürmann and Maria Toledo-Rodriguez for providing the experimental traces and for helpful discussions. R. Naud is supported by the Fonds Québécois de la Recherche sur la Nature et les Technologie (FQRNT). This project is partly supported by funding of the European Union under the grant no. 15879 (FACETS)

Open Access This article is distributed under the terms of the Creative Commons Attribution Noncommercial License which permits any noncommercial use, distribution, and reproduction in any medium, provided the original author(s) and source are credited.

Also referred to as aEIF.

