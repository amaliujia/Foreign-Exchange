1 Introduction
The appropriate level of detail in a biophysical neuron model is set by its functional requirements. From the perspective of detailed ion-channel models, the Hodgkin-Huxley formalism (), comprising reduced models of the kinetics of voltage-gated channels with averaged activation and inactivation variables, represents a gross simplification. However, in the context of causally linking cellular electrophysiology to the broad features of ion-channel makeup, the formalism is highly satisfactory. At the next scale up in the modeling of neural tissue, a central goal is to predict emergent computational properties in populations and recurrent networks of neurons (; ; ; ; ) from the properties of their component cells. The neurons that comprise such network models may be modeled in biophysical and geometric detail (; ) for large-scale simulation (), but also of great practical use are experimentally-verifiable reduced descriptions that allow for a transparent understanding of the causal relation between cellular properties and network states.

Detailed biophysical models are characterized by high dimensionality and so the generation of simplified models generally involves dimensional reduction at some level. In the context of neurons the dimensionality arises both from their extended geometry and the coupled non-linear differential equations that describe the voltage-gated channels. Reduction schemes typically consider the neuron to be isopotential (a point neuron) and simplify the voltage-history dependent channel dynamics by a one-dimensional relation between current and voltage or a two-dimensional relation capturing effects from an additional subthreshold or adaptation current (; ; ; ).

Integrate-and-fire (IF) neurons [see Burkitt (, ) for a recent review] underlie many forms of reduced model and comprise a voltage-derivative coming from the capacitive C charging of the membrane and some choice of voltage-dependent function F(V) which aims to capture the voltage-dependent ionic current . Here Iapp is any current injected by an intracellular electrode. The action potential in IF models is modeled by a threshold Vth (at low or high voltage depending on the particular IF model) and a reset Vre followed by a refractory period, after which the subthreshold dynamics of Eq. () continue.

The most commonly used member of the IF family is the linear Leaky IF model (LIF) that features an ohmic form , where Em is the rest and τm the membrane time constant, with a low threshold Vth ∼ −50mV considered to be at the onset of the spike. This model is largely tractable and has been extensively studied in the context of both populations and networks (; ) of neurons. However, the lack of an explicit spike mechanism in the LIF is a weakness and can lead to responses that are not common to the general class of Type I neurons, particularly in relation to the response to fluctuating input (). The canonical type I neuron can be cast in the IF form—the Quadratic IF (QIF) model—with a function F(V) that is parabolic (). More recently a second non-linear model, the Exponential IF model, was introduced () that captures the action potential in amore biophysically-motivated way by fitting the region of the spike-onset to the conductance-based Wang-Buzsáki model (). Though the response properties of such non-linear IF models do not in general have solutions in terms of tabulated functions, they can nevertheless be extracted numerically but exactly via a simple algorithm (). Therefore, the family of non-linear IF neurons provides a tractable class of reduced model which, if matched to experiment, provide an excellent starting point for the causal analysis of emergent states in recurrent network models.

In this paper, we will review the dynamic I–V method () which provides an efficient technique for extracting non-linear IF models and post-spike refractory response-functions from intracellular voltage recordings. The method will be illustrated using the conductance-based Wang-Buzsáki hippocampal interneuron model. It will then be applied to intracellular voltage recordings from cortical neurons to build reduced models of layer-5 pyramidal cells and interneurons. It will be further demonstrated that the method can be used in dynamic-clamp conductance-injection mode in which the shunting effects of synaptic inhibition on voltage fluctuations are included. The paper closes with a discussion of the applications and extensions of the method.

2 From dynamic I–V curves to reduced models
The potential across the neuronal membrane obeys a current balance equation  where V is the membrane voltage at the point of the applied current Iapp (in this paper, the soma), C is the membrane capacitance and Iion contains the intrinsic voltage-gated currents that are instantaneous-voltage and voltage-history dependent. In general neurons are not sufficiently compact for the voltage to be constant throughout the cell. Therefore, the voltage and currents must be interpreted as being some measure of the properties within, roughly speaking, an electrotonic length of the electrode. Hence, in an experimental context the ionic current Iion will also include lateral currents flowing from the soma to the axon or dendrites. The applied current that is injected into the cells is a fluctuating waveform (combination of Ornstein-Uhlenbeck processes) chosen to create voltage traces that are in-vivo-like in that they fluctuate and explore the entire range of subthreshold voltages.

To provide a clear demonstration of the dynamic I–V methodology it is first applied to a conductance-based neuron model—the Wang-Buzsáki model ()—for which the underlying properties are known. In this model the ionic transmembrane currents take the form , where gL, gNa, gK are the maximum leak, sodium and potassium conductances, EL, ENa, EK the corresponding reversal potentials, and m, h, n are gating variables. The time course of the ionic current Iion, due to some pattern of applied current Iapp, can be extracted from a voltage trace by re-arranging Eq. () to give . If the capacitance C is known (to be derived in a following section) and the voltage derivative calculated directly from finite-differences, all quantities on the right-hand side of the equation are known and so the required Iion is obtained as a function of time. This process is shown in Fig. .
Summary of the dynamic I–V curve method and its application to the Wang-Buszáki model. a The derivative of the membrane voltage (top graph), multiplied by the cellular capacitance, is subtracted from the injected current (middle graph) to yield the intrinsic membrane current Iion (bottom graph). b The intrinsic membrane current Iion is plotted against the membrane voltage (black symbols). The dynamic I–V curve (red symbols) is obtained by averaging Iion in small voltage bins. Error bars represent the standard deviation. c Measuring the cellular capacitance. At a fixed subthreshold voltage, the dynamic membrane current  has a variance that depends on the value of C used in the calculation; the correct value of C corresponds to the point of minimal variance. d Relating dynamic I–V curves and non-linear integrate-and-fire models. The function  (symbols) is plotted as a function of voltage, together with the EIF model fit (red line). Inset: semi-log plot of F(V) with leak current subtracted, showing a nearly exponential run-up. e Spike-triggered dynamic I–V curves. The functions F(V) measured in small time slices after each spike (symbols) are plotted together with the the EIF fit (green) and the pre-spike I–V curve as a reference (red). At early times it is clearly seen that both the conductance and the spike threshold are significantly increased. f Dynamics of the EIF model parameters during the refractory period. The parameters obtained from the fits of the I–V curves in e are plotted as a function of the time since the last spike (symbols) and fitted with exponential functions (green). g Comparison of the prediction of the refractory EIF (rEIF) model (green) with a voltage trace of the Wang-Buzsáki model (black) shows excellent agreement, with 96% of the spikes correctly predicted by the EIF model within a 5ms window



Definition of the dynamic I–V curve The measured voltage and ionic current derived from Eq. () represent a current-voltage relation parameterized by time. The aim is to find a one-dimensional relation between current and voltage and so a scatter plot is made of Iion as a function of voltage, with all points that lie within 200ms after an action potential excluded (the post-spike refractory behavior is returned to later). The average of Iion for a particular voltage  defines the dynamic I–V curve Idyn. This quantity is plotted in Fig.  where it can be seen that the dynamic I–V curve comprises an ohmic region at subthreshold voltages followed by a sharp down turn at the onset of the spike. Before describing the relation to non-linear IF models, the measurement of the capacitance is discussed.

Determining the membrane capacitance Capacitance can be measured in a variety of ways, with the standard approach in current-clamp mode being the fitting of the early voltage response to rectangular current pulses. However, applied fluctuating-current protocols offer a convenient alternative method that is now described: If Eq. () is applied with an estimate Ce of the capacitance instead of its true value C, an incorrect estimate of the ionic current Iion is found that, at a fixed voltage V, has a variance of the form  where Var[X]V denotes the variance of some quantity X measured at a voltage V, and where it is assumed that there is no covariance between applied and ionic currents (justifiable in the ohmic region of the I–V curve and consistent with the standard method for measuring capacitance). The true membrane capacitance will therefore correspond to the estimate Ce which minimizes the right-hand side of Eq. () evaluated in some voltage range where the I–V curve is linear (in practice ±1mV from the resting potential). The quantity C can also be found directly by solving Eq. () for C to yield  where again, these two quantities are measured near a voltage where the I–V curve is ohmic. Equations () and () applied to the Wang-Buzsáki model in Fig.  yield a value of C = 1.018 µF/cm2, which is very close to the true value of C = 1µF/cm2.

Fitting to a non-linear IF model The dynamic I–V curve provides a direct mapping between the membrane voltage and the mean instantaneous value of the membrane current, which can be related to the template for non-linear IF neurons with the interpretation that . This is shown in Fig.  in which the measured F(V) (minus the dynamic IV curve divided by capacitance) is clearly seen to comprise a linear ohmic component in the subthreshold voltage range −90 to −60mV followed by a sharp exponential rise from −60mV(this is clearly seen in the inset). This form suggests that the exponential integrate-and-fire neuron  could potentially provide an accurate fit. Such a fit, with parameters EL = −68.5mV, τm = 3.3ms, VT = −61.5mV and ΔT = 4.0mV, is plotted in Fig.  in red and shown to be highly satisfactory.

Post-spike response and refractoriness It can be anticipated that the transient activation of ionic conductance during an action potential can alter significantly the cellular response during the refractory period. These changes in response properties can be investigated by examining the ‘spike-triggered’ dynamic I–V curves, i.e., the I–V curves measured in small time slices after a spike (Fig. ). Although the Wang-Buzsáki model displays relatively little refractoriness, it is possible to fit again the post-spike I–V curve to the EIF form in Eq. (), yielding a different set of the parameters τm, EL, VT and ΔT for each of the time slices. These new values define for each parameter a dynamics parametrized by the time since the last output spike (Fig. ).

Refractory EIF model A refractory extension of the basic EIF model (called the rEIF model), can be obtained by fitting the post-spike dynamics of the EIF model parameters plotted in Fig. . In the case of the Wang-Buzsáki model, all parameters could be fitted with a single exponential function, resulting in the following model .  where the function F is defined by Eq. (), tsp is the time of the last spike, and the superscript ‘0’ in ()–() denotes the pre-spike value of a parameter. In the present application, the ultimate voltage threshold (at the top of the spike) was taken to be Vth = +30mV, and the voltage reset taken to be the average voltage at the end of the refractory period, Vre = −71.2mV. The refractory period was taken slightly longer than the typical duration of a spike (we used τref = 8 ms for the case of the WB model). An example trace of this model is compared in Fig.  with the output of the Wang-Buzsáki model generated with the same input current, showing excellent agreement in both the subthreshold region and the timing of spikes, with 96% of correctly predicted spikes at 5ms precision (2 spikes out of 55 were missed).Note that we do not evaluate here the performance of the normal EIF model with threshold and reset, which was addressed in our previous publication () and gives results, for physiological firing rates (&lt;10 Hz) that are close to those of the refractory model.

2.1 Results for cortical pyramidal cells
Figure  summarizes our previous results for cortical pyramidal cells. In Fig.  the intrinsic currents are plotted against the membrane voltage. The scatter plot of the intrinsic current shown in Fig.  exhibits similar features as observed for the Wang-Buzsáki model, albeit with a significantly higher variability around the mean. Two processes can be identified that could contribute to this variability: (i) the projection of a time-dependent quantity on the instantaneous voltage whereas the ionic current Iion is a function dominated by the voltage history due to the activation of voltage gated currents, or (ii) the amplification of the background noise due to the voltage derivative in Eq. (). As the dynamic I–V curve can be expected to give an accurate approximation of the intrinsic membrane current only if the contribution from point (i) above is relatively insignificant, it is important to weigh the relative contribution of these two possible sources of variance. This can be investigated by examining the distribution of Iion measured when there is no injected current and the voltage is at its rest, and comparing the distribution when the voltage is fluctuating triggered to the same value of the voltage. This comparison is shown in the inset to Fig.  where it can be seen that the distribution of Iion when the voltage is at rest (black lines) accounts for a significant proportion (83% of the standard deviation) of the spread when the voltage has a dynamics; this suggests that the overwhelming proportion of the variability is due to point (ii) above-the amplification of noise from the voltage derivative-and that the underlying relation between Iion and voltage is relatively sharp.
Application of the dynamic I–V method to layer-5 pyramidal cells. a The intrinsic membrane current is plotted against the membrane voltage (black symbols). The dynamic I–V curve (red) is clearly seen to comprise a linear component in the subthreshold region followed by a sharp activation in the region of spike initiation. Inset: Examination of the variance of Iion near the resting potential in the absence (black) or presence (red) of injected current suggest that the majority of the variance comes from intrinsic noise. b The function  is plotted here (symbols) together with the EIF model fit (red). Inset: The exponential rise of the spike generating current is shown in a semi-log plot of F(V) with the leak currents subtracted. c Histograms of the EIF model parameters for a sample (N = 12) of pyramidal cells, showing considerable heterogeneity in the response properties of neurons in this population. d The cellular capacitance calculated with our optimization method (see text) is compared to the result of the standard current-pulse protocol, showing a good agreement between the two methods. e Spike-triggered dynamic I–V curves. The I–V curves measured in small time slices after a spike are plotted together with the EIF fit (green) and the pre-spike I–V curve as a reference (red). f Post-spike dynamics of the EIF model parameters (symbols) together with the fits to an exponential model. While conductance and spike threshold could be accurately fitted with a single exponential, the variation in the equilibrium potential EL required two exponential components for a good fit. The spike width ΔT did not vary significantly for these cells. g Comparison of the prediction of the rEIF model (green) with experimental data shows good agreement in the subthreshold region and in the prediction of spike times. h Summary of the performance of the rEIF model for the 12 cells investigated. Left: Prediction of the firing rate. Top right: Histogram of the performance measure. Bottom right: Voltage distribution for the rEIF model (green) and the experimental data (black). The figure is adapted from ()



The pre-spike I–V curves were very well fitted by the EIF model. However, as is clearly seen in Fig. ,, at the onset of the spike the rise in the I–V curve is much sharper than is observed in the Wang-Buzsáki model (with parameter ΔT of the order of 1–2mV, see Fig. ), and remains very close to exponential over almost 4 decades (Fig. , inset). The range of parameters obtained for the 12 measured pyramidal neurons, shown in Fig. , suggests a significant degree of heterogeneity in this population of cortical neurons.

As regards the measurement of the cellular capacitance, the values obtained using Eq. () were consistent across different voltage traces from the same cell, with a coefficient of variation of the order of a few percent. The validity of () was further tested by comparing with the values obtained by using the standard protocol of measuring the cellular capacitance from the voltage response to small current pulses. For the latter the capacitance was estimated by fitting the response with an exponential and averaging over 4 trials. As is shown in Fig. , there is a good agreement between the results of the two methods. Overall, the measured pyramidal cells exhibited relatively high capacitance values (250±75pF, n = 12 cells).

In contrast to the Wang-Buzsáki model, pyramidal cells showed a long refractory period (up to ∼100 ms) during which the cellular response changed considerably. This is seen very clearly in the post-spike I–V curves shown in Fig . Interestingly, the post-spike I–V curves could still be fitted to the EIF form in Eq. () allowing refractory properties to be described in terms of the simple rEIF model ()–(). The dynamics of the parameters are plotted in Fig.  for one example cell, and consistently comprised: an increase in the leak conductance gL, a biphasic response in the effective rest voltage and, importantly, a significant increase in the spike threshold VT. For pyramidal cells relatively little change was seen in the spike width ΔT.

In terms of predictive power, the rEIF model derived from fits to the steady-state and spike-triggered I–V curves was highly satisfactory, with an average 83% of succesfully predicted spikes within a 5ms window, relative to the instrinsic reliability of the cells.

3 GABAergic interneurons
One of the potential applications of the dynamic I–V curve is the rapid classification of cell type and response properties. To test whether different cell classes could be identified on the basis of their dynamic I–V curve and refractory properties, we applied our method to cortical GABAergic interneurons, and compared with the results obtained for pyramidal cells. The results for interneurons are summarized in Fig. . In general, the dynamic I–V curve for these interneurons was surprisingly similar to those observed in pyramidal cells, particularly for the response properties in the run up to the spike. For this cell type also the exponential integrate-and-firemodel ()matched the I–V curves accurately as can be seen in Fig.  and with similar distributions of the parameters (except for the lower membrane time constant τm) as seen in Fig. . For the refractory properties (Fig. ) the behavior of the rest EL was notably different from the pyramidal case and did not show the biphasic response seen in Fig.  but rather a simple exponential relaxation from a hyperpolarized reset. The other parameter that distinguished the two cell types was the cellular capacitance (250 ± 75pF for pyramidal cells, n = 12, and 94±21pF for interneurons, n = 6) which is consistent with the smaller interneurons. Although the variability in membrane time constant was less significant than previously found for pyramidal cells (with a CV of 12% as opposed to 32% for pyramidal cells), the other cellular parameters showed considerable scatter (with CVs of 22% for the distance to threshold VT − EL, and 27% for the spike width ΔT), suggesting a high degree of inhomogeneity also in this population. It can also be noted that the transient increase in the spike onset VT is smaller for this fast-spiking cell (∼4mV) than seen in the pyramidal cell ∼15mV. In terms of model performance, the predictions of the corresponding rEIF models were again excellent (in fact marginally better than for pyramidal cells) with an average 96% of correctly predicted spikes relative to the intrinsic reliability of the cells.
GABAergic cortical interneuronmodels derived using the dynamic I–V methodology. a The function  for a fast-spiking interneuron is plotted (symbols) together with the EIF model fit (red). Inset: The exponential rise of the spike generating current is shown in a semi-log plot of F(V) with the leak currents subtracted. b Distribution of the EIF model parameters for a sample (N = 6) of interneurons. The histograms overlap significantly with those of pyramidal cells shown in Fig . c Post-spike dynamics of the EIF model parameters (symbols) together with the fits to an exponential model. In the case of cortical interneurons all parameters could be fitted satisfactorily with a single exponential. Note that the transient, post-spike increase in the spike onset VT (∼4mV) is smaller in this fast-spiking interneuron than that for pyramidals (∼15mV-see Fig. ). d Comparison of the prediction of the rEIF model (green) with experimental data shows close agreement in the subthreshold region and in the prediction of spike times. e Summary of the performance of the rEIF model for the 6 cells investigated. Top: Prediction of the firing rate. Bottom: Histogram of the performance measure



4 Application to conductance injection protocols
The dynamic I–V method can also be employed to describe the voltage dynamics of pyramidal cells under dynamicclamp conductance injection. To demonstrate this, we injected layer-5 pyramidals with a mixture of excitatory and inhibitory fluctuating conductances modeled as Ornstein-Uhlenbeck processes with two distinct correlation times τe = 2ms and τi = 10 ms. For conductance injection the applied current is given by  where ge and gi are the excitatory and inhibitory conductance waveforms, and the synaptic reversal potentials are given by Ee = −10mV and Ei = −70mV. In this case, the dynamic I–V curve was qualitatively similar to the case of current injection. However, a second, slow exponential activation was needed to accurately fit the I–V curve. This is shown in Fig.  where the function F(V) was modeled as . The presence of an additional slow exponential component to the activation is likely due to the reduced amplitude of voltage fluctuations (from the diminished effective membrane time constant). This resulted in voltage trajectories that were concentrated close to the region of spike initiation, making a more detailed description of action potential onset dynamics necessary in order to correctly predict the timing of spikes. The analysis of the refractory properties yielded results consistent with the case of current injection, with changes in the membrane time constant, equilibrium potential and spike initiation threshold. For simplicity, the parameters ΔT, VT −V′T and Δ′T were taken as constant in the fitting of the post-spike I–V curves (Fig. ).
Application of the dynamic I–V method with conductance injection. a The function  is plotted (symbols) together with the fit (red) to the function (). Inset: Two exponential components are clearly seen in a semi-log plot of F(V) with the leak currents subtracted. b Post-spike dynamics of the EIF model parameters (symbols) together with the fits to an exponential model. The time-dependent resting potential shows a clear biphasic response as was seen for layer-5 pyramidals in the current-injection protocol. c Comparison of the prediction of the rEIF model (green)with experimental data again shows good agreement in the subthreshold region and in the prediction of spike times



The accuracy of the model at predicting spike timing for this particular example was slightly lower than in the current-clamp case. Overall, 63% of action potentials were correctly predicted within a 5ms window, whereas on average 83% were correctly predicted in the current-clamp case, compared to the intrinsic reliability of the cells (see Appendix). Although the data set, comprising only one pyramidal cell, does not allow for a systematic analysis of the performance, these results clearly demonstrate the applicability of the dynamic I–V curve method to conductance injection protocols.

5 Discussion
We used the dynamic I–V curve method to characterize the response properties of neocortical layer-5 pyramidal cells and GABAergic interneurons in current-clamp mode and additionally demonstrated that the method can be used in dynamic-clamp conductance-injection protocols. For interneurons, we found that the dynamic I–V method yields results of similar quality to those previously reported for pyramidal cells. In particular, we find that the refractory exponential integrate-and-fire model is able to predict both the subthreshold voltage and the timing of spikes highly accurately. The fast-spiking interneuron was characterized by a smaller cellular capacitance (∼100 pF) than pyramidals, a shorter membrane time constant (∼10 ms) and the lack of a biphasic response in the effective equilibrium potential during the refractory period. Other parameters showed significant overlap with the values obtained for pyramidal cells and a similar spread of parameter values in the studied sample of interneurons was also seen.

The comparison of the Wang-Buzsáki model with the experimental results highlights two interesting facts. First, the onset of action potentials in the model is much slower than observed in the experimental data, consistent with previous reports of ‘kink’-like spike initiation (; ). Second, the Wang-Buzsáki model showed very little refractoriness in contrast to the experimental data where the refractory properties were more pronounced and lasted significantly longer. It would be interesting to determine how much this discrepancy is accounted for by the presence of additional voltage-gated channels such as adaptation currents or by the extended spatial structure of neurons. As a related point, it would be interesting to investigate the influence of multiple action potentials on the dynamics of the EIF model parameters. In this paper, only the influence of the last action potential was considered. However, it is possible that multiple-spike effects will dominate the response at higher firing rates.

In the case of dynamic-clamp conductance injection we found that the I–V curve was best fitted by a non-linear integrate-and-fire model that comprised two exponential components: the sharp exponential activation associated with the spike-generating sodium current is preceded by a slow inward rectification that is also very close to exponential. The model derived from the I–V curve was also able to predict the timing of spikes with a satisfactory level of accuracy compared with the intrinsic reliability of the neuron, although for this cell the model performance was marginally lower than typically obtained in the current clamp case. The proximity of the trajectories to the threshold for the example treated here suggests that the lower performance might be attributable to the oversimplified description of action-potential onset dynamics that is inherent in the one-dimensional EIF model. This is backed up by preliminary analysis we have performed on a model that includes inactivation of the sodium current (details not shown). Further experiments would be needed to verify this hypothesis.

Also seen was that the substantial degree of inhomogeneity in the response properties, previously observed for pyramidal cells (), was also found here for cortical interneurons. Since the majority of network-level models assume identical properties for component cells, it would be interesting to investigate how the presence of inhomogeneities could affect collective behaviors, such as transitions to oscillatory states (; ), in networks of excitatory and inhibitory neurons.

Transient increase in spike onset A key aspect of the refractory response quantified by the dynamic I–V curve methodology was the transient increase in the spike-onset parameter VT following an action potential. Though this feature was seen in both pyramidal and fast spiking interneurons it is interesting to note that the relative magnitudes of the effect were quite different. Labelling the baseline spike-onset as VT0 and the additional transient increase as VT1 we have, looking at Figs.  and , for pyramidal cells a typical distance to threshold of VT0 − EL ∼10mV and a transient increase of VT1∼15mV, whereas for interneurons these quantites are VT0 ∼ EL ∼24mV and a transient increase of VT1 ∼4mV. If one compares the relative increase VT1/(VT 0 − EL ) for these two cells we get a value for pyramidals of 150%, but for the fast-spiking interneuron the relative increase is only 17%. This distinction could well underlie the ability of such fast-spiking cells to emit closely spaced action potentials. Furthermore, in the context of mathematical approaches to the transient spike-onset, it is worth noting the surprising fact that the two-dimensional system (voltage and dynamic threshold VT (t)) is fully solvable in certain conditions. The corresponding equations are  where  where it is assumed the spike occured at t = 0 so that initially V = Vre. If the time constants are identical τL = τT then a simple transformation  reduces the dynamics to an effective one-dimensional EIF model  with a constant threshold for spike-onset VT0 and a lower reset . A similar transformation was first identified for the Leaky IF model () where it was also demonstrated that even for cases where τL ≠ τT a perturbative approach can be used to calculate many of the response properties of Leaky IF neurons with decaying thresholds. It would be worthwhile to further explore the extension of this to the two-variable EIF model given by Eqs. (, ) particularly given its simplicity and direct experimental relevance.

MJER acknowledges funding from the Research Councils United Kingdom (RCUK) with whom he holds an Academic Fellowship. The work was partially supported by the European Integrated Project FACETS.

Open Access This article is distributed under the terms of the Creative Commons Attribution Noncommercial License which permits any noncommercial use, distribution,and reproduction in any medium, provided the original author(s) and source are credited.

Appendix: Experimental methods
Current-clamp recordings Experimental methods for the current-clamp protocol were identical for both pyramidal cells and interneurons. Details of the methods are available in a previous publication (). Briefly, double somatic whole cell recordings were obtained from layer-5 pyramidal cells and interneurons, with one pipette injecting the current while the other monitored the voltage. The injected current waveforms were constructed from two summed Onstein-Uhlenbeck processes with time constants τfast = 3ms, τslow = 10 ms, and a range of means and variances were explored. All currents were preceded and followed by a 3-second null stimulus used to assess the amount of background noise, and during which two small square current pulses (one positive and one negative) were applied to allow for the measurement of the cellular capacitance.

Dynamic-clamp recordings For this protocol, we used the publicly available data from Challenge A of the Quantitative Single-Neuron Modeling Competition [see Jolivet et al. (, ) for details on the competition and experimental methods]. The data was acquired from a pyramidal neuron of the rat somatosensory cortex via two-electrode somatic patch clamp. The injected current was of the form  where the voltage V(t) was measured in real-time via the second electrode. The conductance waveforms consisted of Ornstein-Uhlenbeck processes with correlation times τe = 2ms, τi = 10 ms; the reversal potentials for excitation and inhibition were Ee = −10mV, Ei = −70mV.

Performance measure To facilitate comparison with previously published work, we use the ‘coincidence factor’ Γ () as a measure of performance. This coefficient takes into account both the overlap between two spike trains and the similarity in the firing rate. It is defined by  where Ncoinc is the number of coincidences with precision Δ, 〈Ncoinc〉 = 2 fΔNneuron is the number of expected accidental coincidences generated by a Poisson process with the same firing rate f as the neuron, Nneuron and Nmodel are the number of spikes in the spike trains of the neuron and the model, and N is a normalization factor. In this paper, only ratios Γ/Γ′ are considered, where Γ evaluates the overlap between the prediction of the model and a target experimental spike train, and Γ′ is calculated between the target spike train and a second experimental recording obtained with the same driving current. Only pairs of trials with an experimental reliability Γ′ &gt; 0.75 were used in the analysis.

Wang-Buzsáki model The Wang-Buzsáki model () is defined by  with gating variables n,m and h obeying a first-order dynamics,  for x = n,m, h, and , and the rate constants are given by . For the conductances and reversal potentials, we used gNa = 120, ENa = 55, gK = 36, EK = −72, gL = 0.3 and EL = −68. The term Inoise is included here to account for intrinsic background noise, and is modeled as Gaussian white noise, Inoise = σξ(t),where 〈ξ(t)〉 = 0, 〈ξ(t)ξ(t′)〉 = δ(t−t′), and we took σ = 0.1 to obtain a level of noise that is comparable to the one observed experimentally.

