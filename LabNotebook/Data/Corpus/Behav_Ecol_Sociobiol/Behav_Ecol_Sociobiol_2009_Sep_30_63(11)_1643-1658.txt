Introduction
Cultural inheritance may shape animals diets. In a cross-fostering study of blue and great tits, cross-fostered chicks showed a shift in their feeding niche to that of their host species (Slagsvold and Wiebe ). Generally, however, learning and cultural inheritance, where behavior is inherited across generations through socially influenced learning, are difficult to study in natural settings (see Laland and Janik ; Janson and Byrne ). One obstacle is the impossibility to characterize the nutritious value of all possible ingestible items in natural settings (see Chapman and Fedigan ). Therefore, diet choice is generally studied relative to items that animals already eat. The role of learning and cultural inheritance in how animal diets are established is not well addressed.

In optimal foraging, learning is mainly considered relative to short-term tracking of changes in food availability, individually learned handling times, and variations in the value of food (e.g., Kamil and Roitblat ; Stephens ). In this context, social cues have been studied as a means to enhance foraging efficiency through sharing of information on short timescales (Giraldeau ; Clark and Mangel ; Krebs and Inman ). On the other hand, to gain insight into the evolution of cultural inheritance, models have been used to study the conditions that favor transmission of information across generations (Rogers ; Boyd and Richerson ; Feldman et al. ; Borenstein et al. ). Here, the focus is on the optimal trade-off between avoiding the costs of individual exploration and relying on potentially outdated information through social learning (Laland and Kendal ).

Intergeneration models study the outcome of cultural inheritance, assuming it occurs, but do not study how it arises. On the other hand, social foraging models consider the impact of social learning on short timescales but generally do not study potential cultural consequences. This means that the relationship between the processes of learning at short timescales and cultural inheritance are not well understood. In this study, we aim for greater insight into these issues. Diet learning is a general learning context for many animals, and social learning has been shown to affect diet choice and support simple diet traditions (see Galef ). Therefore, we focus on diet learning. However, we do not address diet optimality but focus on the learning process.

Diet development studies in various mammals indicate that diets depend on the process of learning and past experience (Galef ; Day et la. ; Birch ; Provenza et al. ; Visalberghi et al. ; Kimball and Nolte ). Learning is not instantaneous, and familiarity with resources is important for diet choice (Day et al. ; Ralphs and Provenza ; Birch ; Johnson ). Resource preference development occurs largely through delayed postdigestive feedbacks (Garcia et al. , ; Provenza ; Provenza et al. ), where taste cues become meaningful relative to acquired experience (Galef ; Kyriazakis et al. ; Birch ). Moreover, the digestion of resource mixtures complicates preference development (e.g., Duncan and Young ), probably because it is difficult to untangle the contribution of resources to digestive feedbacks.

In rich environments, the process of learning is also shaped by behavioral opportunities. For instance, social dominance structures and social tolerance have been suggested to be important determinants of opportunities for social learning (Coussi-Korbel and Fragaszy ; van Schaik et al. ; van Schaik ). An important aspect of behavioral opportunities is their role in structuring complex behavior through self-organizing processes (Hogeweg and Hesper ). Unraveling such processes can provide important mechanisms and baseline expectations with which to consider behavioral patterns (see also te Boekhorst and Hogeweg ; Camazine et al. ; Hemelrijk ; Couzin and Krause ). Baseline studies on diet development by trial-and-error show how resource distributions can shape foraging opportunities and structure learning, generating spontaneous social influences on learning in groups (van der Post and Hogeweg ). In uniform distributed resources, local depletion of resources by groups generates divergence in learning between individuals, causing individuals to “specialize” on resource subsets. In contrast, in patchy environments, individuals in groups tend to share learning opportunities automatically and converge in learning, generating group-level diets. With population turn-over, such group-level diets can be culturally inherited (van der Post and Hogeweg ).

It is the process of learning at short timescales among contemporaries that gives rise to cultural inheritance over long time scales of many generations (i.e., among individuals that could never meet). Moreover, because it arises as a side-effect, functional approaches are not necessary for understanding its origins. However, this raises the question of how an additional behavioral adaptation, such as explicit social learning in the form of copying, may be structured by these underlying self-organizing dynamics. Here, we address this interplay between adaptation and self-organization and study (1) the potential role of copying in the diet development process on short timescales, where foraging opportunities and self-organizing processes can play a role, and (2) the consequences this has on cultural timescales (i.e., across generations).

We use an individual-based model focused on primates, which is relevant for other group foragers, and study the process of resource preference learning as a means to characterize a rich environment, i.e., an environment with many resource species that can be arranged at multiple spatial scales. Learning is therefore prolonged and shaped by the interaction between information acquisition and behavior. Given this interaction, we focus on its dynamics, rather than a trade-off between information sampling and information use. We explicitly study the impact of foraging opportunities on the learning process by considering different resource distributions. In this setting, we study the impact of copying on diet energy uptake within lifetimes and over multiple generations.

Our results show that copying can help individuals share information. Whether this happens depends on how local foraging opportunities shape the difficulty of learning and the impact of copying on the short term. If copying is effective on the short term, it generally gives rise to cumulative cultural improvement in diet. In fact, it is the interplay between the two timescales that allows such cultural learning to be generated.

Methods
Model
We use an individual-based model with a spatial environment where group foragers learn what to eat and forage selectively (based on van der Post and Hogeweg , ). Overall, our model is quite simple, and we assume that individuals (1) learn through reinforced preference development, (2) use acquired information to forage selectively, and (3) live in groups (4) in a rich structured spatial environment (i.e., many different resource species arranged at different spatial scales).

Resources are distributed in a 2D grid and can be found by individuals moving in a continuous space, and can be depleted through foraging. The individual behavior procedure is given in Fig. . Individuals start their behavior routine by scanning for neighbors and checking if they need to move towards group members or can search for food. If food is found, an individual can decide to eat; if not, it simply moves forward. The routine ends at a “terminal” behavior on the right-hand side, and then starts again. The darkest boxes and thick arrows (Fig. ) indicate copying behavior and have been added relative to the previous model. Note that copying occurs in parallel to other behavior, i.e., individuals that check if they are safe also observe what neighbors eat and remember this for some time. If such a memory is active when that food type is next considered by an individual, then C increases the probability of eating that food type.
Individual behavior procedure with copying behavior shown in dark gray. pir resource preference,  preference expectation, N individual selectivity during food choice, D distance unit (length of one cell in 2D grid, scaled to 1 m), C copy preference. Note that copying occurs in parallel to other behaviors, i.e., while individuals check for safety, they may observe other individuals and remember food types they were eating. When encountering such a food type, C increases the probability of eating that food. Bottom: snapshot (600 by 100 m) showing trajectories of 20 individuals foraging from left to right in a day (varied patches)



This is a TODO-based model, where local opportunities impact foraging and learning. The TODO principle states that individuals “do what there is to do,” emphasizing the point that behavior of individuals is triggered by and is relevant to what they encounter locally (Hogeweg and Hesper ). Interactions between local opportunities and behavior can give rise to complex behavioral patterns. The aim here is to explore these patterns and gain insight into how foraging behavior can be shaped by interactions between environmental conditions and learning in groups.

Individual actions are scheduled according to the time they take, using an event-based protocol. We keep track of time on the order of minutes (1 time-step = 1 min, 1 day = 1,000 min, and 1 year = 100 days), but actions such as movement can be on the order of seconds (for parameters, see Appendix ). Below, we discuss the model in more detail.

Preference development
We use a simple algorithm that captures time-dependent preference development, with which we can study the dynamics of a learning process in a rich environment (as in van der Post and Hogeweg ). Preferences represent the value (i.e., a quality estimate) an individual develops for a resource according to energy feedbacks from digestion. This value is used for foraging decisions, relative to the assessed value of other resources, and therewith determines the probability of eating that resource (see “Foraging”). It is assumed that individuals have no preference for unknown resources and initially sample all resources. Preferences then develop incrementally over time with increased feeding. Individuals therefore gain a more accurate assessment of resource quality with the number of times the resource is consumed. Equation  defines how resource preferences (pir) are updated at each digestion event, which occurs at every 100 time steps for all items eaten within the last 100 time steps. Equation  therefore describes reinforcement learning as a simple saturation function (i.e., preferences increase over time until they equal resource quality):
where Sir is the number of items of resource r in individual i’s stomach, SiT is the total number of items in its stomach,  is the average energy per resource item it obtains from this digestion event (i.e., ∑ Sirqr/SiT), and  is the average preference (energy estimate) it has for the items digested at a given digestion event (i.e., ∑ Sirpir/SiT). U defines the rate of preference development. Note that, while this straightforward learning algorithm was chosen for simplicity (i.e., resource preferences increase with increased feeding, but do not increase to infinity), complexity in the learning process arises in interaction with a diverse and spatial environment.

Preferences represent an individual’s quality estimate for a given resource and  therefore represents an expected quality feedback from digestion. To add some environmental noise, we allow  to deviate randomly at each digestion event, based on a normal distribution with a mean of  and a standard deviation of 0.005 (on average less than 10% of ). For simplicity, we assume that if a resource preference becomes negative this leads to a lifelong aversion. This can be overruled when individuals copy (see description of copying below).

We set U to 0.01, which means that, if individuals eat a resource continuously for about 7 days, their preference will be equal to half the actual quality of the resource. This at least appears to be in the order of magnitude of what is found for preference development in primates (based on our estimate of Matsuzawa and Hasegawa ). Moreover, in the algorithm, feedbacks from digestion of resource mixtures are averaged over all resources consumed, making feedbacks ambiguous, as appears to be the case in some diet development studies (e.g., Duncan and Young ). This is simply the most straightforward assumption without invoking extra mechanisms for individuals to unravel the contributions of each resource type to digestive feedbacks.

Foraging
Stomach capacity is limited to 20 food items, and when their stomach is full, individuals wait for resources to be digested (every 100 time steps). Digestion also takes place if an individual’s stomach is not full. As stomachs can be filled considerably before digestion, individuals have time to forage selectively. Individuals search for food locally, a semicircle in the direction they are facing with a 2-m radius, where all resources are detected. For food choice, we assume that individuals are more likely to choose high-quality resources, based on their resource assessments. During each search event, individuals can assess up to 20 resource items in sequence; however, as soon as an individual decides to eat a resource item, it stops assessing other items. If after assessing 20 items an individual does not decide to eat, it moves forward (see Fig. ). When deciding to eat, individuals use their resource preference (pir) to determine the probability (ρ) of eating a given resource item:
where N scales the degree to which the probability (ρ) of eating less preferred resources decreases as pir drops below . N therefore affects foraging selectivity, i.e., to what extent less preferred resources are consumed (here, N = 3). ρ can be increased by C when another individual is observed eating that resource (see below). When ρ &gt; 1, this is treated as ρ = 1. (Note that ρ is specific for a given resource item at a given time for a given individual.)

 represents an individual’s expected “highest” preference and ensures individuals can forage selectively. Individuals vary , enabling them to adjust foraging selectivity to track quality changes in the environment (e.g., due to resource depletion) and changes in individual experience. We do not explicitly define how an individual’s foraging history is integrated over time to adjust foraging selectivity, but we simply set  to increase by 10% if an individual’s stomach is full (20 items) at digestion, while it decreases by 10% if its stomach is not full. This is just a simple heuristic through which selectivity () is increased when food intake is maximal (full stomach), and decreased when food intake drops. This allows individuals to keep foraging selectivity high, while maintaining high food intake, where  is a “learned” level of selectivity, which reflects the quality of food that can be found in the environment. Our model therefore includes two levels of learning: short-term adjustment of selectivity and longer-term characterization of the environment through preference development.

In combination, the preference development and food choice algorithm generate a positive feedback between learning and selective foraging. This feedback is not implemented, or assumed, but arises automatically because individuals use acquired information to make foraging decisions: preference development (Eq. ) affects preferences (pir) used in food choice (Eq. ), and food choice determines what is eaten (Sir in Eq. ) and therewith which preferences are updated. Therefore, not only resource quality, but also familiarity becomes a component of resource preference and food choice. This feature of the learning process is unavoidable in our model, unless learning is instantaneous.

Copying behavior
We focus on the impact of copying as an addition to resource preference development and do not implement copying and trial-and-error learning as alternatives. For copying, we assume that the observation of another individual feeding generates a short-term temporary copy preference (C) and increases the probability of an individual choosing that resource (see Eq. ). For simplicity, we assume this includes resources for which an individual has an aversion (i.e., a negative preference). Note that the observation and memory of another individual’s feeding occurs in parallel to other behavior in general (see Fig. ). Copying, therefore, only affects resource preference development indirectly by biasing food intake (i.e., Sir in Eq. ) through food choices that an individual would have faced anyway.

Individuals can observe another individual eating within a limited distance (5 m) and remember that resource for some time (30 min). The memory is also lost when the individual eats that resource. Copying therefore increases the probability of choosing a certain resource for a single feeding event. For simplicity, we assume that individuals can continue copying for their whole lifetime on all resources that they observe to be eaten, including those they are already familiar with. This overestimates the extent to which animals copy, but it is interesting to study as an extreme case.

Grouping and movement
We model group movement based on simple individual movement rules. While foraging, individuals simply search for food locally, and move forward if they do not find food. At the same time, they try to remain in groups. This results in groups that move through the environment, where trajectory changes are generated both by the impact of grouping and the interaction of individuals with resources in the environment. A single day of group foraging is shown in the snapshot at the bottom of Fig. .

To stay in groups, individuals use local information to remain in proximity to the largest part of the group. Individuals check how many neighbors are present in close proximity (10 m). If they have a sufficient number of neighbors (three), then they are “safe” and proceed with foraging. Otherwise, in their next action, they move in the direction (3 m) where they observe the highest density of individuals in a wider area (150 m) and adjust their direction to the average direction of the group. These parameters affect to what extent groups are cohesive and split up into subgroups. Here, we choose parameters that minimize subgroup formation, allowing us to study copying while keeping grouping constant.

Temporary satiation aversion: We also include temporary satiation aversion as observed in various animals (e.g. Provenza et al. ). This prevents unnaturally long visits to patches and low movements rates (see van der Post and Hogeweg ). However, this rule does not lead to qualitative differences in our results (not shown).

Environment
The environment is a 2-dimensional grid where grid points represent locations where resource items can be found. Snapshots of different resource distributions are shown at the bottom of Fig. . We implement 250 resource types (species), which differ in quality (energy value) according to a Gaussian distribution. The different resource types are then spatially distributed in different ways, determining how many items of each resource type can be found at each grid point. For patchy environments, each patch is either assigned a single resource type (pure patches), giving 250 patch types, or assigned a subset of five resources (varied patches), giving 50 patch types. Varied patches of a given patch type differ in that we only plot a subset of three of the five assigned resources generating different combinations of resources in patches of a given patch type. Each patch has a radius of 10 grid units and about 13 items per grid location. Each patch can be visited several times by groups before they are depleted. For the uniform distribution, all resources occur throughout the field (well-mixed), but locally, only a small subset is available.
Effect of copy preference (C) on yearly diet energy in different resource distributions: Pure patches (black), varied patches (blue), and uniform environment (red). Horizontal black lines indicate individual learning baseline (C = 0). Bars are averages of 20 simulations at year 20 (striped bars) and year 100 (solid bars), where error bars are standard deviation. Note that standard deviation in the data sets (indicated by error bars) is large because it includes large intragroup variation due to age differences between individuals. Significant differences between the two time points are indicated by asterisks. Bottom: snapshots (80 by 80 m) showing resource distributions (black squares are individuals, gray is background, colors are resources)



Resources are depleted during foraging and are renewed at the beginning of each year. This is simply done by repeating the initial spatial resource distribution pattern and removing any resource items from the previous year. Ecological dynamics are therefore limited to single influxes of all resources at the beginning of each year.

We use a grid size of 2,800 square units (one unit is scaled to 1 m) and implement 4,900 patches, each consisting of about 4,000 resource items, or for the uniform environment fill the field with all resources with three resource items at each grid point. For more detail on modeling the environment, see van der Post and Hogeweg ().

Parameters
Although our biological assumptions are straightforward, our model requires a sufficient level of detail in order to function. Here, we consider the parameter choices we make.

Parameters were chosen keeping “primates in mind” and are shown in Appendix . At the most basic level, parameters determine individual behavior on small spatiotemporal scales. These are action durations, movement distances, and local food searching. Such parameters are easily related to real foragers (e.g., for primates) (see also Hogeweg and Hesper ). Here, we use general knowledge about primates to set these parameters.

These behaviors structure phenomena that arise on longer timescales, such as grouping and selective foraging (the biologically relevant context in which we study learning). Given that we know monkeys form groups, and that grouping is a prerequisite for copying, we choose individual-level grouping rules that ensure grouping is reasonably represented. However, it is not the mechanism of grouping that is studied here, but the role of copying given grouping occurs. Therefore, we choose parameters that ensure cohesive grouping. The “maximum awareness” for detecting neighbors (see Appendix ) is, therefore, quite large (150 m), although not impossible.

The spatiotemporal scale we implement at the individual action level determines individual movement in time. We use these movement rates, and viability constraints such as “enough to eat” (see also Hogeweg ), to determine environmental parameters that provide sufficient space to allow groups to travel through the environment in the order of days (such as monkeys in their home ranges) and forage selectively throughout the year. Moreover, we make sure the environment is rich enough (learning is not too easy), and the timescale of learning is such that individuals learn to forage selectively on the order of years. Interestingly, by taking these considerations into account, we find that our environmental parameters are automatically in the right order of magnitude for primate home ranges and resource diversity.

Simulations
We study the impact of copying behavior on diet development over time. We run simulations with different copying preferences (C) and consider the impact of copying in terms of energy uptake from diets. We compare learning in environments with pure patches, varied patches, and uniform environments, and so study the impact of resource distributions on the role of copying. To do this, we conduct transmission chain experiments (cf Curio et al. ; Galef and Allen ; Laland and Williams ). In this way, we study the immediate consequences of copying (at the beginning of simulations) and those on longer timescales, both within and over generations.

Simulations are initialized with 20 naïve individuals, and each year, one of the initial individuals is replaced by a naïve individual. After 20 years, all the initial individuals have been replaced, and from then on, the eldest individual is always replaced. Individuals only “die” when they are replaced, but not due to other factors such as lack of food. Simulations are run for 100 years: a 20-year start-up period in which a stable age distribution is generated (i.e., ages 19 to 0 years), followed by four complete cycles of replacement. We consider that cultural inheritance occurs when behavior is transmitted over more than one complete replacement of the population, i.e., transmission of behavior between individuals that could never meet.

Results
We find that copying improves diets through collective exploration in the short term. This leads to cultural inheritance and cultural diet improvement in the long term. Whether this occurs depends on how preference development and copying are shaped by local foraging opportunities in different resource distributions.

In Fig. , we show how resource distributions affect learning and copying on multiple timescales. First, we find that diet energy uptake decreases as local resource variation increases. This is indicated by the trial-and-error baseline without copying (C = 0, horizontal black lines), where diet energy uptake can be seen to be greatest in pure patches (black bars) and lowest in uniform environments (red bars).

Second, we find that the impact of copying varies in different resource distributions. Relative to the trial-and-error baseline, copying has the greatest general impact in varied patches (blue bars), where the full range of copy preferences has a considerable impact on diet energy. However, in pure patches, the impact of copying on diet energy is generally limited. Its effect is maximal at C = 0.05, but drops off again at higher values, indicating that it becomes excessive. In uniform environments (red bars), the impact of copying is also limited, and only substantially increases diet energy uptake at maximal copy preference (C = 1.0). We should note that, by year 20, the effect of copying (C &gt; 0) relative to no copying (C = 0) is always statistically significant (significance threshold at p &lt; 0.0028, Bonferroni corrected for 18 tests), except for C &gt; 0.1 in pure patches, and C &lt; 0.5 in the uniform environment.

Third, we find that, if copying is effective on short timescales, it generally gives rise to cumulative cultural diet improvement. This is shown in terms of the difference in diet energy uptake after one generation (20 years, striped bars) and after five generations (100 years, solid bars). Statistically significant differences are indicated by stars [Wilcoxon matched-pairs signed-ranks test on average group diet energy uptake at year 20 and year 100, n = 20, with a significance threshold of p &lt; 0.0024 (Bonferroni corrected for the 21 time pairs tested)]. In pure patches, there is no clear pattern, although there is a significant increase for C = 0.05. In varied patches (blue bars), there is a clear general trend for increased diet energy uptake over the generations, although most of the increase relative to trial-and-error learning (C = 0) already occurs in the first 20 years. In the uniform environment (red bars), although generally there is no significant increase in diet over the generations, for C = 1.0, the increase of diet energy uptake over the generations is at least half of the total improvement of diet energy uptake through copying. Although generally copying does not have a large impact in the uniform environment, we observe that cultural-level information processing can be important. Moreover, it is interesting to note that, while the difference between copying and not copying was not significant at year 20 for C = 0.5 in pure patches, and C = 0.1 in uniform environments, this becomes significant at year 100 (Wilcoxon two sample test, on individuals from year 100 (n = 400), p &lt; 0.00006 in both cases1). Below, we discuss how local resource variation affects diet energy uptake and the impact of copying on multiple timescales.

Local foraging opportunities and the difficulty of learning
Local resource variation affects diet energy uptake by how it impacts the difficulty of learning through local foraging opportunities. This has an impact both on preference development and on copying behavior.

The difficulty of preference development is shaped by a combination of (1) the positive feedback between foraging and learning and (2) the mixing of resources during digestion. In the learning process, differences in the observed quality of resources are used to bias foraging to high-quality resources, allowing individuals to forage selectively. This generates a positive feedback, where foraging is biased to resources individuals have some experience with. This means that learning can remain biased to some set of initially observed resources. Learning is therefore somewhat self-limiting and can get stuck on “local attractors” or familiarity biases. Note that this feedback is not preassumed and implemented, but self-organizes.

When local resource variation is high, this means familiar resources are more often found locally. The feedback between learning and foraging can therefore be enhanced, increasing the self-limitation of learning. At the same time, increased mixing of resources means that feedbacks from digestion are more often ambiguous because the energy feedback is averaged over all resource items (see Eq. ). Such ambiguity makes it much more difficult to detect differences in resource quality. When averaging is prevented, learning is easier and diet energy uptake increases (see Appendix ). However, even in this case, familiarity biases still limit learning, indicating that our results are not fully dependent on this averaging affect.

At the same time, local resource variation affects the opportunities for copying. This is shown in Fig. a, where the time that individuals take to copy is plotted for maximal copy preference (C = 1.0). In order to copy, individuals must both observe an individual eating a resource and subsequently find that resource. The box plots show that, in both patchy environments (gray and blue) individuals can mostly copy immediately (median = 1 time step). Here, resources are locally abundant and both observing feeding and finding resources are easy. In contrast, in uniform environments (red), individuals take much longer to copy (median = 10 time steps). Here, resources are locally rare and harder to find, making copying events rarer. As a consequence, they are more diluted with respect to individual feeding choices, and the learning signal from copying is weak (note that we put parameters such that memory is long enough for copying to have an impact in every environment).
Copying opportunities and collective learning. a Box plots showing the time (minutes) it takes individuals to copy (C = 1.0) after observing feeding, for pure (gray) and varied patches (blue) and uniform environment (red). Box plots represent five simulations and show maximum and minimum, upper and lower quartile, and median. We include data of the first 5 years. b Average cumulative diet energy with (red, C = 0.5) and without (black) copying in the first 2 years in naïve groups (varied patches). Five simulations are shown for each condition



Overall, this means that preference development is easiest in pure patches, making the additional impact of copying redundant, or instead, even reducing diet energy intake (Fig. , black bars). In uniform environments, preference development is difficult, but copying is also difficult and has a limited impact on learning (Fig. , red bars). Therefore, only in varied patches, where difficult preference development and effective copying come together, do we observe large overall improvement of diet energy uptake (Fig. , blue bars). Below, we discuss the mechanism through which copying improves diet.

Automatic biased copying and familiarity bias
We find that copying can improve diets by increasing foraging biases, and subsequently, familiarity biases of individuals, to high-quality resources. This allows them to forage more selectively for the same food intake rates. Because copying is simply a reflection of food choice by neighbors, which is biased to high-quality resources, copying is automatically biased to high-quality resources. Special copying strategies are therefore not necessary in order to achieve selective copying. Therefore, given the limitation of familiarity biases and ambiguous digestive feedbacks, copying helps individuals obtain “selected” information from neighbors. On a group level, this leads to sharing of experience. The positive feedback between learning and foraging therefore becomes amplified to a group level and can generate increased familiarity biases to high-quality resources. However, whether this happens depends on the underlying dynamics that arise in given resource distributions.

We illustrate this in Fig. , where we plot example preference profiles with and without copying in the different environments. For clarity, we only show a 5-year-old individual (gray) and a 20-year-old individual (black, where black bars are behind gray bars). Resources are ranked according to quality (rank 250 = highest rank), and familiarity with resources can be expressed as resource preference (pir, bars) divided by resource quality (qr, dotted line). For copying (bottom row), we show the “best case” copy preference for each resource distribution (i.e., the maxima in Fig. ).
Preference profiles with (bottom row) and without copying (top row) in different environments. Preferences (bars) are shown for one 5-year-old (gray) and one 20-year-old individual (black). Note that black bars are behind gray bars. An individual’s familiarity with a resource can be expressed as its resource preference (pir, bars) divided by resource quality (qr, indicated by the dotted line). Left: pure patches, middle: varied patches, right: uniform environments. For copying, we show those cases where copying is most effective: dC = 0.05, eC = 0.5, fC = 1.0. Bin size = 5 resources



The impact of copying is most obvious in varied patches (compare Fig. b and e). Without copying, individuals are already biased towards high-quality resources in their preferences (Fig. b, ranks 200–250), but this bias becomes much stronger with copying (Fig. e, C = 0.5) and allows individuals to improve diet energy uptake (Fig. , C = 0.5, blue bars). In contrast, the effects of copying in pure patches and the uniform environment are much more subtle, although we observe the same trend. In both cases, there are slight decreases in preferences for lower-quality resources (ranks 150–200 in pure patches and ranks 0–150 in the uniform environment), and an increase in preferences for high-quality resources (ranks 200–250). These effects are not very apparent, but they are sufficient to generate the significant increase in diet energy observed in Fig.  (C = 0.05, black bars, and C = 1.0, red bars). However, the underlying reason for the limited impact of copying is different in the different environments. In pure patches, this is because familiarity biases are already highly converged on high-quality resources without copying because learning is easy (see Fig. a). In uniform environments, it is a consequence of limited opportunities for copying (see Fig. a).

The mechanism through which copying improves diets requires that copying remains biased to high-quality resources. This relies on individual foraging decisions, which are therefore the selective factor that indirectly mediate copying behavior. However, in pure patches, this mediation can break down because the local abundance of a single low-quality resource can generate contagious copying following a single unselective decision. In particular, high copy preferences can easily overrule individuals’ food choices and reduce foraging selectivity and diet energy uptake (see Fig. , black bars), both because individuals copy unselective naïve individuals and the unselective decisions of experienced individuals (see Appendix  for more detail). In contrast, in varied patches, copying is less sensitive to particular copy preferences (see Fig. , blue bars). With local resource variation, alternative higher-quality foraging opportunities are available, reducing the potential for such effects. Moreover, contagious copying is not possible in uniform environments. How group-level copying can manifest itself is therefore mediated by opportunities in the environment.

Collective learning and cultural inheritance
We find that the impact of copying occurs on short timescales through collective learning (i.e., learning together and from each other in a group) and leads to cultural inheritance on longer timescales. Collective learning already occurs in naïve groups within the first few years in the form of collective exploration (i.e., collective learning in groups of naïve individuals). Figure b, shows the average cumulative diet energy uptake for the first 2 years in naïve groups with and without copying in varied patches. Even in the first year, copying (C = 0.5, red lines) tends to increase diet energy beyond that of trial-and-error learning (black lines). This process continues, and by the second year, groups with copying clearly have greater diet energy uptake than groups without copying (Wilcoxon two-sample test on group means, n = 5, p &lt; = 0.0079). Such group-level selectivity can arise without copying in patchy environments through spontaneous social influences on learning (van der Post and Hogeweg ), but in uniform environments, it can only be generated with copying. In varied patches, group-level selectivity may occur at a patch level without copying, but within patches, group-level selectivity requires copying.

On longer timescales, population turnover generates differences in individual age and experience and there is a shift from collective exploration to cultural inheritance, where behavior is inherited over generations. This can lead to cumulative cultural diet improvement, as shown by the increases in energy uptake in year 100 (Fig. , solid bars) relative to year 20 (Fig. , striped bars). In the cumulative process, naïve individuals coming into a group enter preselected learning contexts and have greater biased foraging to copy from than a group of completely naïve individuals. This allows them to develop familiarity biases that are better focused on high-quality resources, which subsequently feeds back on collective learning. This cumulative cultural process was demonstrated previously for the case without copying in pure patches (van der Post and Hogeweg ). Here, we find that copying enhances the cumulative cultural process and extends it to environments with high local variation in resources if it leads to effective collective learning on short timescales.

Discussion
We find that copying helps individuals improve diets by extending their exploration of the environment using the preselected bias of their neighbors. On a group level, this can lead to information sharing and collective exploration on short timescales, and on longer timescales leads to cultural inheritance and cultural improvement in diet. Whether this happens depends on how local foraging opportunities, as shaped by resource distributions, shape the learning process.

We find that local foraging opportunities affect copying at two levels. First, local foraging opportunities shape the difficulty of preference development both by shaping familiarity bias formation and the ambiguity of feedbacks when digesting mixtures of resources. Second, local foraging opportunities determine the opportunities for copying, and therewith, how often copying occurs and its ability to affect individual learning. As a consequence, the difficulty of preference development coincides with limitations on copying behavior, as in the uniform environment. Moreover, if the ease of copying coincides with ease of learning, this leads to excessive copying, as in pure patches. The greatest impact of copying is therefore observed in varied patches, where difficult preference development and easy copying coincide. In our model, the role of copying can therefore only be understood by considering how these two levels come together, as shaped by foraging opportunities and self-organizing processes.

Important for our results is the implementation of rich environments and prolonged learning. This allows local foraging opportunities to impact foraging behavior and learning. By implementing preference development and copying at short timescales, copying can be thoroughly integrated into the learning process. It therefore always reflects recent sampling of the environment, allowing it to play a role in exploring the environment. Moreover, in rich environments, there are many learning opportunities, and learning (local information processing) is always limited in time. As a consequence, individuals can vary in information acquisition, making information sharing meaningful. This emphasizes the importance of an opportunity-based approach for understanding behavioral processes in rich environments, as proposed in the TODO principle (Hogeweg and Hesper ).

Prolonged learning
Our results reveal a potential role of copying relative to a prolonged learning process. Important for our results are (1) the feedback between behavior and learning in a rich environment and (2) its structuring by local foraging opportunities. The feedback between behavior and learning is unavoidable in our model, and may be important to consider in learning processes. This feedback shapes the behavioral outcomes of learning (i.e., familiarity biases), and therewith the contexts in which copying behavior can have an impact. If we short-cut this, by implementing instantaneous learning, only the negative effects of copying remain (results not shown). However, our results are not limited to “slow” learning, as they hold for a tenfold higher preference updating constant (U = 0.1), although the benefits of copying are reduced (results not shown). Copying, as a potential addition to individual information processing, therefore has a role to play if trial-and-error learning is limited.

The relevance of our results to diets therefore depends on whether diet learning is sufficiently prolonged. Although diet development in rich environments is poorly understood, evidence from experimental studies on various mammals indicate that familiarity is a common feature in diet choice (Galef ; Day et al. ; Birch ; Provenza et al. ; Kimball and Nolte ), even in experiments with only two diet items (e.g., Parsons et al. ). Moreover, studies on herbivores show that mixing of resources complicates preference development (e.g., Duncan and Young ), and in many species, aversions to toxic resources are transferred to other resources eaten at the same time (e.g., Hasegawa and Matsuzawa ; Ralphs and Provenza ). These complications arise because preference development depends on delayed digestive feedbacks, making it more difficult to match them to earlier gustatory cues, especially when mixing resources (e.g., see Provenza et al. ). There are therefore strong indications that diet development is indeed sufficiently prolonged, as assumed in this study.

Copying and collective exploration
Our results are in line with social foraging models that suggest information sharing as a benefit of using social cues while foraging (e.g., Clark and Mangel ; Krebs and Inman ; Giraldeau et al. ). However, in some cases, the collective benefit of sharing information may be undermined because, by using social cues, individuals may no longer produce any new information, or may be inhibited from learning (Barnard and Sibly ; Giraldeau et al. ). This may lead to frequency-dependent effects where the group is no better off than before information sharing (see also Giraldeau et al. ). In the context we consider here, these issues do not play a role because individuals cannot avoid producing information, and social and personal information about food are acquired simultaneously (see also Giraldeau et al. ). A trade-off between individually and socially acquired information therefore does not arise, and copying reflects recent sampling information of the environment.

However, while we do not find that copying can reduce the acquisition of new information in groups, we do find that the mediation of copying by individual experience and selectivity is crucial, as revealed by excessive copying. In our model, mediation happens indirectly because copying reflects the selective foraging of individuals. This breaks down in pure patches, where copying can become contagious when high-copy preferences overrule individual experience. This is similar to what are called informational cascades (Giraldeau et al. ). We find that this depends on the local abundance of a single resource. Possibly, contagious copying can be prevented by mediating copying directly by personal experience (see Laland ), as has been shown to happen in fish (see van Bergen et al. ). However, in our model, mediated copying behavior may only be necessary when copying can spread easily through groups, as in pure patches. Such contagious copying is less likely with increased local resource variation. Copying behavior may therefore already be largely mediated by the environment. This should be taken into account when considering copying strategies. Moreover, the importance of individual experience and selectivity suggests that if copying would directly affect preferences, the mediation by individual experience would be weakened and copying would easily become excessive.

Timescales and cultural inheritance
Our results indicate that understanding the dynamics of learning processes on short timescales may be central to understanding the ecology of cultural inheritance (also recognized by Giraldeau et al. ; Danchin et al. ). In particular, we find that, where copying is effective on the short term, especially in varied patches, cumulative cultural processes are also generally present (see Fig. ). Moreover, when the impact of copying is limited on the short term, as in uniform environments, a large proportion of its impact may only be possible on cultural timescales (see Fig. , red bars). This illustrates how local ecological conditions determine to what extent diets may depend on cumulative cultural change.

Importantly, we do not implement cultural inheritance, but merely implement copying on short timescales. As a result, we observe a natural transition from collective exploration, when the whole group is naïve, to cultural inheritance when experience varies in the group. As the actual copying behavior is identical in both cases, this reveals that the role copying plays in learning (i.e., exploration or inheritance) is merely a reflection of the age-structure and experience within groups. We therefore find that cultural inheritance arises when copying on the short term occurs between individuals of different ages and experience, over multiple generations, therewith allowing transmission of behavior between individuals that could never meet. Cultural inheritance therefore depends on the interrelationship between short-term copying behavior and longer-term population turnover. In fact, it is the interplay between these two processes with different timescales that allows cumulative cultural diet improvement to arise. By considering multiple timescales, our results therefore provide insight into the origin of cultural processes and their relationship to copying on short timescales, and therewith the ecological conditions that may favor them.

Acknowledgements
This research was funded by the Netherlands Science Organization (NWO, grant number 051-12-040, Evolution and Behavior Program). We would like to thank two anonymous reviewers and the editor for valuable comments.

Open Access This article is distributed under the terms of the Creative Commons Attribution Noncommercial License which permits any noncommercial use, distribution, and reproduction in any medium, provided the original author(s) and source are credited.

Appendix
Appendix A: Model parameters
Table .
Model parameters and values

Category	Parameter/description	Value	Units	
Timescale	T (time step)	1	min	
Day	1,000	min	
Year	100	Days	
Environment	D (grid unit)	1	m	
Field size	2.8 × 2.8	km	
Number of resources	250	Resources	
Number of patches	4,900	Patches	
Patch radius	10	m	
Varied patches	
 Number of resources in patches	5	Resources	
 Number of resources per patch	3	Resources	
Number of resource items per patch	±3,960	Items	
Resource renewal interval	1	Year	
Number items per grid unit	
 Uniform	±3	Items	
 Patchy	±10	Items	
Grouping	Distance to check for safety	10	m	
Number of neighbors required to be safe	3	Neighbors	
Maximum awareness for neighbors	150	m	
Probability to adjust direction after rejoining group	0.9	
Distance within which direction of neighbor is observed	20	m	
Learning	U (update constant for preference learning)	0.01	
Maximum distance to observe feeding neighbor	5	m	
Duration of observation memory	30	min	
Searching and selecting food	Percentage with which preference expectation is updated	10%		
Selectivity during foraging (N)	3		
Maximum stomach contents	20	Items	
Private space for foraging/individual’s reach	0.9	m	
Distance resources can be observed	2	m	
Field of vision	180	Degrees	
Maximum number of resources can be observed	20	Items	
Actions	Duration of search event	0.5	min	
Distance when moving back to group	3	m	
Duration of movement back to group	0.015	min	
Distance moving forward	10	m	
Duration when moving forward	0.15	min	
Duration of doing nothing/duration of eating	1	min	
Digestion interval	100	min	


Appendix B: No mixing during digestion
During preference development, individuals cannot determine the contribution of different resources to digestive feedbacks because digestive feedbacks are averaged over mixtures of digested resources. Here, we show that such averaging makes individual learning more difficult.

In Fig. a, striped bars show normal preference updating, where feedbacks from digestion are averaged over all resources digested together (as in Eq. , main article). Solid bars show preference updating where  is replaced by qr for each resource (see Eq. , main article), which is equivalent to assigning energy feedbacks specifically to each resource. C = 0 shows the case for individual learning and indicates that diet energy intake increases when learning is not constrained by the averaging of feedbacks (Wilcoxon two sample test, n = 100, p &lt; 0.00001 for all striped and solid bar pairs, Bonferroni corrected for six tests). This is especially so in the uniform environment (red bars). Preventing the averaging effect clearly makes learning easier.
Impact of digesting mixture of resources on diet energy uptake in varied patches (blue) and the uniform environment (red). Striped bars: default preference development (see Eq. ). Solid bars: preference development without digestive feedback over resources (in Eq.  (main article),  is replaced by qr for each resource). The impact of copying is shown for C = 0.1 and C = 1.0. All bars are averages of five simulations at year 100 and error bars are standard deviation



However, even without the effects of mixing resources, both in varied patches (blue) and the uniform environment (red), copying is still able to increase diet energy uptake [Wilcoxon two sample test, n = 100, p &lt; 0.00001, for each C = 0 and C &gt; 0 pair (solid bars), Bonferroni corrected for four tests]. Therefore, even without the effects of mixing resources, familiarity bias formation can constrain learning, allowing copying to play a role.

Appendix C: Excessive copying
The decline of diet energy uptake for high copy preferences in pure patches (Fig. , black bars, main article) indicates that copying can become excessive. Here, we show that there are two ways in which this occurs: (1) when individuals copy naïve individuals and (2) when individuals continue to copy when they already forage selectively. Note that excessive copying only occurs in patchy environments, where copying is easy and unselective foraging can spread quickly through groups. Individuals continually stimulate each other, making the process self-reinforcing. In uniform environments, the difficulty of copying prevents this.

Copying naïve individuals causes reduced diet energy intake because naïve individuals initially sample all resources unselectively. The impact of copying naïve individuals is demonstrated in Fig. a, which shows median diet quality over several years (years 80–85) for maximal copy preference (C = 1.0) in varied patches. Diet quality is clearly reduced at the beginning of each year due to naïve individuals entering the group. We show median diet quality, which means that the reduction in diet quality involves the majority of the group. This effect does not occur for lower copy preferences and can be prevented by only copying individuals older than 1 year (not shown).
Excessive copying in patchy environments. a Diet quality in time (years 80 to 85) for maximal copying preferences (C = 1.0) in varied patches. b Resource feeding distributions with (red, C = 1.0) and without copying (black) of individuals with perfect knowledge in pure patches. Lines indicate how much resources of different quality are eaten (average of group for year 100)



The impact of copying between experienced individuals is demonstrated in Fig. b, which shows the feeding distributions of individuals with (red) and without (black) copying when they have perfect preferences (preferences equal to resource quality), in pure patches. Copying (Fig. b, red) causes individuals to feed more on lower-quality resources and reduce foraging selectivity. This happens because knowledgeable individuals already forage selectively and copying cannot increase their probability of choosing high-quality resources (copying is redundant), but only that of choosing lower-quality resources. This is why, when preference learning is easy and individuals quickly become sufficiently selective, as in pure patches, copying can become excessive.

Wilcoxon two-sample test, on individuals from 20 simulations, n = 400.

Note that it is not the absolute preference that is important for food choice, but the relative differences between preferences. U therefore does not directly affect the speed with which familiarity differences arise, but rather the scope of familiarity differences.

