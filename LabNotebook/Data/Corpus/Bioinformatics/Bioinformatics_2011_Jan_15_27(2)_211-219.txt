1 INTRODUCTION
Non-coding RNAs (ncRNAs) are receiving rapidly growing attention; they are present in large numbers as observed by ) and the FANTOM2 project (), and they appear in many unexpected cases (e.g. ). The potential of functional ncRNAs is further supported by the observation that the amount of non-protein-coding DNA increases with organismal complexity, whereas the amount of protein-coding DNA is relatively constant (). A substantial number of putative ncRNAs has emerged from several genomic in silico screens for RNA structure taking compensatory base pair changes into account (, ; ; ; ). Deep sequencing approaches are another growing source of ncRNAs (e.g. ).

One step towards assigning functions to these putative ncRNAs is to consider RNA interactions. An important class of these are RNA‚ÄìRNA interactions; many ncRNAs base pair with other RNAs, such as the majority of characterized bacterial small regulatory RNAs (sRNAs) (). Besides the well-known examples of microRNAs (miRNAs) and small interfering RNAs (siRNAs), there are also many longer eukaryotic ncRNAs that act via RNA‚ÄìRNA interaction. Examples are small nucleolar RNAs (snoRNAs), of which the main function is to guide the editing of ribosomal RNA (). However, there is growing evidence that other long ncRNAs might act via base pair interactions as well. For example, it is likely that certain long ncRNAs modulate the activity of miRNAs by forming RNA‚ÄìRNA interactions ().

Even though most screens for ncRNA candidates involve mammalian genomes () we predominantly found with the exception of a few snoRNA examples, bacterial examples of verified RNA‚ÄìRNA interactions involving the structure of both RNAs. This pattern might be the reason that many of the existing methods for the prediction of RNA‚ÄìRNA interactions have been designed to work on bacterial sRNAs [see ) for a review]. Furthermore, extensive curated data for RNA‚ÄìRNA interactions are limited because this effort is, just as for RNA structural alignments, rarely acknowledged ().

Recent interest in prediction of RNA‚ÄìRNA interactions has led to four main classes of computational methods to solve this task. Initial approaches evaluated only base pairs involved in duplex formation (e.g. ; ). The second class consists of methods that predict a joint secondary structure of two interacting RNAs by folding their concatenated RNA sequences (e.g. ; ; ). This concatenation approach considers only a restricted set of interaction types, and therefore, the third class evolved. Here, all interactions with one site are allowed and interaction site accessibility is calculated by the partition function of the structure ensemble (; ; , ; ). The final class of methods handles more complex joint structures with multiple interaction sites (; , ; , ; ; , ). However, these methods are very resource-demanding, which makes them not applicable for genome-wide scans. Furthermore, all aforementioned methods evaluate only interactions between a pair of single sequences.

For an approach that makes use of multiple alignments, our assumption is that a non-negligible amount of the existing RNA‚ÄìRNA interaction contains compensatory changes across the binding sites. Whereas this is a motivating aspect, the general variation in the sequences with even a completely conserved interaction site might also yield prediction improvements. Such an improvement over single sequence-based methods can be obtained by taking the overall sequence variation into account for the joint framework of energy folding and covariation.

The literature contains only limited examples of conserved RNA‚ÄìRNA interactions with likely compensating base pair changes, such as the MicA‚ÄìompA interaction, where base pairing is preserved by compensatory changes in several enterobacterial species (). These authors also developed a method for predicting interactions that takes phylogenetic conservation into account, but to our knowledge, they have not yet published it. One explanation for the limited amount of data containing covariance information might well be that most existing data have been found using sequence similarity-based methods such as BLAST () to find homologs of the interacting RNAs. Such an approach is expected to lead to a collection of RNAs that are highly conserved in the primary sequence rather than structure. Although in these cases it is likely that the interaction pattern is conserved as well, only a small number of compensatory base pair changes is expected. Therefore, we also include simulated data based on substitution statistics of interacting base pairs. Applying simulated data to make controlled tests or to supplement existing data has been done several times before (e.g. ).

To summarize, there are three main problems for the prediction of RNA‚ÄìRNA interactions: (i) the small number of examples with mapped interactions, (ii) most existing computational methods work on single sequences and therefore suffer from a low specificity and (iii) the search for complex types of interactions is expensive if a guaranteed maximum score is to be obtained. The last is discussed in more details in ), where we propose an algorithm for searching for RNA‚ÄìRNA interactions between two multiple RNA sequence (or sequence-structure) alignments. Our algorithm can compute a semi-optimal combination of intra- and inter-molecular base pairs to predict a joint secondary structure of two multiple alignments of RNA sequences, each representing its own evolutionary and structurally conserved RNA. The method makes use of the idea of a linker from RNAcofold () by concatenating both RNA sequences, but employs this idea in the context of PETfold () along with a strategy for hierarchical folding (e.g. ). PETfold is based on Pfold (), which provides reliabilities for evolutionarily conserved base pairs, and unifies them with folding energies in one model. Hierarchical folding allows for the prediction of pseudoknots between intra- and inter-molecular base pairs but is still fast enough for genome-scale applications. Here we present its implementation, PETcofold, and an in-depth performance evaluation. A key motivation for implementing a method that can predict RNA‚ÄìRNA interactions between two multiple alignments of RNA sequences is the existence of many ncRNA candidates identified by genome-wide in silico screens as mentioned before. These de novo predicted RNA structures exist already as multiple alignments and the PETcofold implementation presented here can readily be employed to further analyse these candidates for potential interaction partners.

2 METHODS
2.1 Algorithm and implementation
The algorithm presented in ) is implemented here in the PETcofold program. The input consists of two RNA alignments ùíú1 and ùíú2, and the program performs hierarchical folding in two steps. This multi-step approach is motivated by the observation that interaction formation is often initiated at well-accessible intra-molecular structures such as hairpin loops (). Furthermore, several existing methods are based on this observation and assume that the interaction sites are made accessible to allow for hybridization of the two RNAs (e.g. ; ). The workflow of the PETcofold pipeline is shown in . Supplementary Figure S1 shows a flow chart of the different programs integrated in PETcofold.
The PETcofold pipeline consists of two steps: (1) intra-molecular folding by PETfold and selection of a set of highly reliable base pairs that only decreases the probability of the ensemble in some pre-defined range; (2) inter-molecular folding by adapted PETfold using constraints from step 1. In the end, partial structures and constrained inter-molecular structures are combined to form the joint RNA secondary structure including pseudoknots.



In step 1, we search for highly reliable base pairs in both RNA alignments, these are interpreted as being not accessible for the RNA‚ÄìRNA interaction. We apply the maximum expected accuracy approach of PETfold separately on the alignments ùíú1 and ùíú2 to calculate reliabilities unifying the thermodynamic probabilities from RNAfold () and the evolutionary reliabilities from Pfold. The set of all base pairs with high base pair reliability ‚Ñõbp in the folding of the individual alignments, i.e. ‚Ñõbp is greater than a threshold Œ¥, forms a partial structure œÉp and will be denoted as œÉp1 and œÉp2 for ùíú1 and ùíú2, respectively. To ensure that the highly reliable base pairs of the partial structure œÉp are also part of the final (consensus) structure, they should make up a significant portion of the probability Pr[‚Ñ∞(œÉp)] in either the thermodynamic or the evolutionary model, where ‚Ñ∞(œÉp) is the ensemble of structures that are compatible with the partial structure œÉp. A high value of Pr[‚Ñ∞(œÉp)] is guaranteed by the introduction of a second threshold Œ≥. The threshold Œ¥ for highly reliable base pairs is now increased until the probability of ‚Ñ∞(œÉp) exceeds Œ≥ either in the evolutionary or the thermodynamic model or both. In addition, constrained stems in the partial structure œÉp are extended by inner and outer base pairs if the average reliability of the extended stem is larger than Œ¥ and if the partial structure probability Pr[‚Ñ∞(œÉp)] exceeds Œ≥. This feature is enabled by the option -extstem.

In step 2, we concatenate the input alignments ùíú1 and ùíú2 with a linker symbol ‚Äò&amp;‚Äô to search for conserved interactions and structures of the sequences of the two alignments. On the concatenated alignment, we apply an adapted PETfold model that can handle fixed partial structures œÉp1 and œÉp2 from the first step by constrained expected accuracy scoring, which is an extension of PETfold's maximum expected accuracy scoring for constrained folding. We search for a joint structure œÉ of the combined alignment that extends both œÉp1 and œÉp2, i.e. œÉ ‚äá œÉp1 ‚à™ œÉp2. Although PETfold cannot handle pseudoknots and the linker in step 2 forbids pseudoknots in the concatenated sequences, i.e. the resulting structure has to be nested, the hierarchical folding strategy of PETcofold allows pseudoknots between intra-molecular base pairs from step 1 and inter-molecular (as well as intra-molecular) base pairs from step 2 by restricting the positions of the concatenated alignments that are covered by base pairs from œÉp1 and œÉp2 to be single stranded. Under these constraints, the thermodynamic probabilities are calculated with RNAcofold, and the evolutionary reliabilities are calculated with an adapted Pfold using constrained folding, which yields the structure œÉint. This constrained folding results in raw probabilities, which are then weighted by the product of partial structure probabilities Pr[‚Ñ∞(œÉp)] from step 1. However, to avoid underestimating the probabilities of step 2, we here replace the product with the geometric mean of partial structure probabilities. The constrained expected accuracy structure œÉint is calculated by a Nussinov-style algorithm and might contain both intra-molecular as well as inter-molecular base pairs. The final consensus structure including the interaction is then

In the final scoring, the reliabilities of all base pairs from œÉp1 and œÉp2 are equal to the partial structure probabilities Pr[‚Ñ∞(œÉp1)] and Pr[‚Ñ∞(œÉp2)], respectively.

The algorithm, which is described in more detail in ), has a time complexity of O(N √ó I √ó L3), where N is the number of sequences, I is the number of iterations in the adaptation of Œ¥ to find probable partial structures and L is the sum of the sequence lengths of both alignments.

2.2 Datasets and processing
The evaluation of PETcofold was performed using datasets extracted from the literature combined with simulated data, in which the degree of compensating base changes is controlled.

First, a dataset of interactions between bacterial sRNAs and their target mRNAs was extracted. Starting from a set of experimentally verified interactions used by ), we included further sRNA‚ÄìmRNA interactions with experimental support from the literature. The final dataset contained 13 different sRNAs and 32 interactions from Escherichia coli K12 (E.coli), Salmonella typhimurium LT2 and Staphylococcus aureus N315 (see Supplementary Table S1).

For each sRNA, the RNA family sequence alignment was downloaded from the Rfam database 9.1 (). Orthologs of target genes were predicted in species with available complete genomes according to the Rfam annotation. The prediction of orthologous genes was carried out with OrthoMCL () using the default parameters. For each target gene, a 250 nt subsequence was extracted (150 nt upstream and 100 nt downstream of the annotated translational start sites) because all interactions occurred from ‚àí132 nt to +56 nt relative to the start codon. The sets of putative orthologous target sequences were locally aligned with MAFFT (using option E-INS-i for generalized affine gap costs) ().

The resulting dataset was processed by homology reduction and removal of sequences that were very distant to the reference, i.e. the organism in which the interaction was detected. This step aims to remove false positive predicted orthologs and was achieved by excluding all mRNA sequences with a low pairwise sequence identity (PIintref) at the interaction site and within 10 nt of the flanking sequences compared with the reference sequence. PIintref thresholds of 40, 50 and 60% were applied. To avoid a bias caused by overweighting redundant sequence information, mRNA sequences were clustered with the BLASTClust tool () using a word size of 8 and a percent identity threshold of 100% over an area covering 90% of each sequence. The sequence with the lowest PIintref was taken from each cluster. Further details on the preparation of the dataset are given in the Supplementary Material.

To evaluate the covariance of a dataset, the arithmetic mean of compensatory base pair (CBP) exchanges of all interactions was computed. For a specific interaction, the CBP is computed as the average number of compensatory base pairs in all interacting alignment columns, where a compensating base pair is distinct from the bases involved in the pairing of the reference sequence. Thus, the maximal value of the CBP is 5. Another covariance measure is the probability Pr[œÉi,j|ùíú, T, M] of a base pair (i, j) calculated by Pfold. It is more accurate because it takes into account, by the tree T, the evolutionary distance of the sequences in the alignment ùíú. The model M describes the substitution rates of base pairs and unpaired bases and the probabilities of secondary structure production rules (); however, the bias introduced by M can be ignored. To measure the covariance of a full interaction, we use the normalized Pfold reliability ‚Ñõ(int), which is the mean of all base pair probabilities in the interaction.

2.3 Simulated data
The dataset described above is based on sRNA‚ÄìmRNA interactions that were experimentally validated in one reference organism. The incorporation of homologous sequences from Rfam families and computational prediction of orthologous genes is often used. However, this approach could be limited in two respects. From a biological point of view, our method assumes that the homologous sRNAs regulate the same targets by the same mechanism in all organisms that are contained in the sequence sets. Although this assumption probably holds true for many interactions, it does not have to apply to all of them. Furthermore, the target orthologs might contain false positive predictions with different physiological functions and regulatory mechanisms. From a technical point of view, weak covariance at the interaction sites limits the full potential of PETcofold. For example, the most conserved region of the sRNA SgrS is involved in base pairing its target ().

Thus, we created a simulated dataset with increased covariance. We used SISSI () to simulate sequence data with site-specific interactions annotated by the sRNA‚ÄìmRNA interactions of our dataset along phylogenetic trees. To be biologically relevant, we estimated each phylogenetic tree from the corresponding alignment using a maximum likelihood method with an independent model. For tree reconstructions, IQPNNI 3.3.1 () was used with a F81 model (); otherwise, the default settings were used. To specify the rate matrices, we simply counted the frequencies of the nucleotides {A, C, G, U} for sites evolving independently and doublet frequencies for the distant RNA interaction pairs. For each of the 32 alignments, we performed 20 simulations with the same length and in the context of the annotations of the sRNA‚ÄìmRNA interactions using a Markov model of nucleotide sequence evolution () with rate matrix types of the F81 model. We initially started simulations along the estimated phylogenetic trees. Then, to increase the covariance, we multiplied each branch length by a scaling factor. The simulation runs were repeated under the same parameters with eight different scaling values as shown in .
Prediction performance of PETcofold on simulated sequence data

Scaling factor	Mean branch length	‚Ñõ(int)	CBP	Mean MCC	
1	0.03	0.486	0.832	0.505	
5	0.15	0.665	1.818	0.677	
10	0.3	0.699	2.182	0.717	
25	0.75	0.732	2.550	0.743	
50	1.5	0.775	2.755	0.773	
75	0.75	0.791	2.858	0.783	
100	3.0	0.801	2.908	0.790	
150	4.5	0.822	2.988	0.802	
200	6.0	0.839	3.040	0.821	
Scaling factor multiplies each branch length of the phylogenetic tree. Mean branch length denotes the mean of the mean branch lengths for all 32 phylogenetic trees. ‚Ñõ(int) denotes the mean base pair probability at the interaction sites (calculated by Pfold). CBP denotes the average number of compensatory interaction base pair exchanges in the simulated sequence data. MCC evaluates only the interaction. PETcofold was called with parameters Œ¥ = 0.9, Œ≥ = 0.1 and option -noLP to forbid lonely base pairs.



2.4 Performance evaluation
All predictions were evaluated by calculating their correlations to the structures from literature ignoring non-canonical base pairs. We used the Matthews correlation coefficient () defined as

where TP is the number of mutual base pairs in the two assignments (true positives), TN are the true negatives, FP is the number of predicted base pairs not in the annotated assignment (false positives) and FN are the false negatives. For RNA secondary structures, the geometric mean of sensitivity (SEN = TP/(TP+FN)) and positive predictive value (PPV = TP/(TP+FP)), , is a good approximation of the MCC () and, here, is used to compare predicted joint secondary structures with the annotations. The MCC should be maximized to achieve the best possible trade-off between sensitivity and PPV.

The MCC of the prediction to the annotation is computed for each sequence in the alignment. The arithmetic mean of these single MCCs gives the mean MCC of a prediction. Arithmetic mean and median MCC of a whole dataset are calculated from the mean MCCs of all interactions contained in the dataset.

PETcofold is a comparative approach that detects conserved joint secondary structures. Hence, to compare with single sequence-based approaches, we also determined conserved consensus structures from the results of inteRNA, Pairfold, RactIP and RNAcofold. The consensus structure is defined by all base pairs that are conserved in a given percentage of single structures (here: 80 and 100%) of each of the sequences in the multiple alignment.

3 RESULTS
3.1 Parameter estimation on bacterial sRNA‚ÄìmRNA interactions
The performance of PETcofold under various parameter settings was evaluated on a dataset of 32 bacterial sRNA‚ÄìmRNA interactions. The PETcofold parameter Œ¥ sets the maximal intra-molecular base pair reliability of bases to be free for inter-molecular folding, and the parameter Œ≥ sets the minimal partial structure probability. For each of the two parameters, 11 values ranging from 0.0 to 1.0 in steps of 0.1 were tested yielding 121 parameter combinations. Furthermore, we tested the influence of the option -noLP, which disallows pairs that can only occur isolated in the thermodynamic part, i.e. it is used as an option for RNA(co)fold. Columns with more than 50% gaps were removed.

The influence of the data composition on PETcofold's prediction quality was analysed by varying the minimal pairwise interaction site sequence identity (PIintref).

PETcofold was applied to three datasets containing all 32 interactions, which were created by using PIintref of 40, 50 or 60%.  shows the 3D plot of the mean interaction MCCs for all parameter combinations tested for 60% PIintref (without -noLP). Here, PETcofold yielded the best performance for Œ¥ = 0.9 and Œ≥ ranging from 0.0 to 0.5. The 3D plots for PIintref of 40 and 50% are given in Supplementary Figure S2. Of all three datasets, the best mean MCC was 0.511 (median MCC: 0.583) for 50% PIintref, Œ¥ = Œ≥ = 0.9 and option -noLP. When taking all runs into account, the option -noLP had only marginal influence on the mean MCCs (see Supplementary Table S2).
The performance of PETcofold while varying the parameters Œ¥ (maximal intra-molecular base pair reliability) and Œ≥ (minimal partial structure probability). The 3D plot shows the mean MCC of 32 interactions using input sequences with a minimal pairwise mRNA interaction site sequence identity to the reference of 60%. Predictions were carried out without the option -noLP. The maximal MCC is marked with ‚Äò+‚Äô.



The average number of compensatory interaction base pair exchanges (CBP) in the three datasets ranged from 0.1 to 0.2 (see Supplementary Table S2c). Since the best mean MCCs were very similar and differed by 0.02 at most, the variation in covariance observed here seemed to have no strong influence on the MCC.

The numerical experiments indicate that the use of intra-molecular constraints improves the prediction of interaction sites. Nevertheless, the probability threshold Œ¥ for base pairs in the partial structure œÉp has to be fairly high to achieve the best MCCs. This is in agreement with ), in which we showed that the structural mass of intra-molecular partial structures has to be high to support the constrained expected accuracy scoring. When setting Œ¥ to 1, then no base will be constrained by base pairing for the inter-molecular folding step. Consequently, no loop‚Äìloop interactions between the two single structures are allowed. We found that a Œ¥ of 0.9 yields the best MCC. This setting forbids interactions in highly structured regions and, thus, accounts for the importance of interaction site accessibility.

The parameter Œ≥ adapts the probability of partial structures to cover a high mass of the entire ensemble of structures. This strategy avoids constraints that are not compatible with reliable alternative structures supporting the interaction site. In five out of six sets of input alignments, we observed the best performance for Œ≥ = 0.9 (see Supplementary Table S2). For multiple alignments with PIintref of 60%, we achieve the best performance for 0 ‚â§Œ≥ ‚â§ 0.5. In real applications, sequence-based alignments are often used as input, which perform satisfactorily for pairwise sequence identities above 60%. For the prediction of joint secondary structures, we use a rather restrictive Œ≥ of 0.1 to allow many constraints for intra-molecular base pairs. Furthermore, on the limited set of joint structures presented in , we achieved no performance increase by a higher value for Œ≥ (see Supplementary Table S3).

3.2 Simulated interactions with increased covariance
The average number of compensatory interaction base pair exchanges (CBP) in the 32 interactions from  was rather low with values of 0.1‚Äì0.2. Therefore, we created a simulated sequence dataset based on these interactions as described in . Here, covariance at the interaction sites was increased by scaling the branch lengths of the phylogenetic trees that guided the simulation. As shown in , the minimal CBP computed from the simulated data was 0.8, which was higher than the CBP of the real data. This was due to the fact that the simulations only covered a subset of the evolutionary constraints on the sequences. For example, only the interactions without thermodynamics were used as structural constraints. Other evolutionary pressures on the sequences were neglected. However, taking into account all aspects in the simulations with a corresponding maximum likelihood framework is beyond the scope of this article. At this point, we focused on evaluating PETcofold's performance on datasets with increased covariance.

We applied PETcofold to these datasets and computed the mean interaction MCC of all 20 simulation runs for 9 different phylogenetic scaling factors.  shows the mean interaction MCC plotted over the phylogenetic scaling factor for PETcofold predictions with Œ¥ = 0.9, Œ≥ = 0.1 and the option -noLP. The mean MCC of the predicted interactions was 0.505 for scaling factor 1. The prediction accuracy of PETcofold in terms of MCC increased with increasing scaling factors. A mean MCC of 0.821 was achieved for scaling factor 200.  shows for all scaling factors the mean interaction MCC and the covariance in the data as evaluated by ‚Ñõ(int) and CBP. It can be clearly seen that the performance of PETcofold correlated with the covariance at the interaction sites.
Prediction performance of PETcofold on phylogenetically simulated sequence data for 32 interactions. Covariance of the data were increased by multiplying each branch length with a phylogenetic scaling factor. PETcofold was called with parameters Œ¥ = 0.9, Œ≥ = 0.1 and option -noLP.



3.3 RNA joint secondary structures
In ), we gave the theoretical background of PETcofold and presented the joint structure prediction of a prototype implementation on the well-known example OxyS-fhlA (). Additional examples are presented in the following and PETcofold's performance is explored more quantitatively using the MCC measure and a comparison to other joint structure prediction methods. The predictions for the examples MicA-ompA, OxyS-fhlA, RyhB-sodB and RyhB-uof-fur were compared with the interaction models based on structural mapping as described by ); ); ) and ). The interactions of RyhB-sodB and OxyS-fhlA involve one and two loop‚Äìloop interactions, respectively. Consequently, their joint structures contain pseudoknots between the single structure and the interaction.

For the structure prediction, the dataset with a minimal mRNA interaction site identity (PIintref) of 60% was used. To make the predictions comparable with the annotated structures, an mRNA subsequence as given in the proposed interaction complex model was used instead of the 250 nt subsequence as described in . Regarding the sRNAs, the Rfam entry of RyhB (RF00057) missed the first 29 nt of the E.coli RyhB sequence. However, this subsequence is involved in forming the secondary structure. Thus, homologs of the RyhB sRNA were searched with the semi-global alignment tool GotohScan 1.3 () using defaults parameters. The genome-wide search was conducted with an E-value threshold of 1e-3 in all organisms contained in the RyhB alignment of the aforementioned dataset. Homologs were found in all of these organisms except Vibrio cholerae O395. A multiple sequence-structure alignment of the identified homologous RyhB sequences was computed with LocARNA 1.5a (). The mRNA and sRNA alignments of the four examples were hand curated by removal of redundant sequences and of sequences that were very distinct from the reference organism E.coli, in which the interaction models were experimentally determined.

To predict the joint structures, PETcofold was called with parameters Œ¥ = 0.9, Œ≥ = 0.1, option -noLP and optionally with option -extstem. Our evaluation included the following single sequence-based methods: the sparsified version of inteRNA (), Pairfold (), RactIP (), all with default parameters, and RNAcofold () using parameters -d2 -noLP. All methods apart from RactIP predict minimum free energy joint secondary structures. inteRNA is based on the model by ), whereas Pairfold and RNAcofold are based on folding of the concatenated input sequences using the model of ). RactIP uses integer linear programming to maximize an objective function that is based on internal and external base pair probabilities.} All computations were performed on a machine with AMD Opteron 2356 processor (2.3 GHz) and 16 GB RAM.

All resulting consensus structures were compared with the joint structure from the literature using the approximated MCC.  lists the MCCs of all four examples for PETcofold and the compared methods.
Performance of PETcofold and other joint structure prediction methods on four sRNA‚ÄìmRNA examples

sRNA-target pair	MCC	Run time (s)	
	PETcofold	inteRNA	Pairfold	RactIP	RNAcofold	PETcofold	inteRNA	Pairfold	RactIP	RNAcofold	
	-extstem	80%	100%	80%	100%	80%	100%	80%	100%	-extstem					
MicA-ompA	0.87	0.83	0.49	0.51	0.86	0.74	0.57	0.57	0.80	0.67	28.7	28.4	69493.1	3.2	3.0	0.2	
OxyS-fhlA	0.80	0.82	0.64	0.64	0.61	0.61	0.48	0.48	0.61	0.61	20.6	19.3	129636.7	1.9	2.0	0.2	
RyhB-uof-fur	0.13	0.13	0.12	0.00	0.21	0.21	0.19	0.00	0.21	0.21	26.4	25.3	65599.2	2.6	2.7	0.2	
RyhB-sodB	0.67	0.71	0.70	0.68	0.65	0.51	0.65	0.59	0.65	0.63	15.4	15.2	23579.3	1.7	2.0	0.1	
Average	0.62	0.62	0.49	0.46	0.58	0.52	0.47	0.41	0.57	0.53	22.8	22.1	72077.1	2.4	2.5	0.2	
The MCC evaluates the joint structure, i.e. both the interaction between the two RNAs and the secondary structure of each single RNA. PETcofold was called with parameters Œ¥ = 0.9, Œ≥ = 0.1, option -noLP and optionally with option -extstem. inteRNA, Pairfold and RactIP were called with default parameters. RNAcofold was called with options -d2 -noLP. The columns 80% and 100% give the result for the consensus structure with base pairs that occur in 80 and 100%, respectively, of the single structures. The run time of all single sequence-based approaches is the sum for all input sequences.



For the interactions of OxyS-fhlA and RyhB-sodB, the MCC of the PETcofold predictions was slightly higher when using the option -extstem. The opposite applies to MicA-ompA. On the non-curated alignments, the MCC was up to 0.2 lower (data not shown), which emphasized the importance of high-quality input alignments for our method. However, the option -extstem seemed to improve the prediction when using low-quality input alignments by extension of imperfectly (structurally) conserved stems.

When comparing PETcofold with the other methods, our method overall showed a better performance in predicting the joint structures. The prediction quality of the RyhB-uof-fur joint structure is very low for all compared approaches (maximal MCC of 0.21), which implies that the published interaction model is not predictable with the evaluated computational approaches. Thus, the prediction for this example is not reliable. When excluding RyhB-uof-fur, our approach gives consistently more reliable predictions than the single sequence-based methods (see .)

For comparison to the complex joint secondary structure prediction methods with high resource consumption (both high time and memory complexity), we were only able to compare to \textsf{inteRNA}, as this is currently the only method with a sufficiently low resource consumption. However, the evaluation shows that this (minimum free energy structure) prediction approach is not very reliable without homology information. Thus, one has to resort to the more complex partition function approaches, which, however, have drastically larger time and memory requirements. For example, it was not possible to obtain predictions from RNArip () with reasonable resources. In comparison, PETcofold gave reliable predictions within seconds, which makes it also fast enough for genome-scale applications.

 shows the annotation and PETcofold prediction for MicA-ompA together with the sequence alignments used as input. PETcofold correctly predicted all interaction base pairs from the annotation. The interaction site is highly conserved in both RNAs and contains only one compensatory mutation for the pairing between alignment positions 16 and 126. The intra-molecular structures contain compensatory mutations, for instance, between alignment positions 60 and 65.
Joint secondary structure of the sRNA MicA and the mRNA ompA. The alignment shows the two input alignments concatenated by the linker symbol ‚Äò&amp;‚Äô, the joint structure predicted by PETcofold (with parameters Œ¥ = 0.9, Œ≥ = 0.1 and option -noLP) and the model of the MicA‚ÄìompA complex proposed by ). Sequences are labelled with the genome accession numbers of the corresponding organisms. Angle brackets indicate inter-molecular base pairs. Round and square brackets indicate intra-molecular base pairs. Square brackets indicate positions that are constrained in step 1 of the PETcofold pipeline. For ompA, only 40 nt upstream of the interaction site are shown. The alignment was visualized with Jalview ().



Alignments and joint structures of OxyS-fhlA, RyhB-sodB and RyhB-uof-fur are given in Supplementary Figure S3. Two observations might explain the low prediction quality for RyhB-uof-fur. First, the interaction site given in the literature overlapped with the highly probable terminator stem of RyhB, which was constrained for inter-molecular folding. Second, a region of the interaction site that was subject to experimental validation (alignment positions 144 to 149) contained base pairs that were not supported by up to 3 out of 9 sequences of the alignment.

3.4 SnoRNA interactions in vertebrates
SnoRNAs have been experimentally detected in various vertebrates (e.g. ; ), but interactions between snoRNA and their target RNAs have only been predicted. The interactions are located in highly conserved regions for all examples of which we are aware. Despite of the lack of experimentally verified structures, we give one example showing that PETcofold is able to predict the joint structure of the known secondary structures and the predicted interaction.

Vertebrate spliceosomal snRNAs are highly modified by pseudouridylation and 2‚Ä≤-O-methylation. ) showed that depletion of the C/D box snoRNA mgU6-77 from Xenopus oocytes inhibits 2‚Ä≤-O-methylation of C77 in U6 snRNA.  shows the joint structure including a pseudoknot as predicted by PETcofold. The input consisted of the mgU6-77 alignment from snoRNABase () and the U6 seed alignment from Rfam. The joint structure consisting of the snoRNA structure, the interaction in mouse () and the U6 Rfam structure was predicted by PETcofold with an approximated MCC of 0.74. RNAcofold (parameters -d2 -noLP) performed with an approximated MCC of 0.51 for the consensus structure conserved in 80% as well as 100% of sequences. Both methods predicted further binding sites in addition to the reported highly conserved interaction, whereas PETcofold performed much better in predicting the long hairpin of the snoRNA (PETcofold MCC: 0.85, RNAcofold MCC: 0.0).
Joint secondary structure of mgU6-77 snoRNA and U6 snRNA as predicted by PETcofold using parameters Œ¥ = 0.9, Œ≥ = 0.1 and options -noLP and -extstem. Mouse sequences are shown, but the numbering refers to the input alignment of human, chimp, mouse, cow, tenrec, dog and opossum. Intra-molecular base pairs are coloured in blue and inter-molecular base pairs in green. The cytosine at alignment position 78 (pos. 77 in mouse) is 2‚Ä≤-O-methylated and marked by ‚Äòm‚Äô. We used PseudoViewer3 for drawing ().



4 DISCUSSION
Here, we presented PETcofold, the first comparative method for the prediction of a joint secondary structure of two interacting RNAs. The method identifies evolutionary conserved structures and can exploit the information from compensating base changes in the intra-molecular structures of the two RNAs and the interactions between them. Furthermore, PETcofold allows for the prediction of pseudoknots between intra- and inter-molecular base pairs.

We have shown in controlled runs on simulated data that the covariance information improves the prediction ability for RNA‚ÄìRNA interactions. We have also shown both for a vertebrate snoRNA and for four bacterial sRNAs that the addition of evolutionary information from multiple sequence alignments improves the performance in comparison to methods based on single sequences. This implies that single sequence-based methods could perform better if the comparative information is also taken into account. As for other RNA structure prediction methods making use of sequence-based alignments, it is well-documented that these work best with an average pairwise sequence identity above 60% (; ). In the process of cleaning up the (already sparse) bacterial data, we took this into account by removing more distant sequences to keep the balance of accurate assignment and covariance patterns of base pairs.

Many genomic screens for ncRNAs predict secondary structures with compensatory base pair changes on RNA alignments. These intra-molecular structures can be used as input of step 1 of the PETcofold pipeline to identify highly reliable substructures, which are then constrained for step 2. For example, PETcofold could be applied to predict RNA‚ÄìRNA interactions on the CMfinder-generated structure-based alignments of de novo predicted RNA motifs in the ENCODE regions ().

The sparse amount of known examples of sequences with RNA‚ÄìRNA interactions and the paucity of covariations were the reasons why we introduced simulated data. Some of the known examples of RNA‚ÄìRNA interactions, e.g. from bacterial sRNA‚ÄìmRNA and eukaryotic miRNA‚ÄìmRNA interactions, tend to be rather conserved. Even in cases with little or no compensating base pairs (in interaction sites or in the intra-molecular structure), any given variation will collectively contribute to the calculation of the reliabilities and thereby to the overall structure of the interaction complex. Hence, in the complete lack of covariation, PETcofold reduces to an improved energy folding approach, which also has impact on matching up the interacting base pairs. The sRNA‚ÄìmRNA interactions studied here exhibit only a small number of compensatory base pair changes, which might be because sRNA sequences often show poor conservation across distant bacterial species. Thus, the regulators might be recently acquired and rapidly evolving (). Nevertheless, many of the homologous ncRNAs and mRNAs have been found based on sequence similarity, which leads to highly identical sequences and thereby also to highly conserved interactions. PETcofold considers sequence conservation, but its full power is only revealed when the input data contains structural covariance. In the future, we expect that deep sequencing approaches will give rise to many more characterized transcriptomes, which will increase the amount of data available for analysis including RNAs containing compensating base pair changes.

Certain RNA‚ÄìRNA interactions, e.g. the functionally important interactions between the 16S and 23S rRNAs in the ribosome, involve non-canonical base pairs. Our method looks primarily for canonical, e.g. Watson‚ÄìCrick, base pairs and G-U wobble base pairs. However, the Pfold model includes equilibrium distributions for the frequencies of all possible 16 bp and substitution rates for all possible base pair substitutions (16 √ó 16 matrix), which have been estimated from given trusted alignments of tRNA and rRNAs including non-canonical base pairs (). The probabilities of non-canonical base pairs are low compared with Watson‚ÄìCrick and Wobble base pairs and, thus, in practice, non-canonical base pairs are only found together with canonical base pairs. Nevertheless, the equilibrium distributions in the evolutionary model of PETcofold could be adapted to increase the impact of non-canonical base pairs by using a different training set.

Future improvements can include explicit handling of redundant sequence information. Currently, redundant sequences contribute equally to the scoring to directly reflect the input data instead of overweighting outliers in a dense evolutionary tree. Thus, datasets with highly redundant sequences should be cleaned prior to usage of the program.

Long RNA‚ÄìRNA interactions form helices similar to the DNA double strand (). These helices pose inter- and intra-molecular topological challenges. Due to the turn of the helix (i) the length of the interaction between the two RNAs is constrained and (ii) a certain number of unpaired bases on either side of the interaction are necessary to enable the first enclosing intra-molecular base pair (). In practice, this means that the computational methods can predict longer helices, because the outer bases are complementary, but in the three-dimensional topology these base pairings would be spatially unfeasible. However, taking topological constraints into account would be excessively time costly. Our method, and all other methods capable of genome-scale analysis, work only at the level of secondary structures. However, in the future it would be useful to accommodate this.

In some cases, the hierarchical folding approach predicts RNA‚ÄìRNA interactions with reduced accuracy because the intra-molecular constraints overlap with the interaction sites. In these cases, the interaction site accessibility model of PETcofold is too strict and overestimates the stability of intra-molecular structures. As an example, one of the two OxyS‚ÄìfhlA interaction sites is not predicted because the stem enclosing the second interaction site has a high reliability and, thus, gets constrained. In ), the input alignment consisted of more distant sequences, which reduced the reliability of this stem and made the interaction site accessible. For avoiding too restrictive constraints, we} introduced a parameter Œ≥ when reliable alternative structures exist. It is planned that a future version of PETcofold will take the cost of opening stems into account as, e.g. in RNAup and IntaRNA.

Supplementary Material
Supplementary Data
ACKNOWLEDGEMENTS
We thank Jakob Hull Havgaard for his assistance with the evaluation of the predictions. We further thank Sita Lange and Larry Croft for their comments on the manuscript.

Funding: Lundbeck Foundation (grant 374/06 to J.G.); Danish Research Council for Technology and Production Sciences (grant 274-09-0282 to J.G.); Danish Center for Scientific Computation (J.G.); German Federal Ministry of Education and Research (BMBF grant 0313921 to R.B.); German Research Foundation (DFG grants BA 2168/2-2 and BA 2168/4-1 to R.B.); Excellence Initiative of the German Federal and State Governments (grant EXC 294 to R.B.); Austrian GEN-AU project Bioinformatics Integration Network III (T.G. and Arndt von Haeseler); Wiener Wissenschafts-, Forschungs- and Technologiefonds (WWTF) to the CIBIV Institute (Arndt von Haeseler).

Conflict of Interest: none declared.

