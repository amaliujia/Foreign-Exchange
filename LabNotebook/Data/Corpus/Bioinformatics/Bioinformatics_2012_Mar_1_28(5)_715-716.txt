1 INTRODUCTION
Orthologs are genes from different organisms that descend from a single ancestral gene in the most recent common ancestor (). In comparative genomics, they are used to infer the function of novel genes from the function of well-studied ones, to construct phylogenies and explore the evolution of genes and species, and to study sequence conservation and change. They are also valuable in analyzing gene networks, studying gene gain and loss, and finding genes in model organisms that correspond to human disease genes (; ; ).

Advances in high-throughput genomic sequencing have made it possible to produce many datasets in a relatively short time period. For example, from 2006 to 2011, the number of complete proteomes listed in UniProtKB (), a repository of annotated protein sequences, has increased from around 300 to over 2500. To overcome the engineering challenges of computing and publishing orthologs for such a large number of genomes, we redesigned the comparative genomics tool, Roundup (), to scale with the rate of genome sequencing and to enable increasingly more sophisticated comparative genomics analyses. Roundup 2.0 contains orthology data for over 1800 genomes, providing one of the largest diversities among similar orthology databases (; ; ; ; ; ; ; ; ; ). Roundup compares well to other major databases, with recent studies showing similar ortholog composition for model organisms (; ). The data in Roundup include clusters of orthologs for a wide range of sequence conservation, allowing searches for distant orthologs, and also phylogenetic profiles that enable functional investigation, phylogenetic analysis and prediction of network organization ().

2 ALGORITHMS
We used the reciprocal smallest distance (RSD) () algorithm to infer orthologs. RSD improves the sensitivity of reciprocal best blast hits by considering global alignment and maximum likelihood evolutionary distance between sequences. As a pairwise orthology algorithm, RSD scales quadratically with the number of genomes in Roundup. Altenhoff et al. assessed 10 ortholog inference projects and methods, confirming the reliable performance of RSD over a wide array of genomes from the tree of life ().

For Roundup 2.0, we changed RSD to improve its speed, stability and ortholog inference. We replaced WU-BLAST (W.Gish, personal communication) with NCBI BLAST (). Also, we replaced ClustalW () with Kalign (). Kalign is faster than ClustalW and produces better alignments for more distantly related sequences. This change resulted in 9% closer maximum likelihood distances between orthologs computed using PAML 4.0 (), and 0.3% more orthologs on average. Since the Roundup database stores orthologs for 12 combinations of divergence and E-value thresholds, RSD was modified to compute orthologs for any number of parameter combinations as quickly as for one parameter combination. This change should be of interest to researchers investigating the effect of different parameter settings and degree of global sequence similarity on ortholog inference. With the addition of other caching and file I/O changes, RSD is over six times faster than the previous version in our performance tests.

In addition to housing the orthologs inferred by RSD, Roundup builds clusters of orthologous genes, i.e. ortholog groups, using deterministic single-linkage clustering. It partitions a graph into connected subgraphs by creating a cluster for every gene and then merging two clusters if a gene in one of the clusters is orthologous to a gene in the other one. The result is that every gene in a group is orthologous to at least one other gene in the group and to no genes in any other groups. In contrast to other orthology databases (; ; ), Roundup orthologous groups are built on the fly using genomes selected by the user. This allows users to include exactly their genomes of interest and to explore the effects of including different genomes on the grouping of orthologs.

3 GENOMES AND ORTHOLOGS
The 1807 genomes in Roundup 2.0 are from UniProtKB (), including 226 Eukaryota, 1447 Bacteria, 113 Archaea, 21 Viruses and Viroids. The approximately 63 CPU core-years to compute the orthologs took several weeks on our research computing cluster. Roundup used a fault-tolerant computational pipeline to compute orthologs for all 1 631 721 pairs of genomes across 12 parameter combinations selected to allow researchers access to results for a broad range of divergence and E-value threshold settings. As a result, there are over 11 billion orthologs available in Roundup. The genomes and orthologs are updated 2â€“4 times per year.

4 WEB INTERFACE
The Roundup website provides two ways to search for orthologs. First, the Browse query is a genome-centric search that retrieves all orthologs between one genome and a set of other genomes. Results can be filtered by gene name or gene identifier. To aid users in finding gene identifiers, a FASTA sequence may be used to retrieve a gene id. The second query, Retrieve, returns all orthologs for all pairs of genomes in a set of genomes the user specifies. Query results are then clustered into groups of orthologous genes as described above. All genes in the groups are linked to UniProt and annotated with available gene names and GO Process terms provided by UniProtKB and Gene Ontology (). FASTA sequences for genes in orthologous groups are also provided for further analysis.

In addition to the standard view of search results, there are summaries by GO Terms and by Gene Clusters. The orthologous groups may be downloaded in several formats: NEXUS, PHYLIP, OrthoXML, Phylogenetic Profile and Text. OrthoXML () is provided to support interoperability with other Orthology databases and the quest for orthologs (; ). Query results are cached for up to 30 days and may be retrieved by using the initial URL.

To support research and replication, we make available for download from the website: FASTA sequences for genomes; orthologs in OrthoXML and text formats; and code for RSD and Roundup. Orthologs are also available through an HTTP-based API.

Roundup 2.0 is an important step forward towards keeping pace with the rate of genome sequencing. The features and flexibility of Roundup 2.0, coupled with the wide coverage of genomes, enables increasingly large-scale comparative genomics analyses that address key questions in phylogeny, genome evolution and systems biology.

ACKNOWLEDGEMENTS
Computations were run on the Orchestra cluster supported by the Harvard Medical School Research Information Technology Group.

Funding: National Science Foundation (0543480 and 0640809, to D.P.W); the National Institutes of Health (LM009261, to D.P.W).

Conflict of Interest: none declared.

