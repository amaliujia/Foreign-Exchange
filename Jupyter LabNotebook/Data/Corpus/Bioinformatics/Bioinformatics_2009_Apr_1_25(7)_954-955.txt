1 INTRODUCTION
In the last few years, coupling of chromatin immunoprecipitation with microarray technology (ChIP-on-chip; Ren et al., ) and computational analysis tools has resulted in major leaps in our understanding of transcriptional networks and of the dynamics of chromatin structure (Bock and Lengauer, ). Microarray analysis is a stepwise process which encompasses spot detection in scanned images, normalization of fluorescence intensities within and between arrays, as well as probeset to gene assignment. In the case of ChIP-on-chip (CoC), this process comprises the additional processing of binding events, also known as peak detection. Several CoC analysis software solutions already exist, often adapted for one specific microarray platform. To our knowledge, in the case of Agilent microarrays, only one application suite is currently available: DNA Analytics (http://chem.agilent.com), a licensed program. Here, we introduce a new standalone ChIP-on-chip Analysis Suite (CoCAS) that provides several additional functions, including new normalization options, flexible peak detection, quality control reports, as well as a compilation of replicate samples. CoCAS is free (GPL) software which runs independently on Windows XP/Vista, Mac OSX, Linux and builds upon existing packages in the Java and R programming languages (http://www.r-project.org), notably BioConductor (http://bioconductor.org). CoCAS uses Java as graphical user interface as well as peak detection, and R for the bulk of the calculations.

2 PROCEDURES
As input, CoCAS takes Feature Extraction files (Agilent Technologies) originating from scanner quantification. Microarray files are read in R using BioConductor. Since two-channel normalization methods tend to underestimate enrichment, we made variance stabilization normalization (Huber et al., ) available in our software, as opposed to other Agilent CoC analysis programs. We also adapted, implemented and validated a novel CoC optimized intra-normalization method (Peng et al., ) de novo in R (Supplementary Fig. S1). These methods can now be used along with other traditional intra- and inter-normalization methods: median, loess and quantile (Yang et al., ) (Supplementary Fig. S2). Background subtraction can be carried out using all options limma (Smyth, ) offers in this regard, or disabled. A per-spot P-value is systematically calculated according to the Rosetta error model (Weng et al., ), which can be used for peak detection. Multiple slide designs are handled as separate experiments until inter-array normalization, after which they are merged as one whole experiment. Experimental and/or biological replicates can be merged either using a mean of log ratios, or the Rosetta error model. Peak detection is automatically performed in Java following microarray processing. The peak detection tab can be called from within the main interface at any time for standalone peak detection. The algorithm is based on the neighbourhood effect (Zheng et al., ). Significantly enriched probes are first mapped above a given threshold based on background noise estimation as used by Ringo (Toedling et al., ) or MPeak (Zheng et al., ). Peaks are extended as long as the log ratio of contiguous probes is greater than the extension threshold. A score is given by calculation of the effective peak area.

3 RESULTS AND CONCLUSION
CoCAS features either a simple stepwise wizard with detailed help which facilitates analyses, or a user-parameterized interface allowing more flexibility (an example screenshot of the interface is shown in Supplementary Fig. S3). It can handle large files originating from new high-density microarrays (&gt;1 000 000 probes). Dye swap can be carried out on a selection of slides and replicate correlation plots are displayed. As illustration, we provide genome-wide profiling of Suz12, a subunit of the Polycomb repressor complex, performed in mouse ES cells, and processed with CoCAS ( and Supplementary Material S1). Because Suz12 is located throughout the genome (Boyer et al., ), we applied median normalization in this case. A PDF Quality Control report is generated for global estimation of per-slide enrichment (A–C). Resulting output is written as several generic file formats that are readable on most genome browsers, such as Integrated Genome Browser (IGB), Ensembl (http://ensembl.org) or UCSC genome browser (http://genome.ucsc.edu) (Supplementary Fig. S4), a function supported by most CoC packages, except for the Agilent platform, as of yet (Supplementary Table S1). As expected, our software shows high Suz12 enrichment at the genome-wide scale, notably in the Hox cluster region (D and data not shown). Importantly, the peak detection methods implemented in CoCAS can be used for any set of data (in GFF format), including ChIP-Seq data (Supplementary Fig. S5), where signal processing is similar to that of CoC.
Stepwise data analysis of Suz12 ChIP-on-chip in CoCAS. Quality control reports include (A) density plots of immunoprecipitated (IP) DNA, in red, and Input DNA, in green, so as to detect any dye bias; (B) MA plots which allow assessment of normalization quality and probe enrichment; (C) replicate correlation plots, which also help estimate background noise (which shows no correlation at low intensities). (D) Chromosomal view (chromosome 6) of Suz12 IP over input log ratios (in red) via IGB (top), followed by peak detection (green track) on a close up in the Hox cluster region (bottom).



Funding: Inserm, CNRS, Association pour la Recherche sur le Cancer, Institut National du Cancer, Fondation de France, Association Laurette Fugain, Fondation Princesse Grace de Monaco and Commission of the European Communities (to Ferrier laboratory); Inserm, Université de la Méditerranée and Association pour la Recherche sur le Cancer (to Imbert laboratory); Agence Nationale de la Recherche (ANR-06-BYOS-0006 for collaboration between the two groups and to T.B.); fellowship from Institut National du Cancer (to P.C.); Marie Curie Research Training Network (RTN ‘Chromatin Plasticity’) from the Commission of the European Communities (to F.K.).

Conflict of Interest: none declared.

Supplementary Material
[Supplementary Data]
