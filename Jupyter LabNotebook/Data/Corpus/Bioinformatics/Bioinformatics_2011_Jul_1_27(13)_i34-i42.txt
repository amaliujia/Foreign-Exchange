1 INTRODUCTION
Under optimum conditions, proteins with diverse primary sequence exhibit the ability to self-assemble into structurally varied, but highly ordered Œ≤-sheet aggregates known as amyloid fibrils (). Those forming amyloid under normal physiological conditions can have profound effects on biological systems‚Äîdeleterious and beneficial. On the one hand, amyloids play a role in diseases such as Alzheimer's, Parkinson's and Huntington's, as well as systemic amyloidosis. On the other, they serve vital functions in normal biology such as in human peptide hormone storage, biofilm formation and a mechanism of protein-only inheritance by yeast prions (). However, the generic nature of the fold, the observation that most proteins do not form amyloid under normal conditions and the ability of many amyloids to adopt multiple amyloid structures from the same peptide sequence (structural strains) confounds standard sequence-specific models of protein folding (). Moreover, sequences with only a small likelihood of forming amyloid can remain so given many mutations, or become abundantly amyloidogenic after only a single point change (). Therefore, to better understand the sequence/structure relationship of amyloid fibrils, a meaningful predictive model is required that describes the relationship between a given sequence and its mutational neighborhood.

Countless experimental studies have been performed to probe the molecular mechanism of these enigmatic structures. However, most methods (developed primarily for globular proteins) are difficult to apply to amyloids due to their large size and insolubility. Techniques such as solid-state nuclear magnetic resonance (NMR) spectroscopy and hydrogen-deuterium exchange (H/D-exchange) have brought us the most information about fibril structure, but only through exhaustive work and complex experimental design (; ; ; ; ). The high cost of such studies has prevented the kinds of large-scale investigations that can reveal the underlying sequence/structure relationships in functional and pathogenic amyloid folds.

Seminal work has shown that computational prediction of sequence amyloidogenicity can help guide and speed investigations of amyloid structure (; ; ; ; ). These advances enabled new possibilities for genome-wide studies, such as the discovery of 19 new functioning amyloid proteins in yeast (). More specialized tools (; ) have been further developed that detail the structure of one particular amyloid fibril conformation: ‚Äòsteric zippers‚Äô, a repeated, dry Œ≤-strand/Œ≤-strand packing consisting of a few amino acids (). However, other more elaborate amyloid conformations such as Œ≤-solenoids () cannot be considered by these specialized methods. Unfortunately, while these techniques can generate high-resolution structural predictions, they can only predict structural detail for regions of ~6 to 10 residues at a time due to the assumption of a steric zipper conformation. While such short segments may act as hot spots for amyloid formation, a full-peptide structure prediction cannot be made, which encompasses the size of amyloid sequences found in nature. In the opposite vein, earlier tools are able to predict the amyloidogenicity of sequences of any length, and agnostic to a particular molecular conformation, but unfortunately their structural prediction accuracy can suffer, achieving at best ~40% sensitivity on per-residue Œ≤-sheet location assignment and can exhibit insensitivity to sequence mutation (). Moreover, these tools do not predict complete super-secondary structures, and do not capture the finer details of Œ≤-sheet residue/residue interactions that allow one amyloid conformation to be distinguished from another.

In this article, we develop an algorithm, AmyloidMutants, which predicts amyloid fibril structural conformations, and the sequence mutations that stabilize, reconfigure and de-stabilize each fibril conformation. Like earlier tools, our approach handles full-length amyloid sequences, but greatly improves predictive accuracy by calculating Boltzmann-distributed energetics over only those Œ≤-strand arrangements likely to be found in amyloid fibrils. A statistical mechanical ensemble is constructed that scores a complete family of millions of conformational states and sequence polymorphisms (a ‚Äòmutational landscape‚Äô). A comparison of these sequence/structure states allows for the prediction of likely conformations and the identification of sequence determinants of structural heterogeneity. The goal of our algorithm is thus to efficiently calculate all these possible states, and produce accurate, physically meaningful amyloid fibril predictions.

AmyloidMutants is sensitive enough to distinguish dramatic shifts from one amyloid conformation to another when as little as a single point mutation is made; at the same time, it provides highly accurate predictions of structure, strain conformations and mutant amyloidogenicity. Indeed, in agreement with experimental observations, our tool identifies separate, incompatible amyloid conformations that are preferentially induced by wild-type (WT) AŒ≤ and the AŒ≤ Iowa mutant (), as well as similarly distinct structures resulting from wild-type and yeast-toxic mutant strains of HET-s (). AmyloidMutants also allows us to probe the amyloidogenic relationship between chemically similar residues such as Asn and Gln, which revealed a specific HET-s sequence sensitivity to Asn.

2 APPROACH
We present AmyloidMutants, a web-based tool for predicting the structural and mutational landscapes of amyloid fibrils using an ensemble algorithm. In an ensemble predictor, each peptide sequence is presumed to fold into a complete set of millions (or billions) of unique structural states, with a single energetic value calculated for each state according to its entire conformation (). From this quantified set of all possible structures, clusters of low-energy states with similar conformations can be extracted as predictions of likely real-world structures, with relative probabilities of occurrence. A mutational ensemble predictor simply increases the dimensionality of this set by including sequence variation within each state. (Note, ‚Äòensemble‚Äô predictors differ from consensus predictors; the latter produces a single prediction based on the consensus of multiple authors' algorithms.)

The definition of an amyloid fibril ‚Äòstate‚Äô greatly impacts the accuracy of an ensemble predictor: including atomic details would result in an intractable computation, while high-level representations that work in 1D sequence space can miss important steric and energetic details. To capture critical 3D elements while retaining efficiency, we choose to model super-secondary structural information‚Äîeach state contains a sequence and a unique set of residue/residue Œ≤-strand backbone interaction pairs. But even so, calculating the energy of all mathematically possible interactions would introduce an exponential number of states as a function of sequence length.

We introduce ‚Äòschemas‚Äô as an algorithmic construct to solve this by partitioning fibrillar from non-fibrillar conformations, enforcing steric consistency and enabling energetic calculations over all amyloid fibril sequence/structure states. For efficiency and usability purposes, putative amyloid fibril states are separated into three largely distinct topology families: schemas ùí´, ùíú and ùíÆ, which to our knowledge, together subsume the variation found in most published experimental and hypothetical amyloid fibril structure models (). These schemas also account for sequence variation through a simple user specification of the mutational possibilities that should be explored: e.g. ‚Äòall Val can mutate to Ala, Leu, or Ile‚Äô. For example, schema ùí´ and ùíú describes an abstract ‚ÄòŒ≤-solenoid‚Äù encompassing millions of structures with unique residue/residue interactions and varying numbers of Œ≤-strands, Œ≤-rungs, Œ≤-sheet width, coil location, residue orientation and residue packing neighbors (for example, HET-s ùíú predictions in  calculate the energy of ~4 billions states). Specific 2-, 3- and 4-sheet Œ≤-helix-like structures are accounted for by the introduction of ‚Äòkinks‚Äô (). Similarly, schema ùíÆ represents millions of possible full-length peptide ‚Äòserpentine‚Äô conformations, putatively containing multiple steric zipper interfaces.
Amyloid fibril schemas used for analysis. Amyloid fibril schemas, diagrammed from side and top perspectives. Red indicates a single fibril peptide flanked by two gray adjacent peptides along the fibril axis. (a) Schema ùí´, a 2-sheet Œ≤-solenoid with unrestricted number of rungs per peptide and parallel intra- and interchain interactions. (b) Schema ùíú, identical to ùí´ except with antiparallel interchain interactions. (c) Schema ùíÆ, a serpentine cross-Œ≤ structure with unrestricted number of packed intrachain Œ≤-sheets. All Œ≤-strand hydrogen bonds formed interchain.


Œ≤-strand ‚Äòkinks‚Äô extend schemas in  to allow AmyloidMutants to model sharp Œ≤-sheet turns like those found in Œ≤-solenoids. Kink represents a deviation in the standard Œ≤-sheet in/out residue sidechain orientation.



Conceptually, each schema ‚Äòshape‚Äô can be thought to resemble the ‚Äòarchitecture‚Äô level of CATH () protein structure classification: for example, schema ùí´ resembles the ‚Äò2-solenoid‚Äô and ‚Äò3-solenoid‚Äô classifications that make up 2 out of the 20 ‚Äòmainly-beta‚Äô architectures in all proteins in CATH. We note that schemas should not be confused with threading templates used in other protein and amyloid modeling tools (): threading tools fix a peptide backbone to a specific atomistic position and computationally score the effects of residue-specific side chains, whereas schemas cover a wide range of amyloid conformation and peptide backbone arrangements in 3D space. Further, AmyloidMutants does not predict kinetics of amyloid formation, but simply the set of possible conformations at steady-state encompassing arbitrary environment conditions. No restrictions are placed on the location or size of structural elements with the exception of individual Œ≤-strand lengths, which is fixed to a range of 6‚Äì12 residues for efficiency purposes, and can vary within a single structure (except when noted in  of Supplementary Material).

3 METHODS
3.1 Calculating amyloid ensembles
AmyloidMutants models the structural effects of sequence variation by conceptually scoring all possible amyloid fibril conformations that any sequence (and its mutants) can attain. Using a statistical mechanical approach, all structures are members of a canonical ensemble, with each state's energetic value assigned according to a Boltzmann distribution. Such an ensemble predictor differs fundamentally from existing techniques that perform an algorithmic search for an individual, lowest energy structure state. However, computing the score of all possible states in atomistic detail is considered computationally intractable (), so our approach uses a philosophy of domain restriction (via schemas) to efficiently predict accurate, physically meaningful amyloid structures at the level of super-secondary structure. The utility of such an approach has been demonstrated in RNA (; ); however, protein structures are too complex to tractably apply their same methods.

At the core of our framework lies the ability to compute the Boltzmann partition function (ùíµ) for given protein sequences. This thermodynamic normalization constant encodes the statistical variation of a system in equilibrium, and is used to identify the significance of structures within an ensemble. ùíµ is defined by the sum: ‚àÄs,¬†ùíµ=‚àëse‚àíEs/R T, given temperature T, the physical constant R and a Boltzmann-distributed energy score Es for every conformation s within the ensemble. AmyloidMutants extends the notion of a structural ensembles to analyze protein sequence/structure ensembles, redefining the partition function ùíµ as: ‚àÄœâ,¬†‚àÄs, ùíµ=‚àëœâ‚àëse‚àíEs/R T, given sequences œâ and structures s. This encodes statistical variations in protein structure as well as sequence, distributed according to the energetic likelihood of that sequence's conformations. With this, one can identify energetically favorable sequence/structure assignments and quantitatively measure the energetic difference of between states.

AmyloidMutants is implemented using C++, with modular templates describing the recursively enumerable sequence and structure space. An analysis is performed on the sequence input to optimize the search across sequence/structure states, and a dynamic programming procedure is constructed that traverses and scores all possible states, tabulating these values. From this, ùíµ can be calculated via a simple traversal.

3.2 Amyloid schema definition
Schemas are generative rules restricting the exponential set of peptide conformations to only those that form amyloid fibrils. These are defined in two parts, a recursive encoding of structure space and a protocol giving a list of all allowed sequence mutations. To model a theoretically endless fibril we employ a concept of symmetry, representing an amyloid as the conformation of single peptide combined with two sets of inter-peptide Œ≤-sheet interactions up and down the axis. We detail here specific characteristics used to define a schema, beyond the qualitative description in .

Structure space is defined as putative geometric arrangement of Œ≤-sheets at the resolution of (i) intrapeptide hydrogen bonds along the fibril axis; (ii) Œ≤-sheet/Œ≤-sheet packing perpendicular to the axis (e.g. steric-zipper packings, etc.); and (iii) peptide/peptide symmetry describing interpeptide hydrogen bonds. Residue side chain orientations are also included in the model to indicate inward (hydrophobically packed) and outward (solvent exposed) states. Thus, a single structure can tell you whether a residue is in a Œ≤-sheet or coil, its orientation, which other residue(s) it forms a hydrogen bonding pair with and which topologically specific Œ≤-sheet its found in, indicating other Œ≤-sheets it may pack against. Finally, Œ≤-strand ‚Äòkinks‚Äô model two successive Œ≤-strand residues that have the same side-chain orientation (). Modeling kinks allows more precise energetic parameters when two sequentially adjacent Œ≤-strands form a sharp turn (as in many Œ≤-helices), since these junctions differ from coil-separated Œ≤-strands.

Sequence space is defined by a set of allowed mutations off a base sequence, per sequence position, per residue. For example, ‚Äòposition index 10 can either be Ala, Leu, or Val,‚Äô input via programmable macros. This level of specification is required to avoid an exponential computation, as there are 20N residue permutations in a sequence of length N. At runtime, an analysis is performed to determine the minimum dynamic programming table dimension required to fit each possible mutation. Presently, deletion and insertion mutations are not supported due to limitations of the energy models.

Although not used for results in this article, schemas can be further refined to incorporate specific point knowledge into the ensemble, enabling a more profitable, iterative back-and-forth between predictions and experimentation. These refinements include: (i) limiting Œ≤-strand or coil length; (ii) enabling or disabling Œ≤-sheet ‚Äòkinks‚Äô; (iii) requiring a minimum/maximum total-fibril Œ≤-sheet concentration; (iv) enabling or disabling fibril twist; (v) permitting N- and C-terminal coil asymmetries; and (vi) allowing user-defined residue/residue hydrogen bond contacts to be fixed.

3.3 Energy model for amyloid-like interaction
AmyloidMutants uses a potential energy scoring function derived from observing the frequency of specific residue/residue interactions in (non-sequence-homologous) PDB () protein structures. Many protein and RNA modeling tools (; ; ; ) have successfully used such statistical potentials because of two main advantages: (i) residue/residue interactions (or base pairs in RNA) can efficiently capture the important, energetically stabilizing features of 3D structure without the need of molecular detail, and (ii) constructing an energetic scoring function from known PDB structures does not require a priori expert information, so as new structures are solved, typically accuracy increases. Note, such statistical potentials do not incorporate environmental conditions such as pH.

Traditional pairwise contact models calculate the frequency with which residues pair within a Œ≤-sheet (; ). AmyloidMutants extends this by conditioning each probability by the local 3D environment, including amphipathicity and solvent accessibility, Œ≤-strand edge proximity, residue-stacking ladders, Œ≤-sheet edges and Œ≤-sheet twist [e.g. p(i|j,env)], discretizing higher resolution information important to amyloid structure. Accordingly, each residue position in every possible ensemble state has an associated environment that allows the search procedure to apply the correct energy. For example, residues/residue pairs facing toward the center of the Œ≤-solenoid in schemas ùí´ and ùíú would be considered solvent inaccessible. These Œ≤-sheet potentials are combined and scaled with potentials for consecutive coil residues (p(i,j)), as well as an optional hydropathic packing score describing the propensity for Œ≤-sheet faces to pack against one another (). There is no explicit cost for the act of mutation, merely an energetic change due to a new sequence ( of Supplementary Material). The algorithm supports additional types of potentials, such as position-specific scoring matrices, stacked residue-pairs (), and chemical propensities (), although these are not used here.

Formally, a fibril's energy is decomposed into independent substructure energy scores that recombine according to the schema topology. The energy of each state s is defined to be Es=‚àíRTlog(ps)-RTlog(ùíµ), and we make the assumption that Es can be linearly decomposed into i parts such that Es=‚àëi‚àíRTlog(psi)‚àíRTlog(ùíµ) (). The probability psk thus represents the likelihood of observing a substructural state k, such as the propensity for two residues to pair within a Œ≤-sheet, and log(ùíµ) serves as a statistical centering constant. Predicted states represent steady-state conditions and do not reflect folding kinetics.

3.4 Sampling and stochastic contact maps
The principal output of AmyloidMutants is a sampled set of unique sequence/structure states (a list of sequences and their corresponding conformations) that is statistically representative of the full ensemble. Prior work has demonstrated the higher predictive accuracy of ensemble sampling over minimum energy structures (). To achieve this, a sampling procedure performs an energetically weighted stochastic backtrack over subsequence/substructure scores generated when computing ùíµ. Populations of similar structures are separated via PAM clustering, taking as input the number of clusters, and using a distance metric that optionally combines sequence, secondary structure, energy score, hydrogen bond registration, coil location and Œ≤-strand overlap. A mediod is selected to represent each cluster. User-definable distance metric changes allow for independent analysis of specific structural or sequential features.

Another form of output, the stochastic contact map, describes the Boltzmann-weighted likelihood pi,j that any two residues i and j will form a Œ≤-sheet hydrogen bond, given all the conformations in the ensemble. To remove schema bias, the null hypothesis probability of any residue i and j forming a bond is subtracted from pi,j ( of Supplementary Material). This allows AmyloidMutants to identify small Œ≤-strand interaction motifs within the ensemble that may be hard to discern from full conformation sampling. Furthermore, contact maps scores can be used to predict structural properties such as X-ray crystallography B-values ().

4 RESULTS
4.1 Secondary and super-secondary structure prediction
Even in the absence of mutation predictions, AmyloidMutants offers the the highest structure prediction accuracy to date. We demonstrate this by comparing predictions against experimental data for five of the best studied WT amyloid proteins: AŒ≤ (; ) (39-42aa), HET-s () (73aa), amylin (; ) (37aa), Œ±-synuclein (; ) (140aa) and tau (; ) (htau40, 441aa). This set covers pathogenic and functional amyloids found in nature for which there are a number of published structural experiments, including NMR secondary structure chemical shift and H/D exchange data. The ability to accurately predict the structure of such peptides could potentially help elucidate how native amyloid-related processes (such as biofilm formation) impact cellular function, and allow for targeted experimentation.

For these five proteins, AmyloidMutants correctly identifies experimentally observed Œ≤-sheet regions in 21 of 22 cases (, )‚Äîa per-residue secondary-structure classification sensitivity/specificity of 82%/95% and an average SOV score of 82 (). Using the same comparison, the best of the available full-length amyloid prediction tools (; ; ; ; ) produced a classification sensitivity/specificity of 42%/90% (Zyggregator) (). Per-residue Œ≤-sheet classification is used for this comparison since it can be inferred as a common output of all tools; however, AmyloidMutants can provide more rich predictions including super-secondary residue/residue interactions. Therefore, a detailed analysis of each protein's predictions is given to demonstrate these added benefits, along with a demonstration of how ensemble predictions can help identify alternate fibril conformations in agreement with published experimental data.
AmyloidMutants per-residue Œ≤-strand assignments indicate amyloid core regions, comparable with existing per-residue amyloidogenicity predictors. AmyloidMutants predictions (green) outperform those tools available for testing when using their default settings and thresholds. BETASCAN (gold) (), ZYGGREGATOR (blue) (), TANGO (cyan) (), PASTA (red) () and Waltz (purple) (), when compared against experimental structure models supported by NMR, H/D-exchange and mutational analysis (black) (; ; ; ; , ). Note, the BETASCAN, ZYGGREGATOR, TANGO and PASTA tools most closely match our tool's ability to predict full-length per-residue amyloidogenicity, whereas Waltz aims to predict short hots pots that could specifically adopt a steric zipper.


Summary of secondary-structure prediction results

	AŒ≤	HET-s	Amylin	Œ±-syn	Tau	
Sequence length	42	73	37	140	441	
Correct Œ≤-regions	2 of 2	4 of 4	3 of 3	5 of 5	7 of 8	
False-positive Œ≤-regions	0	0	0	2	2	
Percent sensitive/specificity	100/100	95/95	70/91	81/95	68/95	
SOV measure	100	90	97	62	62	



AmyloidMutants was run on each sequence for all three schemas ùí´, ùíú and ùíÆ, with the schema that agreed best presented. An ensemble was calculated, and conformations were sampled and clustered, with the mediod structures reported ( of Supplementary Material). Although rough computational tests can be applied to evaluate the schema fitness ( of Supplementary Material), in a typical real-world scenario (and what has been applied thus far), an uncharacterized amyloid sequence is predicted using all schemas, and results are compared against the body of existing experimental data or used to guide further disambiguating experimentation.

Note, although atomic-resolution steric zipper structures have been solved for many short (~4 to 10aa) synthetic peptides (; ), AmyloidMutants predictions on such short peptides are trivial. Schemas can predict the position and arrangement of steric zipper sites throughout a full-length peptide, but are not designed to distinguish side-chain rotamers (and are unrelated to steric zipper classes).

Amyloid Beta (AŒ≤): an ensemble analysis of AŒ≤ is particularly poignant as it has many known isoforms (AŒ≤1-40, AŒ≤1-42, AŒ≤1-40/D23N, AŒ≤1-40/E22Q, etc.) and subsequences (AŒ≤16-22, AŒ≤11-25, etc.) that have been reported to form a diverse range of fibril structures, including strain polymorphisms within the same sequence (). Our tool predicts the experimentally observed structure of two possible AŒ≤ conformations, recapitulating two distinct experimental models of the peptide based on NMR, H/D-exchange and mutational analysis (; ). After clustering, the highest likelihood mediod structure nearly identically matches the latter of these two models () (a), including Œ≤-strand positions, interior/exterior side chain orientation and the inter peptide parallel hydrogen bonding registration. This cluster accounts for 55% of the ensemble. Interestingly, the second highest likelihood mediod exhibits a clear shift in one of the Œ≤-strand regions and aligns very closely with the earlier NMR model (). This cluster is more heterogeneous, including many other structural arrangements, and accounts for 39% of the ensemble. Furthermore, recent experimental studies of AŒ≤ conformational variation have shown that fibrils formed under quiescence and agitation differ, for instance, in the assignment of position 15 to Œ≤-strand (). The predicted clusters also make this rough distinction: the larger cluster does not contain a Œ≤-strand at position 15, while the smaller does. Moreover, brain-seeded fibrils have exhibited spatial proximity between residues F19/I31, whereas unseeded in vitro fibrils do not (). AmyloidMutants also predicts such a divergence: in 16% of the ensemble, F19 and I31 are both oriented toward the center of the fibril, enabling proximal contact.  of Supplementary Material provides further detail.
AmyloidMutants structure predictions match experimentally observed Œ≤-strand interactions of AŒ≤1-42 (a), HET-s (b), amylin (c), Œ±-synuclein (d) and tau (e). (a) Diagram depicts AŒ≤1-42 Œ≤-strand in gray, residues in blue (with in/out orientation) and Œ≤-sheet/Œ≤-sheet packing as one Œ≤-strand above another, packed residues facing center. Predicted structure (green arrows) mirrors NMR structure () (black arrows), including most packing orientations. Predicted kink occurs because schema does not account for known D23/K28 salt bridge. (b) Similar depiction of HET-s prediction (top, green arrows) compared with NMR model () (bottom, black arrows) shows near identical match, including residue orientations and kink location. (c) Top two amylin predictions (solid, striped green arrows) align well to NMR model () (black arrows). Predictions differ only by their inclusion of Phe23 (*) within Œ≤-sheet, a residue experimentally shown to form non-Œ≤-sheet interpeptide interactions not considered by schema. (d) Top two Œ±-synuclein predictions (i,ii) agree very well with H/D exchange data (iii,iv) and NMR model (v) (; ). (e) Tau predictions identify 7/8 Œ≤-regions observed experimentally (). The highest AmyloidMutants scores (red boxes) specifically identify regions 274‚Äì279 and 305‚Äì310, positions believed crucial to fibril nucleation ().



HET-s: the 73 amino acid Podospora anserina HET-s prion is the most complex amyloid whose atomic-level 3D structure has been solved (), forming a well-ordered Œ≤-helix with two rungs per chain and four Œ≤-sheets that are more appropriately modeled as two pairs of Œ≤-sheets separated by a kink in the standard ‚Äòin/out‚Äô residue orientation. AmyloidMutants strongly predicts two possible structures, the most likely of which forms a two-rung Œ≤-solenoid that almost exactly mirrors the NMR model, including hydrogen bond registration, side chain orientation and kink location (b, accounting for 68% of the ensemble). The lower likelihood conformation incorporates only a single rung, matching one of the rungs in the NMR structure. This strong predictive bias toward only two possible structures may relate to the observed conformational homogeneity of HET-s fibrils. Achieving such high accuracy on this difficult Œ≤-structural topology supports our tool's use for mutational analysis across broadly different fibril types. Furthermore, recent experimental studies have partially characterized a distant homologue to P.anserina HET-s found in Fusarium graminearum (). Although FgHET-s exhibits only 38% sequence similarity, solid-state NMR and H/D-exchange data suggest an extremely similar Œ≤-solenoidal structure as in PaHET-s. Despite the large difference in sequence, predictions very well match the FgHET-s structural model, aligning Œ≤-strand location, hydrogen-bond registration, side-chain orientation and kink location (Supplemantary Fig. S1).

Amylin: AmyloidMutants predictions for human amylin indicate two viable conformations: a 2-sheet Œ≤-solenoid forms 80% of the ensemble and agrees closely with NMR and microscopy results () (c); and a much less likely three-sheet serpentine model that aligns almost perfectly with an older model of amylin structure (). Interestingly, the experimental model identifies an interprotofibril interaction between Phe23 and Tyr37‚Äîsomething beyond the scope of our schema. However, our Œ≤-solenoid predictions clearly separate into two distinct populations, one incorporating Phe23 into a Œ≤-sheet and one that does not. This highlights the importance of an ensemble analysis: the existence of high-likelihood alternate structures may draw attention to an overlooked structural interaction.

Œ±-Synuclein: five Œ≤-sheet regions in Œ±-synuclein have been identified through substantial experimental effort (; ). AmyloidMutants ensemble predictions agree extremely well with these results, aligning all five Œ≤-sheet regions, and identifying other important experimental observations such as a Œ≤-sheet break around residues 67‚Äì68 (d). One of the predicted clusters does produce a false positive, however, identifying amphipathic Œ≤-strands in the N-terminal region, a disordered segment thought to favor a lipid-binding amphipathic Œ±-helical structure ( of Supplementary Material).

Tau(œÑ): NMR studies have shown this 441 amino acid long amyloid to form a mixture of up to eight transient Œ≤-sheet regions (), with two specific Œ≤-strands necessary for fibril assembly () (positions 306‚Äì311 and 275‚Äì280). Predicted Œ≤-sheets align very closely with these observed regions in seven of eight cases. Moreover, AmyloidMutants identifies the two hexapeptides experimentally observed necessary for assembly by predicting their Œ≤-strand interactions as having the strongest score ( of Supplementary Material). Four false positive regions are predicted to contain Œ≤-strands, although similar to Œ±-synuclein, two overlap with observed Œ±-helices which the schema does not incorporate and may contain sequences with high Œ≤-sheet propensity. Overall, the sensitivity and specificity of our predictions over such a long sequence considerably advance the state of the art ().

4.2 Prediction of a conformational switch in AŒ≤ and HET-s mutants
AmyloidMutants is uniquely capable of identifying change in amyloid fibril conformation from one amyloid Œ≤-sheet topology to another. This distinction from tools that predict general amyloidogenicity is important as a structural change from one amyloid form to another can have a dramatic impact on oligomerization and nucleation rates (), disease infectivity (), and prion propagation (). We have used this ability to identify potential alternate, distinct amyloid fibril conformations that arise in the AŒ≤ familial ‚ÄòIowa‚Äô mutation () and yeast-toxic mutants of HET-s (; ) (details and comment provided in  and  of Supplementary Material). Described below are these AmyloidMutants results, highlighting consistencies with published experimental data.

AŒ≤ Iowa mutant: recent studies () suggest that AŒ≤1-40/D23N may form an antiparallel Œ≤-strand fibril conformation that differs completely from known experimental models (; ). This work suggests an antiparallel Œ≤-sheet around residues 16‚Äì22 (with unknown length), with an interŒ≤-strand interface such that L17 bonds to A21 [designated ‚Äò17+k‚Üî21‚àík‚Äô registry ()]. Similarly, a second antiparallel Œ≤-sheet likely exists around positions 30‚Äì36, with L34 and F19 in close contact. Interestingly, this specific AŒ≤1‚àí40 registry has only previously been seen in the peptide fragment AŒ≤16‚àí22, which lacks D23 (), while the antiparallel forming fragment AŒ≤11‚àí25 shows inverted ‚Äò17+k‚Üî22‚àík‚Äô and ‚Äò17+k‚Üî20‚àík‚Äô registries () ().
AmyloidMutants predictions reveal conformational switch between AŒ≤1‚àí40 and AŒ≤1‚àí40/D23N in agreement with published data

	
Predictions show a significant change in the conformational landscapes of AŒ≤1‚àí40 and AŒ≤1‚àí40/D23N in agreement with published experimental evidence () of an antiparallel, ‚Äò17+k‚Üî21-k‚Äô registry Œ≤-sheet in AŒ≤1‚àí40/D23N (boldface). Sampled ensemble structures were classified into one of three categories of Œ≤-sheet registry, with the percent makeup of each provided. Œ≤-sheet registry is classified by residue/residue pairing, depicted with X highlighting position 23. Check marks indicate experimentally observed registrations in AŒ≤11‚àí25 () and AŒ≤16‚àí22 ().




To analyze this point mutant, we predicted ensembles for AŒ≤1‚àí40 and AŒ≤1‚àí40/D23N using schema ùíú (which allows antiparallel inter-peptide interactions). Detailed in , AmyloidMutants' AŒ≤1‚àí40/D23N predictions strongly preferred a ‚Äò17+k‚Üî21‚àík‚Äô registry conformation, with predicted contacts between L34/F19, and very little variation within the ensemble. This arrangement agrees with observed AŒ≤16‚àí22 structures. Conversely, predictions for WT AŒ≤1‚àí40 are quite heterogeneous, although with the largest cluster of structures forming ‚Äò17+k‚Üî22‚àík‚Äô registry, in agreement with observed AŒ≤11‚àí25 structure. More strikingly, the ‚Äò17+k‚Üî21‚àík‚Äô registry conformation favored by AŒ≤1‚Äì40/D23N appears to be strongly disfavored by AŒ≤1‚àí40 (and AŒ≤1‚àí‚àí40/D23N appears to disfavor ‚Äò17+k‚Üî22‚àík‚Äô registry). These predictions and the divergence in ensemble makeup between AŒ≤1‚àí40 and AŒ≤1‚àí40/D23N strongly supports the idea that the D23N mutation results in a singular energetically favorable conformational rearrangement from parallel Œ≤-sheets (in WT) to antiparallel Œ≤-sheets (in the D23N mutation). At the residue level, the adoption of this ‚Äò17+k‚Üî21‚àík‚Äô conformation may be driven by both the alignment of oppositely charged K16 and E22 and the stacking arrangement of Q15 and N23 ().

HET-s yeast-toxic mutants: our technique is able to further predict putative conformational rearrangements between a set of HET-s mutants shown to exhibit toxicity in yeast. In recent studies (; ), structural differences were found in a toxic HET-s mutant (named m8) and compared against four other non-toxic mutants (m3, m4, m9, m11) and WT. Notably, m8 exhibits a marked change from WT in secondary structure makeup, showing a shift of approximately half of the Œ≤-strand structure from parallel to antiparallel interactions.

AmyloidMutants can distinguish these phenotypically different mutants by inspecting predicted results using different schemas and comparing the relative structural heterogeneity of the ensembles. We premise that sequence mutants which significantly alter the predicted ensemble makeup (away from WT) are more likely to exhibit a different high-level conformational arrangement, and that high-likelihood conformations within an ensemble offer good predictive fits. Conversely, predictions that do not particularly favor any single conformation may suggest a poor fit.  reports ensemble predictions for the given six mutants, comparing schemas ùí´ and ùíú. Across all mutants, schema ùí´ predict clusters of 2-rung and 1-rung structures, while schema ùíú predicts three clusters: two forms of 2-rung solenoids and one with 1-rung (Supplementary Fig. S11).
AmyloidMutants ensemble predictions of HET-s sequence variants reveal the yeast-toxic mutant m8 to be unique

Schema/class.	WT	m4	m8	m3	m9	m11	
ùí´ 2-rung (%)	75	95	72	13	49	55	
ùí´ 1-rung (%)	25	5	28	87	51	45	
	
ùíú 2-rung-A (%)	45	42	81	44	56	50	
ùíú 2-rung-B (%)	25	43	0	36	22	40	
ùíú 1-rung (%)	30	15	19	20	22	10	
	
Aggregation	Ring	Foci	Foci	diff.	diff.	diff.	
Toxicity	‚Äì	Minor	Severe	‚Äì	‚Äì	‚Äì	
Ensemble conformational landscape predictions of six HET-s variants produced two general structure classifications for schema ùí´ and three general classifications for schema ùíú (rows, relative percent makeup given). While other mutants do not favor one particular schema ùíú structure, the yeast-toxic mutant m8 exhibits a strong energetic bias for ùíú 2-rung-A. The differences in structure bias shown may suggest an increased likelihood that m8 adopts an antiparallel conformation (boldface). Observed phenotypic differences between mutants are summarized at the bottom ().




The difference between schemas ùí´ 2-rung and ùíú 2-rung correlates with the shift in secondary structure makeup observed ‚Äî ùí´ 2-rung contains only parallel Œ≤-sheet structures while ùíú 2-rung can contain an equal amount of parallel and antiparallel Œ≤-sheet structure. Under schema ùí´, we see that WT, m4, and m8 form better 2-rung solenoids than a 1-rung solenoid, whereas with m3, m9, and m11, the opposite is true or no preference is apparent. This discrimination of mutants based on the structural landscape mirrors phenotypic variation seen by GFP-tagged aggregates () (independent of predictive accuracy). Under schema ùíú, we see similarities between the structural distribution of WT, m4, m3, m9, and m11; however, the toxic m8 mutant appears to strongly prefer only one of the 2-rung conformations. Such a dramatic shift in the predicted ensemble could suggest that the m8 mutant is energetically inclined to form the structure in cluster ùíú 2-rung-A.

4.3 Identification of preferential Asn amyloidogenicity over Gln in HET-s
Beyond its ability to discriminate amyloid fibril structure states, AmyloidMutants accurately models more coarse amyloidogenicity properties, allowing us to study a more fundamental question: the role chemically similar residues Asn and Gln play in fibril structure. Given the high propensity of Q/N-rich peptides to form amyloid (), the amyloidogenic potential of Asn and Gln has often been considered equal‚Äîhowever, recent evidence suggests that N-rich proteins may have a slightly higher tendency to form amyloid () [even though Gln mutations can improve stability ()]. We study this question by considering the effect of four ladder-forming asparagine residues in P.anserina HET-s (positions 226, 243, 262 and 279) which are believed important for fibril stabilization (), and whose regions are conserved in a F.graminearum homolog. AmyloidMutants sequence/structure landscapes were calculated permitting these four residues to mutate to Gln (‚ÄòHET-s/4N‚ÜíQ‚Äô), and the likelihood and corresponding energetic weight of each sequence within the ensemble was compared. The WT HET-s sequence was much more energetically favorable than HET-s/4N‚ÜíQ, comprising ~96% of the ensemble, suggesting a greatly reduced ability of HET-s/4N‚ÜíQ to form fibrils, and a putatively higher amyloidogenic potential of Asn over Gln. Stochastic contact map predictions further illustrate this difference between sequences (Supplementary Fig. S9).

We tested these predictions experimentally, using purified recombinant WT and 4N‚ÜíQ HET-s proteins ( of Supplementary Material). Denatured proteins were diluted into a physiological buffer and allowed to form amyloid. While the WT protein readily did so, as detected by the retention of detergent-insoluble aggregates on a non-binding membrane, the mutant protein was recalcitrant to amyloid formation ().
HET-s/4N‚ÜíQ is defective for amyloid assembly. Purified proteins were filtered through a non-binding membrane either before or after incubation for 24 h in a physiological buffer. Protein aggregates that formed during the incubation are retained on the surface of the membrane, as visualized by Ponceau-S staining.



4.4 Mutational landscapes predict experimental amyloidogenicity
AmyloidMutants' ability to accurately predict amyloidogenicity is validated by comparing our results against a large number of experimentally characterized amyloid mutants. This includes an analysis of the 289-residue HET-s/HET-S natural homologs found in P.anserina, a combination of three AŒ≤ scanning mutagenesis studies, and a set of 74 synthetic mutants of AŒ≤ created by random mutagenesis. The amyloidogenicity of each mutation is predicted by computing a joint mutational landscape over WT and mutant sequences, and quantifying which sequence more readily forms amyloid according to its energetic weight within the ensemble. For example, if WT sequence/structure states occupy 90% of the ensemble, then any specified mutations are likely to result in a less amyloidogenic peptide (Supplementary Text Section 3).

HET-s/HET-S: In P.anserina, the HET-s allele forms an amyloid conformation in its prion form, while the HET-S allele does not, despite differing by only three residues in the amyloid-forming 72-residue C-terminus, and 13 overall (). Predicting the joint HET-s/HET-S mutational landscape, AmyloidMutants found that ~72% of the ensemble favored HET-s, indicating that it is more amyloidogenic than HET-S. Although N-terminal mutations can induce a prion state in HET-S (), our predictions suggests a sequence bias in HET-s permitting a more energetically favorable path for amyloid formation.

AŒ≤ single-point proline mutagenesis: scanning mutagenesis studies have been performed on AŒ≤40 to detect the sequence position effect of proline-, alanine- and cysteine-replacement on amyloid fibril formation, measured by WT/mutant ŒîŒîG (; , ). Although P, A and C-replacement ŒîŒîG values are difficult to interpret independently [due to experimental structural heterogeneity ()], they support the broader conclusion that AŒ≤40 positions 18‚Äì21, 25‚Äì26 and 32‚Äì33 are particularly sensitive to P-replacement (). AmyloidMutants' predictions of the joint mutational landscape for individual proline replacements identified positions 16‚Äì25 and 31‚Äì35 as particularly disruptive in agreement with these studies. Supplementary Figure S12 plots this agreement along with similar predictions by TANGO and Zyggregator, although a direct one-to-one comparison between predictions and ŒîŒîG values would be inappropriate.

AŒ≤ multiple-residue mutagenesis: AmyloidMutants predictions were also performed on a set of 74 AŒ≤ mutants (, ; ) whose relative aggregation levels were observed by GFP fluorescence relative to WT. AmyloidMutants accurately identifies which mutants form amyloid more (or less) readily than WT in 81% of sequences (60 of 74, Supplementary Fig. S8). AmyloidMutants' performance on such a large set further supports its general applicability.

5 DISCUSSION
AmyloidMutants provides the highest accuracy prediction to date of the full fibril structure of amyloid sequences, but its greater value is its unique ability to discover which mutations effect a change in amyloid structure(s), to predict what that structure is and to assign meaningful energetic weights comparing mutant conformations. This accuracy is due, in part, to the ability to model coarse, higher dimension spatial interactions, beyond simpler 1D sequence motifs. This is an important distinction from amyloidogenicity predictors that identify structurally homogeneous peptide sequences (). While the latter can be helpful during an initial screen (searching for amyloid steric zippers in particular), AmyloidMutants can predict and provide insight into the full-length structure () and residue/residue interactions of both Œ≤-solenoidal and serpentine steric zipper fibrils (), putatively identifying interactions critical to function or pathogenicity. Further, through the use of Boltzmann ensembles, our model of sequence/structure space is the only amyloid modeling tool that captures fibril structure variation and Œ≤-contact structural topology changes that may arise in in vivo.

The exploration of mutational landscapes is an important step in understanding differences between amyloid topologies, how mutational variants arise in the wild, and to elucidate evolutionary relationships between related amyloid proteins. This capability depends on AmyloidMutants' novel thermodynamic characterization of all points within a mutational landscape, and is necessary for the discovery of non-additive functional relationships between sequences and conformational epistasis (). Further, we note that our tool provides additional features for experimentalists (not used in this article) that allows extra-sequential experimental data to be incorporated into the predictor (Supplementary Text Section 1)‚Äîas much or as little a priori knowledge as desired, enabling a new tactic for iterative tool re-use.

At face value, the ability of most proteins to form a characteristic cross-Œ≤-sheet amyloid structure in vitro () seems at odds with the relatively small number of amyloid-forming proteins that have been identified in vivo, and the apparently high sequence dependence some amyloids show when compared against sequence homologs. Moreover, the existence of both beneficial functional amyloid sequences, and putatively pathogenic ‚Äòmisfolded‚Äô amyloid proteins suggests a more complicated sequence/structure relationship than is found in standard protein folding models. The power to accurately predict amyloid structure from sequence, and to fully characterize the amyloidogenicity of an entire mutational landscape provides insight into this problem by identifying recurring sequence motifs, coarse 3D residue arrangements and putative mutational pathways linking the sequences of known amyloid structures. The immediate impact of this could improve our ability to identify amyloid structures from genomic data alone, to better understand familial mutations that intensify pathogenesis in diseases such as Alzheimer's, to predict the interaction strength of fibril regions that may be involved in nucleation and to enable targeted peptide design to alter fibril structure or inhibit fibril formation.

Funding: NIH grant (1R01GM081871 and GM25874, in part).

Conflict of Interest: none declared.

Supplementary Material
Supplementary Data
