1 INTRODUCTION
With ever decreasing costs of DNA sequencing and increasingly sophisticated analyses, the number of loci used in population genetic, phylogeographic and phylogenetic studies increases steadily. Only a few years ago it was normal to base the conclusions of experimental population genetic studies on the analysis of a single gene (Filatov and Charlesworth, ), while these days it is not uncommon to use hundreds of loci (or more) in a single study (Begun et al., ; Foxe et al., ). With the advent of high throughput sequencing the use of hundreds of loci will become the norm even for non-model organisms within a few years.

Many population genetic programs, such as IMa (Hey and Nielsen, ), Structure (Pritchard et al., ) or Compute (Thornton, ) use multiple genes for analysis, however, preparation of such datasets, even with sequences in hand, is far from straightforward. Although there are ways to manipulate multigenic datasets using scripts, this requires programming skills, and in practice experimental population geneticists often do that manually. Here I report a program, ProSeq3, with a convenient graphic user interface that simplifies the preparation and basic population genetic analysis of multigenic datasets. It has been tested and fine-tuned for several years in our laboratory and its use leads to significant time savings at the dataset preparation and analysis stages.

2 FEATURES
ProSeq was originally developed as a Windows-based sequence editor with some DNA polymorphism analysis capability for single gene datasets (Filatov, ). The new version is now available for both Windows and Linux and can handle large datasets with thousands of genes. The size of the datasets is limited by memory and by the maximal value of 32-bit signed long integers (2 147 483 647) used for internal indexing. The program can be used for sequence editing, annotation of sequence features, handling of output from high throughput sequencers, or from BLAST searches, as well as for various population genetic analyses. ProSeq3 supports and facilitates all steps of DNA sequencing workflow from sequence chromatogram editing to DNA polymorphism analysis of multigenic data.

2.1 DNA sequence editing, alignment and annotation
To help with the processing of raw sequence data ProSeq3 allows users to open and visualize sequence chromatograms, edit the sequence and assemble sequence contigs. Integration with popular phred and phrap programs (de la Bastide and McCombie, ; Ewing and Green, ) makes it possible to automatically assess chromatogram quality and assemble contigs. Raw sequences with or without associated chromatogram and base quality information can be further edited and annotated in ProSeq3 to obtain finished sequences.

ProSeq3 supports and facilitates the functional annotation of individual sequences in the dataset with several handy functions, such as selection and assignment of a functional (e.g. coding) region in the editor window, and the ability to copy assigned regions from another sequence in the dataset. All annotations are preserved if the dataset is saved in the data file (*.df) ‘native’ for ProSeq3.

Multiple sequence alignment can be done within ProSeq3, which includes Clustal (Higgins et al., ). Alternatively alignment can be done manually using the ProSeq3 editor or an external program. In the latter case alignment information (position and length of gaps) can be imported back into the annotated dataset in ProSeq3. Following automated alignment, it is usually necessary to check, correct and trim the alignment manually, and check sequence differences between individual sequences, which is easily done in the sequence editor included in ProSeq3. The editor is fairly flexible and includes three viewing/editing modes, allowing the user to see/edit the sequence, polymorphisms in the alignment and the functional regions assigned to the sequence. Using these modes the user can scroll along the sequence, zoom in to see a region of the sequence or zoom out to visualize the entire sequence with annotation shown in a graphical form.

2.2 Handling data with a relational database
Tracking what sequence in a dataset comes from which individual becomes problematic when the number of sequenced genes is large. ProSeq3 resolves this problem by storing all the data in an internal relational database where the sequences are linked to individuals and individuals can be combined into groups (populations). This data structure makes it trivial to manipulate multiple datasets in the project; e.g. exclusion of one individual from analysis can be done with a couple of mouse clicks, which results in automatic exclusion of all sequences linked to that individual. Similarly, individual sequences or parts of sequences can be excluded from the analysis. Grouping sequences into populations is also done at the level of individuals: if an individual is assigned to the particular population, all the sequences across multiple datasets in the project that are linked to that individual are automatically assigned to that population. The assignment of sequences to individuals and individuals to groups can be done by a simple drag and drop approach. Relational information of the database is preserved if the project is saved in the native (*.df) ProSeq3 file format.

2.3 DNA polymorphism analysis
Once the alignments for several genes are complete and ready for analysis, they are usually analysed one by one using such programs as MEGA (Tamura et al., ) or DnaSP (Librado and Rozas, ). This process is relatively quick when there are only a few genes, but it becomes prohibitively time-consuming with larger numbers of genes. ProSeq3 solves this problem by allowing the user to run all the datasets in the project through the particular analysis in one go. Several most commonly used population genetic analyses are implemented in ProSeq3: visualisation and analysis of single nucleotide polymorphisms, common statistics for DNA polymorphism (π, θ; Nei and Kumar, ), various neutrality tests such as Tajima's D (Tajima, ), and analysis of population subdivision/divergence. The distribution of DNA polymorphism or neutrality statistics along the length of a gene can be visualised with a sliding window option.

Although ProSeq3 was developed for population genetic analyses it also includes a tool for basic phylogenetic analysis that can construct and visualise neighbor-joining trees (Nei and Kumar, ). A combination of a sequence editor and tree visualisation tool in one program is particularly handy at the stage of preliminary evaluation and checking of the datasets, as oddities in the data, such as misalignment or sequencing errors make a sequence appear more diverged, which is easily identifiable from the inspection of a gene tree and can be quickly fixed within ProSeq3.

Other analysis options include the tool for creating bootstrap replicates of a dataset, and a tool for coalescent simulations (Hein et al., ) with or without recombination in panmictic or subdivided populations.

2.4 Input/output options
ProSeq3 supports 25 different file formats. It can create input files for such popular programs as DnaSP (Librado and Rozas, ), MEGA (Tamura et al., ), PAML (Yang, ), Arlequin (Excoffier et al., ), Structure (Pritchard et al., ) and IMa (Hey and Nielsen, ). The multitude of supported file formats and flexible data structure of ProSeq3 make it a convenient hub for sequence data processing and analysis.

3 IMPLEMENTATION
ProSeq3 has been developed in Delphi7 with the CLX library and it can be compiled for Windows and Linux operation systems.

ACKNOWLEDGEMENTS
I thank the members of my lab for testing the program.

Funding: Natural Environment Research Council UK.

Conflict of Interest: none declared.

